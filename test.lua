--[[
	⣿⣿⣿⣿⣿ SIGMA SPY ⣿⣿⣿⣿⣿
	⣿⣿⣯⡉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉⠉
	⠉⠻⣿⣿⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠈⠻⣿⣿⣷⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠙⢿⣿⣿⣦⡀⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⠀⠀⣉⣿⣿⣿⠆⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⠀⠀⠀⣠⣾⣿⣿⠟⠁⠀⠀⠀⠀⠀⠀⠀⠀
	⠀⠀⢀⣴⣿⣿⡿⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣀⣴⣿⣿⠟⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
	⣿⣿⣟⣁⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀⣀
	⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿

	@author depso (depthso)
	@repo https://github.com/depthso
	@license MIT
	@description Sigma Remote Spy for Roblox
    
	This file is COMPILED, check /src folder for the source
	Build scripts are available in /build
]]


local a,b={UseWorkspace=false,NoActors=false,FolderName='Sigma Spy',RepoUrl=
[[https://raw.githubusercontent.com/playvoras/Sigma-Spy/refs/heads/main]],
ParserUrl=
[[https://raw.githubusercontent.com/depthso/Roblox-parser/refs/heads/main/dist/Main.luau]]
},{...}local c=b[1]if typeof(c)=='table'then for d,e in c do a[d]=e end end
local d=setmetatable({},{__index=function(d,e)local f=game:GetService(e)return
cloneref(f)end})local e=(function()local e,f={UseWorkspace=false,Folder=
'Sigma spy',RepoUrl=nil,FolderStructure={['Sigma Spy']={'assets'}}}function e:
Init(g)local h,i=self.FolderStructure,g.Services f=i.HttpService self:
CheckFolders(h)end function e:PushConfig(g)for h,i in next,g do self[h]=i end
end function e:UrlFetch(g)local h={Url=g:gsub(' ','%%20'),Method='GET'}local i,j
=pcall(request,h)if not i then warn'[!] HTTP request error! Check console (F9)'
warn('> Url:',g)error(j)return''end local k,l=j.Body,j.StatusCode if l==404 then
warn'[!] The file requested has moved or been deleted.'warn(' >',g)return''end
return k,j end function e:MakePath(g)local h=self.Folder return`{h}/{g}`end
function e:LoadCustomasset(g)if not getcustomasset then return end if not g then
return end local h=readfile(g)if#h<=0 then return end local i,j=pcall(
getcustomasset,g)if not i then return end if not j or#j<=0 then return end
return j end function e:GetFile(g,h)local i,j,k,l=self.RepoUrl,self.UseWorkspace
,self:MakePath(g),''if j then l=readfile(k)else l=self:UrlFetch(`{i}/{g}`)end if
h then self:FileCheck(k,function()return l end)return self:LoadCustomasset(k)end
return l end function e:GetTemplate(g)return self:GetFile(`templates/{g}.lua`)
end function e:FileCheck(g,h)if isfile(g)then return end local i=h()writefile(g,
i)end function e:FolderCheck(g)if isfolder(g)then return end makefolder(g)end
function e:CheckPath(g,h)return g and`{g}/{h}`or h end function e:CheckFolders(g
,h)for i,j in next,g do if typeof(j)=='table'then local k=self:CheckPath(h,i)
self:FolderCheck(k)self:CheckFolders(j,k)continue end local k=self:CheckPath(h,j
)self:FolderCheck(k)end end function e:TemplateCheck(g,h)self:FileCheck(g,
function()return self:GetTemplate(h)end)end function e:GetAsset(g,h)return self:
GetFile(`assets/{g}`,h)end function e:GetModule(g,h)local i=`{g}.lua`if h then
self:TemplateCheck(i,h)local j=readfile(i)local k=loadstring(j)if k then return
j end return self:GetTemplate(h)end return self:GetFile(i)end function e:
LoadLibraries(g,...)local h={}for i,j in next,g do local k=typeof(j)=='table'and
j[1]=='base64'j=k and j[2]or j if typeof(j)~='string'and not k then h[i]=j
continue end if k then j=crypt.base64decode(j)g[i]=j end local l,m=loadstring(j,
i)assert(l,`Failed to load {i}: {m}`)h[i]=l(...)end return h end function e:
LoadModules(g,h)for i,j in next,g do local k=j.Init if not k then continue end j
:Init(h)end end function e:CreateFont(g,h)if not h then return end local i=`assets/{
g}.json`local j,k=self:MakePath(i),{name=g,faces={{name='Regular',weight=400,
style='Normal',assetId=h}}}local l=f:JSONEncode(k)writefile(j,l)return j end
function e:CompileModule(g)local h='local Libraries = {'for i,j in g do if
typeof(j)~='string'then continue end h..=`\t{i} = (function()\n{j}\nend)(),\n`
end h..='}'return h end function e:MakeActorScript(g,h)local i=e:CompileModule(g
)i..='\r\n\tlocal ExtraData = {\r\n\t\tIsActor = true\r\n\t}\r\n\t'i..=`Libraries.Hook:BeginService(Libraries, ExtraData, {
h})`return i end return e end)()e:PushConfig(a)e:Init{Services=d}local f=e.
FolderName local g,h={Config=e:GetModule(`{f}/Config`,'Config'),ReturnSpoofs=e:
GetModule(`{f}/Return spoofs`,'Return Spoofs'),Configuration=a,Files=e,Process={
'base64',
[[dHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCnR5cGUgUmVtb3RlRGF0YSA9IHsNCglSZW1vdGU6IEluc3RhbmNlLA0KICAgIE5vQmFja3RyYWNlOiBib29sZWFuPywNCglJc1JlY2VpdmU6IGJvb2xlYW4/LA0KCUFyZ3M6IHRhYmxlLA0KICAgIElkOiBzdHJpbmcsDQoJTWV0aG9kOiBzdHJpbmcsDQogICAgVHJhbnNmZXJUeXBlOiBzdHJpbmcsDQoJVmFsdWVSZXBsYWNlbWVudHM6IHRhYmxlLA0KICAgIFJldHVyblZhbHVlczogdGFibGUsDQogICAgT3JpZ2luYWxGdW5jOiAoSW5zdGFuY2UsIC4uLmFueSkgLT4gLi4uYW55DQp9DQoNCi0tLy8gTW9kdWxlDQpsb2NhbCBQcm9jZXNzID0gew0KICAgIC0tLy8gUmVtb3RlIGNsYXNzZXMNCiAgICBSZW1vdGVDbGFzc0RhdGEgPSB7DQogICAgICAgIFsiUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJSZW1vdGVGdW5jdGlvbiJdID0gew0KICAgICAgICAgICAgSXNSZW1vdGVGdW5jdGlvbiA9IHRydWUsDQogICAgICAgICAgICBTZW5kID0gew0KICAgICAgICAgICAgICAgICJJbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJpbnZva2VTZXJ2ZXIiLA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIFJlY2VpdmUgPSB7DQogICAgICAgICAgICAgICAgIk9uQ2xpZW50SW52b2tlIiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJVbnJlbGlhYmxlUmVtb3RlRXZlbnQiXSA9IHsNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkZpcmVTZXJ2ZXIiLA0KICAgICAgICAgICAgICAgICJmaXJlU2VydmVyIiwNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICBSZWNlaXZlID0gew0KICAgICAgICAgICAgICAgICJPbkNsaWVudEV2ZW50IiwNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgWyJCaW5kYWJsZUV2ZW50Il0gPSB7DQogICAgICAgICAgICBOb1JlY2l2ZUhvb2sgPSB0cnVlLA0KICAgICAgICAgICAgU2VuZCA9IHsNCiAgICAgICAgICAgICAgICAiRmlyZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiRXZlbnQiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBbIkJpbmRhYmxlRnVuY3Rpb24iXSA9IHsNCiAgICAgICAgICAgIElzUmVtb3RlRnVuY3Rpb24gPSB0cnVlLA0KICAgICAgICAgICAgTm9SZWNpdmVIb29rID0gdHJ1ZSwNCiAgICAgICAgICAgIFNlbmQgPSB7DQogICAgICAgICAgICAgICAgIkludm9rZSIsDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgUmVjZWl2ZSA9IHsNCiAgICAgICAgICAgICAgICAiT25JbnZva2UiLA0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfSwNCiAgICBSZW1vdGVPcHRpb25zID0ge30sDQogICAgTG9vcGluZ1JlbW90ZXMgPSB7fSwNCiAgICBDb25maWdPdmVyd3JpdGVzID0gew0KICAgICAgICBbeyJzaXJodXJ0IiwgInBvdGFzc2l1bSIsICJ3YXZlIn1dID0gew0KICAgICAgICAgICAgRm9yY2VVc2VDdXN0b21Db21tID0gdHJ1ZQ0KICAgICAgICB9DQogICAgfQ0KfQ0KDQotLS8vIE1vZHVsZXMNCmxvY2FsIEhvb2sNCmxvY2FsIENvbW11bmljYXRpb24NCmxvY2FsIFJldHVyblNwb29mcw0KbG9jYWwgVWkNCmxvY2FsIENvbmZpZw0KDQotLS8vIENvbW11bmljYXRpb24gY2hhbm5lbA0KbG9jYWwgQ2hhbm5lbA0KbG9jYWwgQ2hhbm5lbFdyYXBwZWQgPSBmYWxzZQ0KDQpsb2NhbCBTaWdtYUVOViA9IGdldGZlbnYoMSkNCg0KbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpDQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvDQoJCUJhc2VbS2V5XSA9IFZhbHVlDQoJZW5kDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpJbml0KERhdGEpDQogICAgbG9jYWwgTW9kdWxlcyA9IERhdGEuTW9kdWxlcw0KDQogICAgLS0vLyBNb2R1bGVzDQogICAgQ29uZmlnID0gTW9kdWxlcy5Db25maWcNCiAgICBVaSA9IE1vZHVsZXMuVWkNCiAgICBIb29rID0gTW9kdWxlcy5Ib29rDQogICAgQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbg0KICAgIFJldHVyblNwb29mcyA9IE1vZHVsZXMuUmV0dXJuU3Bvb2ZzDQplbmQNCg0KLS0vLyBDb21tdW5pY2F0aW9uDQpmdW5jdGlvbiBQcm9jZXNzOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogQmluZGFibGVFdmVudCwgSXNXcmFwcGVkOiBib29sZWFuKQ0KICAgIENoYW5uZWwgPSBOZXdDaGFubmVsDQogICAgQ2hhbm5lbFdyYXBwZWQgPSBJc1dyYXBwZWQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldENvbmZpZ092ZXJ3cml0ZXMoTmFtZTogc3RyaW5nKQ0KICAgIGxvY2FsIENvbmZpZ092ZXJ3cml0ZXMgPSBzZWxmLkNvbmZpZ092ZXJ3cml0ZXMNCg0KICAgIGZvciBMaXN0LCBPdmVyd3JpdGVzIGluIG5leHQsIENvbmZpZ092ZXJ3cml0ZXMgZG8NCiAgICAgICAgaWYgbm90IHRhYmxlLmZpbmQoTGlzdCwgTmFtZSkgdGhlbiBjb250aW51ZSBlbmQNCiAgICAgICAgcmV0dXJuIE92ZXJ3cml0ZXMNCiAgICBlbmQNCiAgICByZXR1cm4NCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrQ29uZmlnKENvbmZpZzogdGFibGUpDQogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpDQoNCiAgICAtLS8vIEZvcmNlIGNvbmZpZ3VyYXRpb24gb3ZlcndyaXRlcyBmb3Igc3BlY2lmaWMgZXhlY3V0b3JzDQogICAgbG9jYWwgT3ZlcndyaXRlcyA9IHNlbGY6R2V0Q29uZmlnT3ZlcndyaXRlcyhOYW1lKQ0KICAgIGlmIG5vdCBPdmVyd3JpdGVzIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgTWVyZ2UoQ29uZmlnLCBPdmVyd3JpdGVzKQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2xlYW5DRXJyb3IoRXJyb3I6IHN0cmluZyk6IHN0cmluZw0KICAgIEVycm9yID0gRXJyb3I6Z3N1YigiOiVkKzogIiwgIiIpDQogICAgRXJyb3IgPSBFcnJvcjpnc3ViKCIsIGdvdCAlYSsiLCAiIikNCiAgICBFcnJvciA9IEVycm9yOmdzdWIoImludmFsaWQgYXJndW1lbnQiLCAibWlzc2luZyBhcmd1bWVudCIpDQogICAgcmV0dXJuIEVycm9yDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDb3VudE1hdGNoZXMoU3RyaW5nOiBzdHJpbmcsIE1hdGNoOiBzdHJpbmcpOiBudW1iZXINCglsb2NhbCBDb3VudCA9IDANCglmb3IgXyBpbiBTdHJpbmc6Z21hdGNoKE1hdGNoKSBkbw0KCQlDb3VudCArPTEgDQoJZW5kDQoNCglyZXR1cm4gQ291bnQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkRlZXBDbG9uZVRhYmxlKFRhYmxlLCBJZ25vcmU6IHRhYmxlPykNCglsb2NhbCBOZXcgPSB7fQ0KCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvDQogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlIHZhbHVlIGlzIGlnbm9yZWQNCiAgICAgICAgaWYgSWdub3JlIGFuZCB0YWJsZS5maW5kKElnbm9yZSwgVmFsdWUpIHRoZW4gY29udGludWUgZW5kDQoNCgkJTmV3W0tleV0gPSB0eXBlb2YoVmFsdWUpID09ICJ0YWJsZSIgYW5kIHNlbGY6RGVlcENsb25lVGFibGUoVmFsdWUpIG9yIFZhbHVlDQoJZW5kDQoJcmV0dXJuIE5ldw0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6VW5wYWNrKFRhYmxlOiB0YWJsZSkNCglsb2NhbCBMZW5ndGggPSB0YWJsZS5tYXhuKFRhYmxlKQ0KCXJldHVybiB1bnBhY2soVGFibGUsIDEsIExlbmd0aCkNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlB1c2hDb25maWcoT3ZlcndyaXRlcykNCiAgICBNZXJnZShzZWxmLCBPdmVyd3JpdGVzKQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RnVuY0V4aXN0cyhOYW1lOiBzdHJpbmcpDQoJcmV0dXJuIGdldGZlbnYoMSlbTmFtZV0NCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNoZWNrRXhlY3V0b3IoKTogYm9vbGVhbg0KICAgIGxvY2FsIEJsYWNrbGlzdGVkID0gew0KICAgICAgICAieGVubyIsDQogICAgICAgICJzb2xhcmEiLA0KICAgICAgICAiampzcGxvaXQiDQogICAgfQ0KDQogICAgbG9jYWwgTmFtZSA9IGlkZW50aWZ5ZXhlY3V0b3IoKTpsb3dlcigpDQogICAgbG9jYWwgSXNCbGFja2xpc3RlZCA9IHRhYmxlLmZpbmQoQmxhY2tsaXN0ZWQsIE5hbWUpDQoNCiAgICAtLS8vIFNvbWUgZXhlY3V0b3JzIGhhdmUgYnJva2VuIGZ1bmN0aW9uYWxpdHkNCiAgICBpZiBJc0JsYWNrbGlzdGVkIHRoZW4NCiAgICAgICAgVWk6U2hvd1Vuc3VwcG9ydGVkRXhlY3V0b3IoTmFtZSkNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgZW5kDQoNCiAgICByZXR1cm4gdHJ1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6Q2hlY2tGdW5jdGlvbnMoKTogYm9vbGVhbg0KICAgIGxvY2FsIENvcmVGdW5jdGlvbnMgPSB7DQogICAgICAgICJob29rbWV0YW1ldGhvZCIsDQogICAgICAgICJob29rZnVuY3Rpb24iLA0KICAgICAgICAiZ2V0cmF3bWV0YXRhYmxlIiwNCiAgICAgICAgInNldHJlYWRvbmx5Ig0KICAgIH0NCg0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGZ1bmN0aW9ucyBleGlzdCBpbiB0aGUgRU5WDQogICAgZm9yIF8sIE5hbWUgaW4gQ29yZUZ1bmN0aW9ucyBkbw0KICAgICAgICBsb2NhbCBGdW5jID0gc2VsZjpGdW5jRXhpc3RzKE5hbWUpDQogICAgICAgIGlmIEZ1bmMgdGhlbiBjb250aW51ZSBlbmQNCg0KICAgICAgICAtLS8vIEZ1bmN0aW9uIG1pc3NpbmchDQogICAgICAgIFVpOlNob3dVbnN1cHBvcnRlZChOYW1lKQ0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCg0KICAgIHJldHVybiB0cnVlDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpDaGVja0lzU3VwcG9ydGVkKCk6IGJvb2xlYW4NCiAgICAtLS8vIENoZWNrIGlmIHRoZSBleGVjdXRvciBpcyBibGFja2xpc3RlZA0KICAgIGxvY2FsIEV4ZWN1dG9yU3VwcG9ydGVkID0gc2VsZjpDaGVja0V4ZWN1dG9yKCkNCiAgICBpZiBub3QgRXhlY3V0b3JTdXBwb3J0ZWQgdGhlbg0KICAgICAgICByZXR1cm4gZmFsc2UNCiAgICBlbmQNCg0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIGNvcmUgZnVuY3Rpb25zIGV4aXN0DQogICAgbG9jYWwgRnVuY3Rpb25zU3VwcG9ydGVkID0gc2VsZjpDaGVja0Z1bmN0aW9ucygpDQogICAgaWYgbm90IEZ1bmN0aW9uc1N1cHBvcnRlZCB0aGVuDQogICAgICAgIHJldHVybiBmYWxzZQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkdldENsYXNzRGF0YShSZW1vdGU6IEluc3RhbmNlKTogdGFibGU/DQogICAgbG9jYWwgUmVtb3RlQ2xhc3NEYXRhID0gc2VsZi5SZW1vdGVDbGFzc0RhdGENCiAgICBsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpDQoNCiAgICByZXR1cm4gUmVtb3RlQ2xhc3NEYXRhW0NsYXNzTmFtZV0NCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOklzUHJvdGVjdGVkUmVtb3RlKFJlbW90ZTogSW5zdGFuY2UpOiBib29sZWFuDQogICAgbG9jYWwgSXNEZWJ1ZyA9IFJlbW90ZSA9PSBDb21tdW5pY2F0aW9uLkRlYnVnSWRSZW1vdGUNCiAgICBsb2NhbCBJc0NoYW5uZWwgPSBSZW1vdGUgPT0gKENoYW5uZWxXcmFwcGVkIGFuZCBDaGFubmVsLkNoYW5uZWwgb3IgQ2hhbm5lbCkNCg0KICAgIHJldHVybiBJc0RlYnVnIG9yIElzQ2hhbm5lbA0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6UmVtb3RlQWxsb3dlZChSZW1vdGU6IEluc3RhbmNlLCBUcmFuc2ZlclR5cGU6IHN0cmluZywgTWV0aG9kOiBzdHJpbmc/KTogYm9vbGVhbj8NCiAgICBpZiB0eXBlb2YoUmVtb3RlKSB+PSAnSW5zdGFuY2UnIHRoZW4gcmV0dXJuIGVuZA0KICAgIA0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBpcyBwcm90ZWN0ZWQNCiAgICBpZiBzZWxmOklzUHJvdGVjdGVkUmVtb3RlKFJlbW90ZSkgdGhlbiByZXR1cm4gZW5kDQoNCiAgICAtLS8vIEZldGNoIGNsYXNzIHRhYmxlDQoJbG9jYWwgQ2xhc3NEYXRhID0gc2VsZjpHZXRDbGFzc0RhdGEoUmVtb3RlKQ0KCWlmIG5vdCBDbGFzc0RhdGEgdGhlbiByZXR1cm4gZW5kDQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSB0cmFuc2ZlciB0eXBlIGhhcyBkYXRhDQoJbG9jYWwgQWxsb3dlZCA9IENsYXNzRGF0YVtUcmFuc2ZlclR5cGVdDQoJaWYgbm90IEFsbG93ZWQgdGhlbiByZXR1cm4gZW5kDQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBtZXRob2QgaXMgYWxsb3dlZA0KCWlmIE1ldGhvZCB0aGVuDQoJCXJldHVybiB0YWJsZS5maW5kKEFsbG93ZWQsIE1ldGhvZCkgfj0gbmlsDQoJZW5kDQoNCglyZXR1cm4gdHJ1ZQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6U2V0RXh0cmFEYXRhKERhdGE6IHRhYmxlKQ0KICAgIGlmIG5vdCBEYXRhIHRoZW4gcmV0dXJuIGVuZA0KICAgIHNlbGYuRXh0cmFEYXRhID0gRGF0YQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlOiBJbnN0YW5jZSwgTWV0aG9kOiBzdHJpbmcsIC4uLik6IHRhYmxlPw0KICAgIGxvY2FsIFNwb29mID0gUmV0dXJuU3Bvb2ZzW1JlbW90ZV0NCg0KICAgIGlmIG5vdCBTcG9vZiB0aGVuIHJldHVybiBlbmQNCiAgICBpZiBTcG9vZi5NZXRob2Qgfj0gTWV0aG9kIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgbG9jYWwgUmV0dXJuVmFsdWVzID0gU3Bvb2YuUmV0dXJuDQoNCiAgICAtLS8vIENhbGwgdGhlIFJldHVyblZhbHVlcyBmdW5jdGlvbiB0eXBlDQogICAgaWYgdHlwZW9mKFJldHVyblZhbHVlcykgPT0gImZ1bmN0aW9uIiB0aGVuDQogICAgICAgIFJldHVyblZhbHVlcyA9IFJldHVyblZhbHVlcyguLi4pDQogICAgZW5kDQoNCglyZXR1cm4gUmV0dXJuVmFsdWVzDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpTZXROZXdSZXR1cm5TcG9vZnMoTmV3UmV0dXJuU3Bvb2ZzOiB0YWJsZSkNCiAgICBSZXR1cm5TcG9vZnMgPSBOZXdSZXR1cm5TcG9vZnMNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkZpbmRDYWxsaW5nTENsb3N1cmUoT2Zmc2V0OiBudW1iZXIpDQogICAgT2Zmc2V0ICs9IDENCg0KICAgIHdoaWxlIHRydWUgZG8NCiAgICAgICAgT2Zmc2V0ICs9IDENCg0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSBzdGFjayBsZXZlbCBpcyB2YWxpZA0KICAgICAgICBsb2NhbCBJc1ZhbGlkID0gZGVidWcuaW5mbyhPZmZzZXQsICJsIikgfj0gLTENCiAgICAgICAgaWYgbm90IElzVmFsaWQgdGhlbiBjb250aW51ZSBlbmQNCg0KICAgICAgICAtLS8vIENoZWNrIGlmIHRoZSBmdW5jdGlvbiBpcyB2YWxpZA0KICAgICAgICBsb2NhbCBGdW5jdGlvbiA9IGRlYnVnLmluZm8oT2Zmc2V0LCAiZiIpDQogICAgICAgIGlmIG5vdCBGdW5jdGlvbiB0aGVuIHJldHVybiBlbmQNCg0KICAgICAgICByZXR1cm4gRnVuY3Rpb24NCiAgICBlbmQNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNhbGxiYWNrKERhdGE6IFJlbW90ZURhdGEsIC4uLik6IHRhYmxlPw0KICAgIC0tLy8gVW5wYWNrIERhdGENCiAgICBsb2NhbCBPcmlnaW5hbEZ1bmMgPSBEYXRhLk9yaWdpbmFsRnVuYw0KICAgIGxvY2FsIElkID0gRGF0YS5JZA0KICAgIGxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kDQogICAgbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUNCg0KICAgIGxvY2FsIFJlbW90ZURhdGEgPSBzZWxmOkdldFJlbW90ZURhdGEoSWQpDQoNCiAgICAtLS8vIENoZWNrIGlmIHRoZSBSZW1vdGUgaXMgQmxvY2tlZA0KICAgIGlmIFJlbW90ZURhdGEuQmxvY2tlZCB0aGVuIHJldHVybiB7fSBlbmQNCg0KICAgIC0tLy8gQ2hlY2sgZm9yIGEgc3Bvb2YNCiAgICBsb2NhbCBTcG9vZiA9IHNlbGY6R2V0UmVtb3RlU3Bvb2YoUmVtb3RlLCBNZXRob2QsIE9yaWdpbmFsRnVuYywgLi4uKQ0KICAgIGlmIFNwb29mIHRoZW4gcmV0dXJuIFNwb29mIGVuZA0KDQogICAgLS0vLyBDaGVjayBpZiB0aGUgb3JpZ25hbCBmdW5jdGlvbiB3YXMgcGFzc2VkDQogICAgaWYgbm90IE9yaWdpbmFsRnVuYyB0aGVuIHJldHVybiBlbmQNCg0KICAgIC0tLy8gSW52b2tlIG9yaWduYWwgZnVuY3Rpb24NCiAgICByZXR1cm4gew0KICAgICAgICBPcmlnaW5hbEZ1bmMoUmVtb3RlLCAuLi4pDQogICAgfQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6RGVjb21waWxlKFNjcmlwdDogTG9jYWxTY3JpcHQgfCBNb2R1bGVTY3JpcHQpOiBzdHJpbmcNCiAgICBsb2NhbCBLb25zdGFudEFQSSA9ICJodHRwOi8vYXBpLnBsdXNnaWFudDUuY29tL2tvbnN0YW50L2RlY29tcGlsZSINCiAgICBsb2NhbCBGb3JjZUtvbnN0YW50ID0gQ29uZmlnLkZvcmNlS29uc3RhbnREZWNvbXBpbGVyDQoNCiAgICAtLS8vIFVzZSBidWlsdC1pbiBkZWNvbXBpbGVyIGlmIHRoZSBleGVjdXRvciBzdXBwb3J0cyBpdA0KICAgIGlmIGRlY29tcGlsZSBhbmQgbm90IEZvcmNlS29uc3RhbnQgdGhlbiANCiAgICAgICAgcmV0dXJuIGRlY29tcGlsZShTY3JpcHQpDQogICAgZW5kDQoNCiAgICAtLS8vIGdldHNjcmlwdGJ5dGVjb2RlDQogICAgbG9jYWwgU3VjY2VzcywgQnl0ZWNvZGUgPSBwY2FsbChnZXRzY3JpcHRieXRlY29kZSwgU2NyaXB0KQ0KICAgIGlmIG5vdCBTdWNjZXNzIHRoZW4NCiAgICAgICAgbG9jYWwgRXJyb3IgPSBgLS1GYWlsZWQgdG8gZ2V0IHNjcmlwdCBieXRlY29kZSwgZXJyb3I6XG5gDQogICAgICAgIEVycm9yIC4uPSBgXG4tLVtbXG57Qnl0ZWNvZGV9XG5dXWANCiAgICAgICAgcmV0dXJuIEVycm9yLCB0cnVlDQogICAgZW5kDQogICAgDQogICAgLS0vLyBTZW5kIFBPU1QgcmVxdWVzdCB0byB0aGUgQVBJDQogICAgbG9jYWwgUmVzcG9uY2UgPSByZXF1ZXN0KHsNCiAgICAgICAgVXJsID0gS29uc3RhbnRBUEksDQogICAgICAgIEJvZHkgPSBCeXRlY29kZSwNCiAgICAgICAgTWV0aG9kID0gIlBPU1QiLA0KICAgICAgICBIZWFkZXJzID0gew0KICAgICAgICAgICAgWyJDb250ZW50LVR5cGUiXSA9ICJ0ZXh0L3BsYWluIg0KICAgICAgICB9LA0KICAgIH0pDQoNCiAgICAtLS8vIEVycm9yIGNoZWNrDQogICAgaWYgUmVzcG9uY2UuU3RhdHVzQ29kZSB+PSAyMDAgdGhlbg0KICAgICAgICBsb2NhbCBFcnJvciA9IGAtLVtLT05TVEFOVF0gRXJyb3Igb2NjdXJlZCB3aGlsZSByZXF1ZXN0aW5nIHRoZSBBUEksIGVycm9yOlxuYA0KICAgICAgICBFcnJvciAuLj0gYFxuLS1bW1xue1Jlc3BvbmNlLkJvZHl9XG5dXWANCiAgICAgICAgcmV0dXJuIEVycm9yLCB0cnVlDQogICAgZW5kDQoNCiAgICByZXR1cm4gUmVzcG9uY2UuQm9keQ0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6R2V0U2NyaXB0RnJvbUZ1bmMoRnVuYzogKC4uLmFueSkgLT4gLi4uYW55KQ0KICAgIGlmIG5vdCBGdW5jIHRoZW4gcmV0dXJuIGVuZA0KDQogICAgbG9jYWwgU3VjY2VzcywgRU5WID0gcGNhbGwoZ2V0ZmVudiwgRnVuYykNCiAgICBpZiBub3QgU3VjY2VzcyB0aGVuIHJldHVybiBlbmQNCiAgICANCiAgICAtLS8vIEJsYWNrbGlzdCBzaWdtYSBzcHkNCiAgICBpZiBzZWxmOklzU2lnbWFTcHlFTlYoRU5WKSB0aGVuIHJldHVybiBlbmQNCg0KICAgIHJldHVybiByYXdnZXQoRU5WLCAic2NyaXB0IikNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkNvbm5lY3Rpb25Jc1ZhbGlkKENvbm5lY3Rpb246IHRhYmxlKTogYm9vbGVhbg0KICAgIGxvY2FsIFZhbHVlUmVwbGFjZW1lbnRzID0gew0KCQlbIlNjcmlwdCJdID0gZnVuY3Rpb24oQ29ubmVjdGlvbjogdGFibGUpOiBTY3JpcHQ/DQoJCQlsb2NhbCBGdW5jdGlvbiA9IENvbm5lY3Rpb24uRnVuY3Rpb24NCgkJCWlmIG5vdCBGdW5jdGlvbiB0aGVuIHJldHVybiBlbmQNCg0KCQkJcmV0dXJuIHNlbGY6R2V0U2NyaXB0RnJvbUZ1bmMoRnVuY3Rpb24pDQoJCWVuZA0KCX0NCg0KICAgIC0tLy8gQ2hlY2sgaWYgdGhlc2UgcHJvcGVydGllcyBhcmUgdmFsaWQNCiAgICBsb2NhbCBUb0NoZWNrID0gew0KICAgICAgICAiU2NyaXB0Ig0KICAgIH0NCiAgICBmb3IgXywgUHJvcGVydHkgaW4gVG9DaGVjayBkbw0KICAgICAgICBsb2NhbCBSZXBsYWNlbWVudCA9IFZhbHVlUmVwbGFjZW1lbnRzW1Byb3BlcnR5XQ0KICAgICAgICBsb2NhbCBWYWx1ZQ0KDQogICAgICAgIC0tLy8gQ2hlY2sgaWYgdGhlcmUncyBhIGZ1bmN0aW9uIGZvciBhIHByb3BlcnR5DQogICAgICAgIGlmIFJlcGxhY2VtZW50IHRoZW4NCiAgICAgICAgICAgIFZhbHVlID0gUmVwbGFjZW1lbnQoQ29ubmVjdGlvbikNCiAgICAgICAgZW5kDQoNCiAgICAgICAgLS0vLyBDaGVjayBpZiB0aGUgcHJvcGVydHkgaGFzIGEgdmFsdWUNCiAgICAgICAgaWYgVmFsdWUgPT0gbmlsIHRoZW4gDQogICAgICAgICAgICByZXR1cm4gZmFsc2UgDQogICAgICAgIGVuZA0KICAgIGVuZA0KDQogICAgcmV0dXJuIHRydWUNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbDogUkJYU2NyaXB0U2lnbmFsKTogdGFibGUNCiAgICBsb2NhbCBQcm9jZXNzZWQgPSB7fQ0KDQogICAgLS0vLyBGaWx0ZXIgZWFjaCBjb25uZWN0aW9uDQogICAgZm9yIF8sIENvbm5lY3Rpb24gaW4gZ2V0Y29ubmVjdGlvbnMoU2lnbmFsKSBkbw0KICAgICAgICBpZiBub3Qgc2VsZjpDb25uZWN0aW9uSXNWYWxpZChDb25uZWN0aW9uKSB0aGVuIGNvbnRpbnVlIGVuZA0KICAgICAgICB0YWJsZS5pbnNlcnQoUHJvY2Vzc2VkLCBDb25uZWN0aW9uKQ0KICAgIGVuZA0KDQogICAgcmV0dXJuIFByb2Nlc3NlZA0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6SXNTaWdtYVNweUVOVihFbnY6IHRhYmxlKTogYm9vbGVhbg0KICAgIHJldHVybiBFbnYgPT0gU2lnbWFFTlYNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlByb2Nlc3NSZW1vdGUoRGF0YTogUmVtb3RlRGF0YSwgLi4uKTogdGFibGU/DQogICAgLS0vLyBVbnBhY2sgRGF0YQ0KICAgIGxvY2FsIFJlbW90ZSA9IERhdGEuUmVtb3RlDQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QNCiAgICBsb2NhbCBUcmFuc2ZlclR5cGUgPSBEYXRhLlRyYW5zZmVyVHlwZQ0KICAgIGxvY2FsIElzUmVjZWl2ZSA9IERhdGEuSXNSZWNlaXZlDQoNCgktLS8vIENoZWNrIGlmIHRoZSB0cmFuc2ZlcnR5cGUgbWV0aG9kIGlzIGFsbG93ZWQNCglpZiBUcmFuc2ZlclR5cGUgYW5kIG5vdCBzZWxmOlJlbW90ZUFsbG93ZWQoUmVtb3RlLCBUcmFuc2ZlclR5cGUsIE1ldGhvZCkgdGhlbiByZXR1cm4gZW5kDQoNCiAgICAtLS8vIEZldGNoIGRldGFpbHMNCiAgICBsb2NhbCBJZCA9IENvbW11bmljYXRpb246R2V0RGVidWdJZChSZW1vdGUpDQogICAgbG9jYWwgQ2xhc3NEYXRhID0gc2VsZjpHZXRDbGFzc0RhdGEoUmVtb3RlKQ0KICAgIGxvY2FsIFRpbWVzdGFtcCA9IHRpY2soKQ0KDQogICAgbG9jYWwgQ2FsbGluZ0Z1bmN0aW9uDQogICAgbG9jYWwgU291cmNlU2NyaXB0DQoNCiAgICAtLS8vIEFkZCBleHRyYSBkYXRhIGludG8gdGhlIGxvZyBpZiBuZWVkZWQNCiAgICBsb2NhbCBFeHRyYURhdGEgPSBzZWxmLkV4dHJhRGF0YQ0KICAgIGlmIEV4dHJhRGF0YSB0aGVuDQogICAgICAgIE1lcmdlKERhdGEsIEV4dHJhRGF0YSkNCiAgICBlbmQNCg0KICAgIC0tLy8gR2V0IGNhbGxlciBpbmZvcm1hdGlvbg0KICAgIGlmIG5vdCBJc1JlY2VpdmUgdGhlbg0KICAgICAgICBDYWxsaW5nRnVuY3Rpb24gPSBzZWxmOkZpbmRDYWxsaW5nTENsb3N1cmUoMHg2KQ0KICAgICAgICBTb3VyY2VTY3JpcHQgPSBDYWxsaW5nRnVuY3Rpb24gYW5kIHNlbGY6R2V0U2NyaXB0RnJvbUZ1bmMoQ2FsbGluZ0Z1bmN0aW9uKSBvciBuaWwNCiAgICBlbmQNCg0KICAgIC0tLy8gQWRkIHRvIHF1ZXVlDQogICAgTWVyZ2UoRGF0YSwgew0KCQlDYWxsaW5nU2NyaXB0ID0gZ2V0Y2FsbGluZ3NjcmlwdCgpLA0KICAgICAgICBTb3VyY2VTY3JpcHQgPSBTb3VyY2VTY3JpcHQsDQoJCUNhbGxpbmdGdW5jdGlvbiA9IENhbGxpbmdGdW5jdGlvbiwNCiAgICAgICAgSWQgPSBJZCwNCgkJQ2xhc3NEYXRhID0gQ2xhc3NEYXRhLA0KICAgICAgICBUaW1lc3RhbXAgPSBUaW1lc3RhbXAsDQogICAgICAgIEFyZ3MgPSBDb21tdW5pY2F0aW9uOlNlcmlhbGl6ZVRhYmxlKHsuLi59KQ0KICAgIH0pDQoNCiAgICAtLS8vIEludm9rZSB0aGUgUmVtb3RlIGFuZCBsb2cgcmV0dXJuIHZhbHVlcw0KICAgIGxvY2FsIFJldHVyblZhbHVlcyA9IHNlbGY6Q2FsbGJhY2soRGF0YSwgLi4uKQ0KICAgIERhdGEuUmV0dXJuVmFsdWVzID0gUmV0dXJuVmFsdWVzDQoNCiAgICAtLS8vIFF1ZXVlIGxvZw0KICAgIENvbW11bmljYXRpb246UXVldWVMb2coRGF0YSkNCg0KICAgIHJldHVybiBSZXR1cm5WYWx1ZXMNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlNldEFsbFJlbW90ZURhdGEoS2V5OiBzdHJpbmcsIFZhbHVlKQ0KICAgIGxvY2FsIFJlbW90ZU9wdGlvbnMgPSBzZWxmLlJlbW90ZU9wdGlvbnMNCglmb3IgUmVtb3RlSUQsIERhdGEgaW4gbmV4dCwgUmVtb3RlT3B0aW9ucyBkbw0KCQlEYXRhW0tleV0gPSBWYWx1ZQ0KCWVuZA0KZW5kDQoNCmZ1bmN0aW9uIFByb2Nlc3M6R2V0UmVtb3RlRGF0YShJZDogc3RyaW5nKQ0KICAgIGxvY2FsIFJlbW90ZU9wdGlvbnMgPSBzZWxmLlJlbW90ZU9wdGlvbnMNCg0KICAgIC0tLy8gQ2hlY2sgZm9yIGV4aXN0aW5nIHJlbW90ZSBkYXRhDQoJbG9jYWwgRXhpc3RpbmcgPSBSZW1vdGVPcHRpb25zW0lkXQ0KCWlmIEV4aXN0aW5nIHRoZW4gcmV0dXJuIEV4aXN0aW5nIGVuZA0KCQ0KICAgIC0tLy8gQmFzZSByZW1vdGUgZGF0YQ0KCWxvY2FsIERhdGEgPSB7DQoJCUV4Y2x1ZGVkID0gZmFsc2UsDQoJCUJsb2NrZWQgPSBmYWxzZQ0KCX0NCg0KCVJlbW90ZU9wdGlvbnNbSWRdID0gRGF0YQ0KCXJldHVybiBEYXRhDQplbmQNCg0KLS0vLyBUaGUgY29tbXVuaWNhdGlvbiBjcmVhdGVzIGEgZGlmZmVyZW50IHRhYmxlIGFkZHJlc3MNCi0tLy8gUmVjaXZlZCB0YWJsZXMgd2lsbCBub3QgYmUgdGhlIHNhbWUNCmZ1bmN0aW9uIFByb2Nlc3M6U2V0UmVtb3RlRGF0YShJZDogc3RyaW5nLCBSZW1vdGVEYXRhOiB0YWJsZSkNCiAgICBsb2NhbCBSZW1vdGVPcHRpb25zID0gc2VsZi5SZW1vdGVPcHRpb25zDQogICAgUmVtb3RlT3B0aW9uc1tJZF0gPSBSZW1vdGVEYXRhDQplbmQNCg0KZnVuY3Rpb24gUHJvY2VzczpVcGRhdGVSZW1vdGVEYXRhKElkOiBzdHJpbmcsIFJlbW90ZURhdGE6IHRhYmxlKQ0KICAgIENvbW11bmljYXRpb246Q29tbXVuaWNhdGUoIlJlbW90ZURhdGEiLCBJZCwgUmVtb3RlRGF0YSkNCmVuZA0KDQpmdW5jdGlvbiBQcm9jZXNzOlVwZGF0ZUFsbFJlbW90ZURhdGEoS2V5OiBzdHJpbmcsIFZhbHVlKQ0KICAgIENvbW11bmljYXRpb246Q29tbXVuaWNhdGUoIkFsbFJlbW90ZURhdGEiLCBLZXksIFZhbHVlKQ0KZW5kDQoNCnJldHVybiBQcm9jZXNz]]
},Hook={'base64',
[[bG9jYWwgSG9vayA9IHsNCglPcmlnaW5hbE5hbWVjYWxsID0gbmlsLA0KCU9yaWdpbmFsSW5kZXggPSBuaWwsDQp9DQoNCnR5cGUgdGFibGUgPSB7DQoJW2FueV06IGFueQ0KfQ0KDQp0eXBlIE1ldGFDYWxsYmFjayA9IChJbnN0YW5jZSwgLi4uYW55KSAtPiAuLi5hbnkNCg0KLS0vLyBNb2R1bGVzDQpsb2NhbCBNb2R1bGVzDQpsb2NhbCBQcm9jZXNzDQpsb2NhbCBDb25maWd1cmF0aW9uDQpsb2NhbCBDb25maWcNCmxvY2FsIENvbW11bmljYXRpb24NCg0KbG9jYWwgRXhlRU5WID0gZ2V0ZmVudigxKQ0KDQpmdW5jdGlvbiBIb29rOkluaXQoRGF0YSkNCiAgICBNb2R1bGVzID0gRGF0YS5Nb2R1bGVzDQoNCglQcm9jZXNzID0gTW9kdWxlcy5Qcm9jZXNzDQoJQ29tbXVuaWNhdGlvbiA9IE1vZHVsZXMuQ29tbXVuaWNhdGlvbiBvciBDb21tdW5pY2F0aW9uDQoJQ29uZmlnID0gTW9kdWxlcy5Db25maWcgb3IgQ29uZmlnDQoJQ29uZmlndXJhdGlvbiA9IE1vZHVsZXMuQ29uZmlndXJhdGlvbiBvciBDb25maWd1cmF0aW9uDQplbmQNCg0KLS0vLyBUaGUgY2FsbGJhY2sgaXMgZXhwZWN0ZWQgdG8gcmV0dXJuIGEgbmlsIHZhbHVlIHNvbWV0aW1lcyB3aGljaCBzaG91bGQgYmUgaW5nb3JlZA0KbG9jYWwgSG9va01pZGRsZSA9IG5ld2NjbG9zdXJlKGZ1bmN0aW9uKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIC4uLikNCgktLS8vIEludm9rZSBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGEgcmVwb25jZSBvdGhlcndpc2UgaWdub3JlZA0KCWxvY2FsIFJldHVyblZhbHVlcyA9IENhbGxiYWNrKC4uLikNCglpZiBSZXR1cm5WYWx1ZXMgdGhlbg0KCQlyZXR1cm4gUHJvY2VzczpVbnBhY2soUmV0dXJuVmFsdWVzKQ0KCWVuZA0KDQoJLS0vLyBJbnZva2Ugb3JpZ25hbCBmdW5jdGlvbg0KCXJldHVybiBPcmlnaW5hbEZ1bmMoLi4uKQ0KZW5kKQ0KDQotLS8vIGdldHJhd21ldGF0YWJsZQ0KZnVuY3Rpb24gSG9vazpSZXBsYWNlTWV0YU1ldGhvZChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhQ2FsbGJhY2spOiBNZXRhQ2FsbGJhY2sNCglsb2NhbCBNZXRhdGFibGUgPSBnZXRyYXdtZXRhdGFibGUoT2JqZWN0KQ0KCWxvY2FsIE9yaWdpbmFsRnVuYyA9IHJhd2dldChNZXRhdGFibGUsIENhbGwpDQoJDQoJLS0vLyBSZXBsYWNlIGZ1bmN0aW9uDQoJc2V0cmVhZG9ubHkoTWV0YXRhYmxlLCBmYWxzZSkNCglyYXdzZXQoTWV0YXRhYmxlLCBDYWxsLCBuZXdjY2xvc3VyZShmdW5jdGlvbiguLi4pDQoJCXJldHVybiBIb29rTWlkZGxlKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIC4uLikNCgllbmQpKQ0KCXNldHJlYWRvbmx5KE1ldGF0YWJsZSwgdHJ1ZSkNCg0KCXJldHVybiBPcmlnaW5hbEZ1bmMNCmVuZA0KDQotLS8vIGhvb2tmdW5jdGlvbg0KZnVuY3Rpb24gSG9vazpIb29rRnVuY3Rpb24oRnVuYzogKC4uLmFueSkgLT4gLi4uYW55LCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55KQ0KCWxvY2FsIE9yaWdpbmFsRnVuYw0KCU9yaWdpbmFsRnVuYyA9IGhvb2tmdW5jdGlvbihGdW5jLCBmdW5jdGlvbiguLi4pDQoJCXJldHVybiBIb29rTWlkZGxlKE9yaWdpbmFsRnVuYywgQ2FsbGJhY2ssIC4uLikNCgllbmQpDQoJcmV0dXJuIE9yaWdpbmFsRnVuYw0KZW5kDQoNCi0tLy8gaG9va21ldGFtZXRob2QNCmZ1bmN0aW9uIEhvb2s6SG9va01ldGFDYWxsKE9iamVjdDogSW5zdGFuY2UsIENhbGw6IHN0cmluZywgQ2FsbGJhY2s6IE1ldGFDYWxsYmFjayk6IE1ldGFDYWxsYmFjaw0KCWxvY2FsIE9yaWdpbmFsRnVuYw0KCU9yaWdpbmFsRnVuYyA9IGhvb2ttZXRhbWV0aG9kKE9iamVjdCwgQ2FsbCwgbmV3Y2Nsb3N1cmUoZnVuY3Rpb24oLi4uKQ0KCQlyZXR1cm4gSG9va01pZGRsZShPcmlnaW5hbEZ1bmMsIENhbGxiYWNrLCAuLi4pDQoJZW5kKSkNCglyZXR1cm4gT3JpZ2luYWxGdW5jDQplbmQNCg0KZnVuY3Rpb24gSG9vazpIb29rTWV0YU1ldGhvZChPYmplY3Q6IEluc3RhbmNlLCBDYWxsOiBzdHJpbmcsIENhbGxiYWNrOiBNZXRhQ2FsbGJhY2spOiBNZXRhQ2FsbGJhY2sNCgktLS8vIEdldHJhd21ldGF0YWJsZQ0KCWlmIENvbmZpZy5SZXBsYWNlTWV0YUNhbGxGdW5jIHRoZW4NCgkJcmV0dXJuIHNlbGY6UmVwbGFjZU1ldGFNZXRob2QoT2JqZWN0LCBDYWxsLCBDYWxsYmFjaykNCgllbmQNCgkNCgktLS8vIEhvb2ttZXRhbWV0aG9kDQoJcmV0dXJuIHNlbGY6SG9va01ldGFDYWxsKE9iamVjdCwgQ2FsbCwgQ2FsbGJhY2spDQplbmQNCg0KLS0vLyBUaGlzIGluY2x1ZGVzIGEgZmV3IHBhdGNoZXMgZm9yIGV4ZWN1dG9yIGZ1bmN0aW9ucyB0aGF0IHJlc3VsdCBpbiBkZXRlY3Rpb24NCi0tLy8gVGhpcyBpc24ndCBidWxsZXRwcm9vZiBzaW5jZSBzb21lIGZ1bmN0aW9ucyBsaWtlIGhvb2tmdW5jdGlvbiBJIGNhbid0IHBhdGNoDQotLS8vIEJ5IHRoZSB3YXksIHRoYW5rcyBmb3IgY29weWluZyB0aGlzIGd1eXMhIFN1cGVyIGFwcHJlY2lhdGUgdGhlIGNvcHljYXQNCmZ1bmN0aW9uIEhvb2s6UGF0Y2hGdW5jdGlvbnMoKQ0KCS0tLy8gQ2hlY2sgaWYgdGhpcyBmdW5jdGlvbiBpcyBkaXNhYmxlZCBpbiB0aGUgY29uZmlndXJhdGlvbg0KCWlmIENvbmZpZy5Ob0Z1bmN0aW9uUGF0Y2hpbmcgdGhlbiByZXR1cm4gZW5kDQoNCglsb2NhbCBQYXRjaGVzID0gew0KCQktLS8vIEVycm9yIGRldGVjdGlvbiBwYXRjaA0KCQktLS8vIGhvb2tmdW5jdGlvbiBtYXkgc3RpbGwgYmUgZGV0ZWN0ZWQgZGVwZW5kaW5nIG9uIHRoZSBleGVjdXRvcg0KCQlbcGNhbGxdID0gIGZ1bmN0aW9uKE9sZEZ1bmMsIEZ1bmMsIC4uLikNCgkJCWxvY2FsIFJlc3BvbmNlID0ge09sZEZ1bmMoRnVuYywgLi4uKX0NCgkJCWxvY2FsIFN1Y2Nlc3MsIEVycm9yID0gUmVzcG9uY2VbMV0sIFJlc3BvbmNlWzJdDQoJCQlsb2NhbCBJc0MgPSBpc2NjbG9zdXJlKEZ1bmMpDQoNCgkJCS0tLy8gUGF0Y2ggYy1jbG9zdXJlIGVycm9yIGRldGVjdGlvbg0KCQkJaWYgU3VjY2VzcyA9PSBmYWxzZSBhbmQgSXNDIHRoZW4NCgkJCQlsb2NhbCBOZXdFcnJvciA9IFByb2Nlc3M6Q2xlYW5DRXJyb3IoRXJyb3IpDQoJCQkJDQoJCQkJUmVzcG9uY2VbMl0gPSBOZXdFcnJvcg0KCQkJZW5kDQoNCgkJCS0tLy8gU3RhY2stb3ZlcmZsb3cgZGV0ZWN0aW9uIHBhdGNoDQoJCQlpZiBTdWNjZXNzID09IGZhbHNlIGFuZCBub3QgSXNDIGFuZCBFcnJvcjpmaW5kKCJDIHN0YWNrIG92ZXJmbG93IikgdGhlbg0KCQkJCWxvY2FsIFRyYWNldGFibGUgPSBFcnJvcjpzcGxpdCgiOiIpDQoJCQkJbG9jYWwgQ2FsbGVyLCBMaW5lID0gVHJhY2V0YWJsZVsxXSwgVHJhY2V0YWJsZVsyXQ0KCQkJCWxvY2FsIENvdW50ID0gUHJvY2VzczpDb3VudE1hdGNoZXMoRXJyb3IsIENhbGxlcikNCg0KCQkJCWlmIENvdW50ID09IDE5NiB0aGVuDQoJCQkJCUNvbW11bmljYXRpb246Q29uc29sZVByaW50KCJDIHN0YWNrIG92ZXJmbG93IHBhdGNoZWQiKQ0KCQkJCQlSZXNwb25jZVsyXSA9IGB7Q2FsbGVyfTp7TGluZX06IHtFcnJvcn1gDQoJCQkJZW5kDQoJCQllbmQNCg0KCQkJcmV0dXJuIFByb2Nlc3M6VW5wYWNrKFJlc3BvbmNlKQ0KCQllbmQsDQoJCVtnZXRmZW52XSA9IGZ1bmN0aW9uKE9sZEZ1bmMsIExldmVsOiBudW1iZXIsIC4uLikNCgkJCUxldmVsID0gTGV2ZWwgb3IgMQ0KDQoJCQktLS8vIFByZXZlbnQgY2F0cHVyZSBvZiBleGVjdXRvcidzIGVudg0KCQkJaWYgdHlwZShMZXZlbCkgPT0gIm51bWJlciIgdGhlbg0KCQkJCUxldmVsICs9IDINCgkJCWVuZA0KDQoJCQlsb2NhbCBSZXNwb25jZSA9IHtPbGRGdW5jKExldmVsLCAuLi4pfQ0KCQkJbG9jYWwgRU5WID0gUmVzcG9uY2VbMV0NCg0KCQkJLS0vLyBfX3Rvc3RyaW5nIEVOViBkZXRlY3Rpb24gcGF0Y2gNCgkJCWlmIG5vdCBjaGVja2NhbGxlcigpIGFuZCBFTlYgPT0gRXhlRU5WIHRoZW4NCgkJCQlDb21tdW5pY2F0aW9uOkNvbnNvbGVQcmludCgiRU5WIGVzY2FwZSBwYXRjaGVkIikNCgkJCQlyZXR1cm4gT2xkRnVuYyg5OTk5OTksIC4uLikNCgkJCWVuZA0KDQoJCQlyZXR1cm4gUHJvY2VzczpVbnBhY2soUmVzcG9uY2UpDQoJCWVuZA0KCX0NCg0KCS0tLy8gSG9vayBlYWNoIGZ1bmN0aW9uDQoJZm9yIEZ1bmMsIENhbGxCYWNrIGluIFBhdGNoZXMgZG8NCgkJbG9jYWwgT2xkRnVuYyA9IGNsb25lZnVuY3Rpb24oRnVuYykNCgkJaG9va2Z1bmN0aW9uKEZ1bmMsIG5ld2NjbG9zdXJlKGZ1bmN0aW9uKC4uLikNCgkJCXJldHVybiBDYWxsQmFjayhPbGRGdW5jLCAuLi4pDQoJCWVuZCkpDQoJZW5kDQplbmQNCg0KbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGUpDQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvDQoJCUJhc2VbS2V5XSA9IFZhbHVlDQoJZW5kDQplbmQNCg0KZnVuY3Rpb24gSG9vazpSdW5PbkFjdG9ycyhDb2RlOiBzdHJpbmcsIENoYW5uZWxJZDogbnVtYmVyKQ0KCWlmIG5vdCBnZXRhY3RvcnMgb3Igbm90IHJ1bl9vbl9hY3RvciB0aGVuIHJldHVybiBlbmQNCgkNCglsb2NhbCBBY3RvcnMgPSBnZXRhY3RvcnMoKQ0KCWlmIG5vdCBBY3RvcnMgdGhlbiByZXR1cm4gZW5kDQoJDQoJZm9yIF8sIEFjdG9yIGluIEFjdG9ycyBkbyANCgkJcGNhbGwocnVuX29uX2FjdG9yLCBBY3RvciwgQ29kZSwgQ2hhbm5lbElkKQ0KCWVuZA0KZW5kDQoNCmxvY2FsIGZ1bmN0aW9uIFByb2Nlc3NSZW1vdGUoT3JpZ2luYWxGdW5jLCBNZXRhTWV0aG9kOiBzdHJpbmcsIHNlbGYsIE1ldGhvZDogc3RyaW5nLCAuLi4pDQoJcmV0dXJuIFByb2Nlc3M6UHJvY2Vzc1JlbW90ZSh7DQoJCVJlbW90ZSA9IHNlbGYsDQoJCU1ldGhvZCA9IE1ldGhvZCwNCgkJT3JpZ2luYWxGdW5jID0gT3JpZ2luYWxGdW5jLA0KCQlNZXRhTWV0aG9kID0gTWV0YU1ldGhvZCwNCgkJVHJhbnNmZXJUeXBlID0gIlNlbmQiLA0KCQlJc0V4cGxvaXQgPSBjaGVja2NhbGxlcigpDQoJfSwgLi4uKQ0KZW5kDQoNCmZ1bmN0aW9uIEhvb2s6SG9va1JlbW90ZVR5cGVJbmRleChDbGFzc05hbWU6IHN0cmluZywgRnVuY05hbWU6IHN0cmluZykNCglsb2NhbCBSZW1vdGUgPSBJbnN0YW5jZS5uZXcoQ2xhc3NOYW1lKQ0KCWxvY2FsIEZ1bmMgPSBSZW1vdGVbRnVuY05hbWVdDQoJbG9jYWwgT3JpZ2luYWxGdW5jDQoNCgktLS8vIFJlbW90ZXMgd2lsbCBzaGFyZSB0aGUgc2FtZSBmdW5jdGlvbnMNCgktLS8vIAlGb3IgZXhhbXBsZSBGaXJlU2VydmVyIHdpbGwgYmUgaWRlbnRpY2FsDQoJLS0vLyBBZGRpb25hbGx5LCB0aGlzIGlzIGZvciBfX2luZGV4IGNhbGxzLg0KCS0tLy8gCUEgX19uYW1lY2FsbCBob29rIHdpbGwgbm90IGRldGVjdCB0aGlzDQoJT3JpZ2luYWxGdW5jID0gc2VsZjpIb29rRnVuY3Rpb24oRnVuYywgZnVuY3Rpb24oc2VsZiwgLi4uKQ0KCQktLS8vIENoZWNrIGlmIHRoZSBPYmplY3QgaXMgYWxsb3dlZCANCgkJaWYgbm90IFByb2Nlc3M6UmVtb3RlQWxsb3dlZChzZWxmLCAiU2VuZCIsIEZ1bmNOYW1lKSB0aGVuIHJldHVybiBlbmQNCg0KCQktLS8vIFByb2Nlc3MgdGhlIHJlbW90ZSBkYXRhDQoJCXJldHVybiBQcm9jZXNzUmVtb3RlKE9yaWdpbmFsRnVuYywgIl9faW5kZXgiLCBzZWxmLCBGdW5jTmFtZSwgLi4uKQ0KCWVuZCkNCmVuZA0KDQpmdW5jdGlvbiBIb29rOkhvb2tSZW1vdGVJbmRleGVzKCkNCglsb2NhbCBSZW1vdGVDbGFzc0RhdGEgPSBQcm9jZXNzLlJlbW90ZUNsYXNzRGF0YQ0KCWZvciBDbGFzc05hbWUsIERhdGEgaW4gUmVtb3RlQ2xhc3NEYXRhIGRvDQoJCWxvY2FsIEZ1bmNOYW1lID0gRGF0YS5TZW5kWzFdDQoJCXNlbGY6SG9va1JlbW90ZVR5cGVJbmRleChDbGFzc05hbWUsIEZ1bmNOYW1lKQ0KCWVuZA0KZW5kDQoNCmZ1bmN0aW9uIEhvb2s6QmVnaW5Ib29rcygpDQoJLS0vLyBIb29rIFJlbW90ZSBmdW5jdGlvbnMNCglzZWxmOkhvb2tSZW1vdGVJbmRleGVzKCkNCg0KCS0tLy8gTmFtZWNhbGwgaG9vaw0KCWxvY2FsIE9yaWdpbmFsTmFtZUNhbGwNCglPcmlnaW5hbE5hbWVDYWxsID0gc2VsZjpIb29rTWV0YU1ldGhvZChnYW1lLCAiX19uYW1lY2FsbCIsIGZ1bmN0aW9uKHNlbGYsIC4uLikNCgkJbG9jYWwgTWV0aG9kID0gZ2V0bmFtZWNhbGxtZXRob2QoKQ0KCQlyZXR1cm4gUHJvY2Vzc1JlbW90ZShPcmlnaW5hbE5hbWVDYWxsLCAiX19uYW1lY2FsbCIsIHNlbGYsIE1ldGhvZCwgLi4uKQ0KCWVuZCkNCg0KCU1lcmdlKHNlbGYsIHsNCgkJT3JpZ2luYWxOYW1lY2FsbCA9IE9yaWdpbmFsTmFtZUNhbGwsDQoJCS0tT3JpZ2luYWxJbmRleCA9IE9pDQoJfSkNCmVuZA0KDQpmdW5jdGlvbiBIb29rOkluZGV4KE9iamVjdDogSW5zdGFuY2UsIEtleTogc3RyaW5nKQ0KCXJldHVybiBPYmplY3RbS2V5XQ0KZW5kDQoNCmZ1bmN0aW9uIEhvb2s6UHVzaENvbmZpZyhPdmVyd3JpdGVzKQ0KICAgIE1lcmdlKHNlbGYsIE92ZXJ3cml0ZXMpDQplbmQNCg0KZnVuY3Rpb24gSG9vazpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykNCglsb2NhbCBTdWNjZXNzLCBGdW5jdGlvbiA9IHBjYWxsKGZ1bmN0aW9uKCkNCgkJcmV0dXJuIGdldGNhbGxiYWNrdmFsdWUoUmVtb3RlLCBNZXRob2QpDQoJZW5kKQ0KDQoJLS0vLyBTb21lIGV4ZWN1dG9ycyBsaWtlIFBvdGFzc2l1bSB3aWxsIHRocm93IGEgZXJyb3IgaWYgdGhlIENhbGxiYWNrIHZhbHVlIGlzIG5pbA0KCWlmIG5vdCBTdWNjZXNzIHRoZW4gcmV0dXJuIGVuZA0KCQ0KCWxvY2FsIEhvb2tTdWNjZXNzID0gcGNhbGwoZnVuY3Rpb24oKQ0KCQlzZWxmOkhvb2tGdW5jdGlvbihGdW5jdGlvbiwgZnVuY3Rpb24oc2VsZiwgLi4uKQ0KCQkJcmV0dXJuIENhbGxiYWNrKC4uLikNCgkJZW5kKQ0KCWVuZCkNCgkNCglpZiBIb29rU3VjY2VzcyB0aGVuIHJldHVybiBlbmQNCglSZW1vdGVbTWV0aG9kXSA9IENhbGxiYWNrDQplbmQNCg0KZnVuY3Rpb24gSG9vazpNdWx0aUNvbm5lY3QoUmVtb3RlcykNCglmb3IgXywgUmVtb3RlIGluIG5leHQsIFJlbW90ZXMgZG8NCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkNCgllbmQNCmVuZA0KDQpmdW5jdGlvbiBIb29rOkNvbm5lY3RDbGllbnRSZWNpdmUoUmVtb3RlKQ0KCS0tLy8gQ2hlY2sgaWYgdGhlIFJlbW90ZSBjbGFzcyBpcyBhbGxvd2VkIGZvciByZWNlaXZpbmcNCglsb2NhbCBBbGxvd2VkID0gUHJvY2VzczpSZW1vdGVBbGxvd2VkKFJlbW90ZSwgIlJlY2VpdmUiKQ0KCWlmIG5vdCBBbGxvd2VkIHRoZW4gcmV0dXJuIGVuZA0KDQoJLS0vLyBDaGVjayBpZiB0aGUgT2JqZWN0IGhhcyBSZW1vdGUgY2xhc3MgZGF0YQ0KICAgIGxvY2FsIENsYXNzRGF0YSA9IFByb2Nlc3M6R2V0Q2xhc3NEYXRhKFJlbW90ZSkNCiAgICBsb2NhbCBJc1JlbW90ZUZ1bmN0aW9uID0gQ2xhc3NEYXRhLklzUmVtb3RlRnVuY3Rpb24NCglsb2NhbCBOb1JlY2l2ZUhvb2sgPSBDbGFzc0RhdGEuTm9SZWNpdmVIb29rDQogICAgbG9jYWwgTWV0aG9kID0gQ2xhc3NEYXRhLlJlY2VpdmVbMV0NCglsb2NhbCBQcmV2aW91c0Z1bmN0aW9uID0gbmlsDQoNCgktLS8vIENoZWNrIGlmIHRoZSBSZWNpdmUgc2hvdWxkIGJlIGhvb2tlZA0KCWlmIE5vUmVjaXZlSG9vayB0aGVuIHJldHVybiBlbmQNCg0KCS0tLy8gTmV3IGNhbGxiYWNrIGZ1bmN0aW9uDQoJbG9jYWwgZnVuY3Rpb24gQ2FsbGJhY2soLi4uKQ0KICAgICAgICByZXR1cm4gUHJvY2VzczpQcm9jZXNzUmVtb3RlKHsNCiAgICAgICAgICAgIFJlbW90ZSA9IFJlbW90ZSwNCiAgICAgICAgICAgIE1ldGhvZCA9IE1ldGhvZCwNCiAgICAgICAgICAgIE9yaWdpbmFsRnVuYyA9IFByZXZpb3VzRnVuY3Rpb24sDQogICAgICAgICAgICBJc1JlY2VpdmUgPSB0cnVlLA0KICAgICAgICAgICAgTWV0YU1ldGhvZCA9ICJDb25uZWN0IiwNCgkJCUlzRXhwbG9pdCA9IGNoZWNrY2FsbGVyKCkNCiAgICAgICAgfSwgLi4uKQ0KCWVuZA0KDQoJLS0vLyBDb25uZWN0IHJlbW90ZQ0KCWlmIG5vdCBJc1JlbW90ZUZ1bmN0aW9uIHRoZW4NCiAgIAkJUmVtb3RlW01ldGhvZF06Q29ubmVjdChDYWxsYmFjaykNCgllbHNlIC0tIFJlbW90ZSBmdW5jdGlvbnMNCgkJc2VsZjpIb29rQ2xpZW50SW52b2tlKFJlbW90ZSwgTWV0aG9kLCBDYWxsYmFjaykNCgllbmQNCmVuZA0KDQpmdW5jdGlvbiBIb29rOkJlZ2luU2VydmljZShMaWJyYXJpZXMsIEV4dHJhRGF0YSwgQ2hhbm5lbElkLCAuLi4pDQoJLS0vLyBMaWJyYXJlaXMNCglsb2NhbCBSZXR1cm5TcG9vZnMgPSBMaWJyYXJpZXMuUmV0dXJuU3Bvb2ZzDQoJbG9jYWwgUHJvY2Vzc0xpYiA9IExpYnJhcmllcy5Qcm9jZXNzDQoJbG9jYWwgQ29tbXVuaWNhdGlvbiA9IExpYnJhcmllcy5Db21tdW5pY2F0aW9uDQoJbG9jYWwgR2VuZXJhdGlvbiA9IExpYnJhcmllcy5HZW5lcmF0aW9uDQoJbG9jYWwgQ29uZmlnID0gTGlicmFyaWVzLkNvbmZpZw0KDQoJLS0vLyBDaGVjayBmb3IgY29uZmlndXJhdGlvbiBvdmVyd3JpdGVzDQoJUHJvY2Vzc0xpYjpDaGVja0NvbmZpZyhDb25maWcpDQoNCgktLS8vIEluaXQgZGF0YQ0KCWxvY2FsIEluaXREYXRhID0gew0KCQlNb2R1bGVzID0gew0KCQkJUmV0dXJuU3Bvb2ZzID0gUmV0dXJuU3Bvb2ZzLA0KCQkJR2VuZXJhdGlvbiA9IEdlbmVyYXRpb24sDQoJCQlDb21tdW5pY2F0aW9uID0gQ29tbXVuaWNhdGlvbiwNCgkJCVByb2Nlc3MgPSBQcm9jZXNzTGliLA0KCQkJQ29uZmlnID0gQ29uZmlnLA0KCQkJSG9vayA9IHNlbGYNCgkJfSwNCgkJU2VydmljZXMgPSBzZXRtZXRhdGFibGUoe30sIHsNCgkJCV9faW5kZXggPSBmdW5jdGlvbihzZWxmLCBOYW1lOiBzdHJpbmcpOiBJbnN0YW5jZQ0KCQkJCWxvY2FsIFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoTmFtZSkNCgkJCQlyZXR1cm4gY2xvbmVyZWYoU2VydmljZSkNCgkJCWVuZCwNCgkJfSkNCgl9DQoNCgktLS8vIEluaXQgbGlicmFyaWVzDQoJQ29tbXVuaWNhdGlvbjpJbml0KEluaXREYXRhKQ0KCVByb2Nlc3NMaWI6SW5pdChJbml0RGF0YSkNCg0KCS0tLy8gQ29tbXVuaWNhdGlvbiBjb25maWd1cmF0aW9uDQoJbG9jYWwgQ2hhbm5lbCwgSXNXcmFwcGVkID0gQ29tbXVuaWNhdGlvbjpHZXRDb21tQ2hhbm5lbChDaGFubmVsSWQpDQoJQ29tbXVuaWNhdGlvbjpTZXRDaGFubmVsKENoYW5uZWwpDQoJQ29tbXVuaWNhdGlvbjpBZGRUeXBlQ2FsbGJhY2tzKHsNCgkJWyJSZW1vdGVEYXRhIl0gPSBmdW5jdGlvbihJZDogc3RyaW5nLCBSZW1vdGVEYXRhKQ0KCQkJUHJvY2Vzc0xpYjpTZXRSZW1vdGVEYXRhKElkLCBSZW1vdGVEYXRhKQ0KCQllbmQsDQoJCVsiQWxsUmVtb3RlRGF0YSJdID0gZnVuY3Rpb24oS2V5OiBzdHJpbmcsIFZhbHVlKQ0KCQkJUHJvY2Vzc0xpYjpTZXRBbGxSZW1vdGVEYXRhKEtleSwgVmFsdWUpDQoJCWVuZCwNCgkJWyJVcGRhdGVTcG9vZnMiXSA9IGZ1bmN0aW9uKENvbnRlbnQ6IHN0cmluZykNCgkJCWxvY2FsIFNwb29mcyA9IGxvYWRzdHJpbmcoQ29udGVudCkoKQ0KCQkJUHJvY2Vzc0xpYjpTZXROZXdSZXR1cm5TcG9vZnMoU3Bvb2ZzKQ0KCQllbmQNCgl9KQ0KCQ0KCS0tLy8gUHJvY2VzcyBjb25maWd1cmF0aW9uDQoJUHJvY2Vzc0xpYjpTZXRDaGFubmVsKENoYW5uZWwsIElzV3JhcHBlZCkNCglQcm9jZXNzTGliOlNldEV4dHJhRGF0YShFeHRyYURhdGEpDQoNCgktLS8vIEhvb2sgY29uZmlndXJhdGlvbg0KCXNlbGY6SW5pdChJbml0RGF0YSkNCglzZWxmOlBhdGNoRnVuY3Rpb25zKCkNCglzZWxmOkJlZ2luSG9va3MoKQ0KZW5kDQoNCmZ1bmN0aW9uIEhvb2s6TG9hZE1ldGFIb29rcyhBY3RvckNvZGU6IHN0cmluZywgQ2hhbm5lbElkOiBudW1iZXIpDQoJLS0vLyBIb29rIGFjdG9ycw0KCWlmIG5vdCBDb25maWd1cmF0aW9uLk5vQWN0b3JzIHRoZW4NCgkJc2VsZjpSdW5PbkFjdG9ycyhBY3RvckNvZGUsIENoYW5uZWxJZCkNCgllbmQNCg0KCS0tLy8gSG9vayBjdXJyZW50IHRocmVhZA0KCXNlbGY6QmVnaW5TZXJ2aWNlKE1vZHVsZXMsIG5pbCwgQ2hhbm5lbElkKSANCmVuZA0KDQpmdW5jdGlvbiBIb29rOkxvYWRSZWNlaXZlSG9va3MoKQ0KCWxvY2FsIE5vUmVjZWl2ZUhvb2tpbmcgPSBDb25maWcuTm9SZWNlaXZlSG9va2luZw0KCWxvY2FsIEJsYWNrTGlzdGVkU2VydmljZXMgPSBDb25maWcuQmxhY2tMaXN0ZWRTZXJ2aWNlcw0KDQoJaWYgTm9SZWNlaXZlSG9va2luZyB0aGVuIHJldHVybiBlbmQNCg0KCS0tLy8gUmVtb3RlIGFkZGVkDQoJZ2FtZS5EZXNjZW5kYW50QWRkZWQ6Q29ubmVjdChmdW5jdGlvbihSZW1vdGUpIC0tIFRPRE8NCgkJc2VsZjpDb25uZWN0Q2xpZW50UmVjaXZlKFJlbW90ZSkNCgllbmQpDQoNCgktLS8vIENvbGxlY3QgcmVtb3RlcyB3aXRoIG5pbCBwYXJlbnRzDQoJc2VsZjpNdWx0aUNvbm5lY3QoZ2V0bmlsaW5zdGFuY2VzKCkpDQoNCgktLS8vIFNlYXJjaCBmb3IgcmVtb3Rlcw0KCWZvciBfLCBTZXJ2aWNlIGluIG5leHQsIGdhbWU6R2V0Q2hpbGRyZW4oKSBkbw0KCQlpZiB0YWJsZS5maW5kKEJsYWNrTGlzdGVkU2VydmljZXMsIFNlcnZpY2UuQ2xhc3NOYW1lKSB0aGVuIGNvbnRpbnVlIGVuZA0KCQlzZWxmOk11bHRpQ29ubmVjdChTZXJ2aWNlOkdldERlc2NlbmRhbnRzKCkpDQoJZW5kDQplbmQNCg0KZnVuY3Rpb24gSG9vazpMb2FkSG9va3MoQWN0b3JDb2RlOiBzdHJpbmcsIENoYW5uZWxJZDogbnVtYmVyKQ0KCXNlbGY6TG9hZE1ldGFIb29rcyhBY3RvckNvZGUsIENoYW5uZWxJZCkNCglzZWxmOkxvYWRSZWNlaXZlSG9va3MoKQ0KZW5kDQoNCnJldHVybiBIb29rDQo=]]
},Flags={'base64',
[[dHlwZSBGbGFnVmFsdWUgPSBib29sZWFufG51bWJlcnxhbnkNCnR5cGUgRmxhZyA9IHsNCiAgICBWYWx1ZTogRmxhZ1ZhbHVlLA0KICAgIExhYmVsOiBzdHJpbmcsDQogICAgQ2F0ZWdvcnk6IHN0cmluZw0KfQ0KdHlwZSBGbGFncyA9IHsNCiAgICBbc3RyaW5nXTogRmxhZw0KfQ0KdHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCmxvY2FsIE1vZHVsZSA9IHsNCiAgICBGbGFncyA9IHsNCiAgICAgICAgLS0gUHJldmVudFJlbmFtaW5nID0gew0KICAgICAgICAtLSAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgLS0gICAgIExhYmVsID0gIk5vIHJlbmFtaW5nIiwNCiAgICAgICAgLS0gfSwNCiAgICAgICAgLS0gUHJldmVudFBhcmVudGluZyA9IHsNCiAgICAgICAgLS0gICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgIC0tICAgICBMYWJlbCA9ICJObyBwYXJlbnRpbmciLA0KICAgICAgICAtLSB9LA0KICAgICAgICBOb0NvbW1lbnRzID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIk5vIGNvbW1lbnRzIiwNCiAgICAgICAgfSwNCiAgICAgICAgU2VsZWN0TmV3ZXN0ID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIkF1dG8gc2VsZWN0IG5ld2VzdCIsDQogICAgICAgIH0sDQogICAgICAgIERlY29tcGlsZVBvcG91dCA9IHsgLS0gTG92cmUgU0hVU0gNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJQb3Atb3V0IGRlY29tcGlsZXMiLA0KICAgICAgICB9LA0KICAgICAgICBJZ25vcmVOaWwgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IHRydWUsDQogICAgICAgICAgICBMYWJlbCA9ICJJZ25vcmUgbmlsIHBhcmVudHMiLA0KICAgICAgICB9LA0KICAgICAgICBMb2dFeHBsb2l0ID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTG9nIGV4cGxvaXQgY2FsbHMiLA0KICAgICAgICB9LA0KICAgICAgICBMb2dSZWNpdmVzID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTG9nIHJlY2VpdmVzIiwNCiAgICAgICAgfSwNCiAgICAgICAgUGF1c2VkID0gew0KICAgICAgICAgICAgVmFsdWUgPSBmYWxzZSwNCiAgICAgICAgICAgIExhYmVsID0gIlBhdXNlZCIsDQogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlENCiAgICAgICAgfSwNCiAgICAgICAgS2V5YmluZHNFbmFibGVkID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiS2V5YmluZHMgRW5hYmxlZCINCiAgICAgICAgfSwNCiAgICAgICAgRmluZFN0cmluZ0Zvck5hbWUgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IHRydWUsDQogICAgICAgICAgICBMYWJlbCA9ICJGaW5kIGFyZyBmb3IgbmFtZSINCiAgICAgICAgfSwNCiAgICAgICAgVWlWaXNpYmxlID0gew0KICAgICAgICAgICAgVmFsdWUgPSB0cnVlLA0KICAgICAgICAgICAgTGFiZWwgPSAiVUkgVmlzaWJsZSIsDQogICAgICAgICAgICBLZXliaW5kID0gRW51bS5LZXlDb2RlLlANCiAgICAgICAgfSwNCiAgICAgICAgTm9UcmVlTm9kZXMgPSB7DQogICAgICAgICAgICBWYWx1ZSA9IGZhbHNlLA0KICAgICAgICAgICAgTGFiZWwgPSAiTm8gZ3JvdXBpbmciDQogICAgICAgIH0sDQogICAgICAgIFRhYmxlQXJncyA9IHsNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJUYWJsZSBhcmdzIg0KICAgICAgICB9LA0KICAgICAgICBOb1ZhcmlhYmxlcyA9IHsNCiAgICAgICAgICAgIFZhbHVlID0gZmFsc2UsDQogICAgICAgICAgICBMYWJlbCA9ICJObyBjb21wcmVzc2lvbiINCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KZnVuY3Rpb24gTW9kdWxlOkdldEZsYWdWYWx1ZShOYW1lOiBzdHJpbmcpOiBGbGFnVmFsdWUNCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpDQogICAgcmV0dXJuIEZsYWcuVmFsdWUNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6U2V0RmxhZ1ZhbHVlKE5hbWU6IHN0cmluZywgVmFsdWU6IEZsYWdWYWx1ZSkNCiAgICBsb2NhbCBGbGFnID0gc2VsZjpHZXRGbGFnKE5hbWUpDQogICAgRmxhZy5WYWx1ZSA9IFZhbHVlDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOlNldEZsYWdDYWxsYmFjayhOYW1lOiBzdHJpbmcsIENhbGxiYWNrOiAoLi4uYW55KSAtPiAuLi5hbnkpDQogICAgbG9jYWwgRmxhZyA9IHNlbGY6R2V0RmxhZyhOYW1lKQ0KICAgIEZsYWcuQ2FsbGJhY2sgPSBDYWxsYmFjaw0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpTZXRGbGFnQ2FsbGJhY2tzKERpY3Q6IHt9KQ0KICAgIGZvciBOYW1lLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55IGluIG5leHQsIERpY3QgZG8gDQogICAgICAgIHNlbGY6U2V0RmxhZ0NhbGxiYWNrKE5hbWUsIENhbGxiYWNrKQ0KICAgIGVuZA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpHZXRGbGFnKE5hbWU6IHN0cmluZyk6IEZsYWcNCiAgICBsb2NhbCBBbGxGbGFncyA9IHNlbGY6R2V0RmxhZ3MoKQ0KICAgIGxvY2FsIEZsYWcgPSBBbGxGbGFnc1tOYW1lXQ0KICAgIGFzc2VydChGbGFnLCAiRmxhZyBkb2VzIG5vdCBleGlzdCEiKQ0KICAgIHJldHVybiBGbGFnDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkFkZEZsYWcoTmFtZTogc3RyaW5nLCBGbGFnOiBGbGFnKQ0KICAgIGxvY2FsIEFsbEZsYWdzID0gc2VsZjpHZXRGbGFncygpDQogICAgQWxsRmxhZ3NbTmFtZV0gPSBGbGFnDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldEZsYWdzKCk6IEZsYWdzDQogICAgcmV0dXJuIHNlbGYuRmxhZ3MNCmVuZA0KDQpyZXR1cm4gTW9kdWxl]]
},Ui={'base64',
[[bG9jYWwgVWkgPSB7CglEZWZhdWx0RWRpdG9yQ29udGVudCA9ICItLSBKZXN1cyBsb3ZlcyB5b3UiLAoJTG9nTGltaXQgPSAxMDAsCiAgICBTZWFzb25MYWJlbHMgPSB7IAogICAgICAgIEphbnVhcnkgPSAi4puEICVzIOKbhCIsIAogICAgICAgIEZlYnJ1YXJ5ID0gIvCfjKjvuI8gJXMg8J+PgiIsIAogICAgICAgIE1hcmNoID0gIvCfjLkgJXPwn4y6ICIsIAogICAgICAgIEFwcmlsID0gIvCfkKMgJXMg4pyd77iPIiwgCiAgICAgICAgTWF5ID0gIvCfkJ0gJXMg8J+MniIsIAogICAgICAgIEp1bmUgPSAi8J+MsiAlcyDwn6WVIiwgCiAgICAgICAgSnVseSA9ICLwn4yKICVzIPCfjIUiLCAKICAgICAgICBBdWd1c3QgPSAi4piA77iPICVzIPCfjJ4iLCAKICAgICAgICBTZXB0ZW1iZXIgPSAi8J+NgSAlcyDwn42BIiwgCiAgICAgICAgT2N0b2JlciA9ICLwn46DICVzIPCfjoMiLCAKICAgICAgICBOb3ZlbWJlciA9ICLwn42CICVzIPCfjYIiLCAKICAgICAgICBEZWNlbWJlciA9ICLwn46EICVzIPCfjoEiCiAgICB9LAoJU2NhbGVzID0gewoJCVsiTW9iaWxlIl0gPSBVRGltMi5mcm9tT2Zmc2V0KDQ4MCwgMjgwKSwKCQlbIkRlc2t0b3AiXSA9IFVEaW0yLmZyb21PZmZzZXQoNjAwLCA0MDApLAoJfSwKICAgIEJhc2VDb25maWcgPSB7CiAgICAgICAgVGhlbWUgPSAiU2lnbWFTcHkiLAoJCVRpdGxlID0gIlNpZ21hIFNweSB8IENyZWF0ZWQgYnkgZGVwc28iLAogICAgICAgIE5vU2Nyb2xsID0gdHJ1ZSwKICAgIH0sCglPcHRpb25UeXBlcyA9IHsKCQlib29sZWFuID0gIkNoZWNrYm94IiwKCX0sCglEaXNwbGF5UmVtb3RlSW5mbyA9IHsKCQkiTWV0YU1ldGhvZCIsCgkJIk1ldGhvZCIsCgkJIlJlbW90ZSIsCgkJIkNhbGxpbmdTY3JpcHQiLAoJCSJJc0FjdG9yIiwKCQkiSWQiCgl9LAoKICAgIFdpbmRvdyA9IG5pbCwKICAgIFJhbmRvbVNlZWQgPSBSYW5kb20ubmV3KHRpY2soKSksCglMb2dzID0gc2V0bWV0YXRhYmxlKHt9LCB7X19tb2RlID0gImsifSksCglMb2dRdWV1ZSA9IHNldG1ldGF0YWJsZSh7fSwge19fbW9kZSA9ICJ2In0pLAp9IAoKdHlwZSB0YWJsZSA9IHsKCVthbnldOiBhbnkKfQoKdHlwZSBMb2cgPSB7CglSZW1vdGU6IEluc3RhbmNlLAoJTWV0aG9kOiBzdHJpbmcsCglBcmdzOiB0YWJsZSwKCUlzUmVjZWl2ZTogYm9vbGVhbj8sCglNZXRhTWV0aG9kOiBzdHJpbmc/LAoJT3JpZ25hbEZ1bmM6ICgoLi4uYW55KSAtPiAuLi5hbnkpPywKCUNhbGxpbmdTY3JpcHQ6IEluc3RhbmNlPywKCUNhbGxpbmdGdW5jdGlvbjogKCguLi5hbnkpIC0+IC4uLmFueSk/LAoJQ2xhc3NEYXRhOiB0YWJsZT8sCglSZXR1cm5WYWx1ZXM6IHRhYmxlPywKCVJlbW90ZURhdGE6IHRhYmxlPywKCUlkOiBzdHJpbmcsCglTZWxlY3RhYmxlOiB0YWJsZSwKCUhlYWRlckRhdGE6IHRhYmxlLAoJVmFsdWVTd2FwczogdGFibGUsCglUaW1lc3RhbXA6IG51bWJlciwKCUlzRXhwbG9pdDogYm9vbGVhbgp9CgotLS8vIENvbXBhdGliaWxpdHkKbG9jYWwgU2V0Q2xpcGJvYXJkID0gc2V0Y2xpcGJvYXJkIG9yIHRvY2xpcGJvYXJkIG9yIHNldF9jbGlwYm9hcmQKCi0tLy8gTGlicmFyaWVzCmxvY2FsIFJlR3VpID0gbG9hZHN0cmluZyhnYW1lOkh0dHBHZXQoJ2h0dHBzOi8vZ2l0aHViLmNvbS9kZXB0aHNvL0RlYXItUmVHdWkvcmF3L3JlZnMvaGVhZHMvbWFpbi9SZUd1aS5sdWEnKSwgIlJlR3VpIikoKQoKLS0vLyBNb2R1bGVzCmxvY2FsIEZsYWdzCmxvY2FsIEdlbmVyYXRpb24KbG9jYWwgUHJvY2Vzcwpsb2NhbCBIb29rIApsb2NhbCBDb25maWcKbG9jYWwgQ29tbXVuaWNhdGlvbgpsb2NhbCBGaWxlcwoKbG9jYWwgQWN0aXZlRGF0YSA9IG5pbApsb2NhbCBSZW1vdGVzQ291bnQgPSAwCgpsb2NhbCBUZXh0Rm9udCA9IEZvbnQuZnJvbUVudW0oRW51bS5Gb250LkNvZGUpCmxvY2FsIEZvbnRTdWNjZXNzID0gZmFsc2UKbG9jYWwgQ29tbUNoYW5uZWwKCmZ1bmN0aW9uIFVpOkluaXQoRGF0YSkKICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMKCgktLS8vIE1vZHVsZXMKCUZsYWdzID0gTW9kdWxlcy5GbGFncwoJR2VuZXJhdGlvbiA9IE1vZHVsZXMuR2VuZXJhdGlvbgoJUHJvY2VzcyA9IE1vZHVsZXMuUHJvY2VzcwoJSG9vayA9IE1vZHVsZXMuSG9vawoJQ29uZmlnID0gTW9kdWxlcy5Db25maWcKCUNvbW11bmljYXRpb24gPSBNb2R1bGVzLkNvbW11bmljYXRpb24KCUZpbGVzID0gTW9kdWxlcy5GaWxlcwoKCS0tLy8gUmVHdWkKCXNlbGY6TG9hZEZvbnQoKQoJc2VsZjpMb2FkUmVHdWkoKQoJc2VsZjpDaGVja1NjYWxlKCkKZW5kCgpmdW5jdGlvbiBVaTpTZXRDb21tQ2hhbm5lbChOZXdDb21tQ2hhbm5lbDogQmluZGFibGVFdmVudCkKCUNvbW1DaGFubmVsID0gTmV3Q29tbUNoYW5uZWwKZW5kCgpmdW5jdGlvbiBVaTpDaGVja1NjYWxlKCkKCWxvY2FsIEJhc2VDb25maWcgPSBzZWxmLkJhc2VDb25maWcKCWxvY2FsIFNjYWxlcyA9IHNlbGYuU2NhbGVzCgoJbG9jYWwgSXNNb2JpbGUgPSBSZUd1aTpJc01vYmlsZURldmljZSgpCglsb2NhbCBEZXZpY2UgPSBJc01vYmlsZSBhbmQgIk1vYmlsZSIgb3IgIkRlc2t0b3AiCgoJQmFzZUNvbmZpZy5TaXplID0gU2NhbGVzW0RldmljZV0KZW5kCgpmdW5jdGlvbiBVaTpTZXRDbGlwYm9hcmQoQ29udGVudDogc3RyaW5nKQoJd3JpdGVmaWxlKCJ0ZXN0LnR4dCIsIENvbnRlbnQpCmVuZAoKZnVuY3Rpb24gVWk6VHVyblNlYXNvbmFsKFRleHQ6IHN0cmluZyk6IHN0cmluZwogICAgbG9jYWwgU2Vhc29uTGFiZWxzID0gc2VsZi5TZWFzb25MYWJlbHMKICAgIGxvY2FsIE1vbnRoID0gb3MuZGF0ZSgiJUIiKQogICAgbG9jYWwgQmFzZSA9IFNlYXNvbkxhYmVsc1tNb250aF0KCiAgICByZXR1cm4gQmFzZTpmb3JtYXQoVGV4dCkKZW5kCgpmdW5jdGlvbiBVaTpMb2FkRm9udCgpCglsb2NhbCBGb250RmlsZSA9IHNlbGYuRm9udEpzb25GaWxlCgoJLS0vLyBHZXQgRm9udEZhY2UgQXNzZXRJZAoJbG9jYWwgQXNzZXRJZCA9IEZpbGVzOkxvYWRDdXN0b21hc3NldChGb250RmlsZSkKCWlmIG5vdCBBc3NldElkIHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gQ3JlYXRlIGN1c3RvbSBGb250RmFjZQoJbG9jYWwgTmV3Rm9udCA9IEZvbnQubmV3KEFzc2V0SWQpCglUZXh0Rm9udCA9IE5ld0ZvbnQKCUZvbnRTdWNjZXNzID0gdHJ1ZQplbmQKCmZ1bmN0aW9uIFVpOlNldEZvbnRGaWxlKEZvbnRGaWxlOiBzdHJpbmcpCglzZWxmLkZvbnRKc29uRmlsZSA9IEZvbnRGaWxlCmVuZAoKZnVuY3Rpb24gVWk6Rm9udFdhc1N1Y2Nlc3NmdWwoKQoJaWYgRm9udFN1Y2Nlc3MgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBFcnJvciBtZXNzYWdlCglzZWxmOlNob3dNb2RhbCh7CgkJIlVuZm9ydHVuYXRlbHkgeW91ciBleGVjdXRvciB3YXMgdW5hYmxlIHRvIGRvd25sb2FkIHRoZSBmb250IGFuZCB0aGVyZWZvcmUgc3dpdGNoZWQgdG8gdGhlIERhcmsgdGhlbWUiLAoJCSJcbklmIHlvdSB3b3VsZCBsaWtlIHRvIHVzZSB0aGUgSW1HdWkgdGhlbWUsIFxucGxlYXNlIGRvd25sb2FkIHRoZSBmb250IChhc3NldHMvUHJvZ2d5Q2xlYW4udHRmKSIsCgkJImFuZCBwdXQgcHV0IGl0IGluIHlvdXIgd29ya3NwYWNlIGZvbGRlclxuKFNpZ21hIFNweS9hc3NldHMpIgoJfSkKZW5kCgpmdW5jdGlvbiBVaTpMb2FkUmVHdWkoKQoJbG9jYWwgVGhlbWVDb25maWcgPSBDb25maWcuVGhlbWVDb25maWcKCVRoZW1lQ29uZmlnLlRleHRGb250ID0gVGV4dEZvbnQKCgktLS8vIFJlR3VpCglSZUd1aTpEZWZpbmVUaGVtZSgiU2lnbWFTcHkiLCBUaGVtZUNvbmZpZykKZW5kCgp0eXBlIENyZWF0ZUJ1dHRvbnMgPSB7CglCYXNlOiB0YWJsZT8sCglCdXR0b25zOiB0YWJsZSwKCU5vVGFibGU6IGJvb2xlYW4/Cn0KZnVuY3Rpb24gVWk6Q3JlYXRlQnV0dG9ucyhQYXJlbnQsIERhdGE6IENyZWF0ZUJ1dHRvbnMpCglsb2NhbCBCYXNlID0gRGF0YS5CYXNlIG9yIHt9Cglsb2NhbCBCdXR0b25zID0gRGF0YS5CdXR0b25zCglsb2NhbCBOb1RhYmxlID0gRGF0YS5Ob1RhYmxlCgoJLS0vLyBDcmVhdGUgdGFibGUgbGF5b3V0CglpZiBub3QgTm9UYWJsZSB0aGVuCgkJUGFyZW50ID0gUGFyZW50OlRhYmxlKHsKCQkJTWF4Q29sdW1ucyA9IDMKCQl9KTpOZXh0Um93KCkKCWVuZAoKCS0tLy8gQ3JlYXRlIGJ1dHRvbnMKCWZvciBfLCBCdXR0b24gaW4gbmV4dCwgQnV0dG9ucyBkbwoJCWxvY2FsIENvbnRhaW5lciA9IFBhcmVudAoJCWlmIG5vdCBOb1RhYmxlIHRoZW4KCQkJQ29udGFpbmVyID0gUGFyZW50Ok5leHRDb2x1bW4oKQoJCWVuZAoKCQlSZUd1aTpDaGVja0NvbmZpZyhCdXR0b24sIEJhc2UpCgkJQ29udGFpbmVyOkJ1dHRvbihCdXR0b24pCgllbmQKZW5kCgpmdW5jdGlvbiBVaTpDcmVhdGVXaW5kb3coKQogICAgbG9jYWwgQmFzZUNvbmZpZyA9IHNlbGYuQmFzZUNvbmZpZwoJbG9jYWwgQ29uZmlnID0gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShCYXNlQ29uZmlnKQoJbG9jYWwgU2Vhc29uYWwgPSBzZWxmOlR1cm5TZWFzb25hbChDb25maWcuVGl0bGUpCglDb25maWcuVGl0bGUgPSBTZWFzb25hbAoKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJbG9jYWwgV2luZG93ID0gUmVHdWk6V2luZG93KENvbmZpZykKCgktLS8vIFN3aXRjaCB0byBEYXJrVGhlbWUgaW5zdGVhZCBvZiB0aGUgSW1HdWkgdGhlbWUgaWYgdGhlIGZvbnQgY2Fubm90IGJlIGxvYWRlZAoJaWYgbm90IEZvbnRTdWNjZXNzIHRoZW4gCgkJV2luZG93OlNldFRoZW1lKCJEYXJrVGhlbWUiKQoJZW5kCgkKCS0tLy8gQ3JlYXRlIFdpbmRvdwoJcmV0dXJuIFdpbmRvdwplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZU1haW5XaW5kb3coKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coKQoJc2VsZi5XaW5kb3cgPSBXaW5kb3cKCgktLS8vIENoZWNrIGlmIHRoZSBmb250IHdhcyBzdWNjZXNzZnVsbHkgZG93bmxvYWRlZAoJc2VsZjpGb250V2FzU3VjY2Vzc2Z1bCgpCgktLXNlbGY6QXVyYUNvdW50ZXJTZXJ2aWNlKCkKCgktLS8vIFVpVmlzaWJsZSBmbGFnIGNhbGxiYWNrCglGbGFnczpTZXRGbGFnQ2FsbGJhY2soIlVpVmlzaWJsZSIsIGZ1bmN0aW9uKHNlbGYsIFZpc2libGUpCgkJV2luZG93OlNldFZpc2libGUoVmlzaWJsZSkKCWVuZCkKCglyZXR1cm4gV2luZG93CmVuZAoKZnVuY3Rpb24gVWk6U2hvd01vZGFsKExpbmVzOiB0YWJsZSkKCWxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93Cglsb2NhbCBNZXNzYWdlID0gdGFibGUuY29uY2F0KExpbmVzLCAiXG4iKQoKCS0tLy8gTW9kYWwgV2luZG93Cglsb2NhbCBNb2RhbFdpbmRvdyA9IFdpbmRvdzpQb3B1cE1vZGFsKHsKCQlUaXRsZSA9ICJTaWdtYSBTcHkiCgl9KQoJTW9kYWxXaW5kb3c6TGFiZWwoewoJCVRleHQgPSBNZXNzYWdlLAoJCVJpY2hUZXh0ID0gdHJ1ZSwKCQlUZXh0V3JhcHBlZCA9IHRydWUKCX0pCglNb2RhbFdpbmRvdzpCdXR0b24oewoJCVRleHQgPSAiT2theSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCU1vZGFsV2luZG93OkNsb3NlUG9wdXAoKQoJCWVuZCwKCX0pCmVuZAoKZnVuY3Rpb24gVWk6U2hvd1Vuc3VwcG9ydGVkRXhlY3V0b3IoTmFtZTogc3RyaW5nKQoJVWk6U2hvd01vZGFsKHsKCQkiVW5mb3J0dW5hdGVseSBTaWdtYSBTcHkgaXMgbm90IHN1cHBvcnRlZCBvbiB5b3VyIGV4ZWN1dG9yIiwKCQkiVGhlIGJlc3QgZnJlZSBvcHRpb24gaXMgU3dpZnQgKGRpc2NvcmQuZ2cvZ2V0c3dpZnRnZykiLAoJCWBcbllvdXIgZXhlY3V0b3I6IHtOYW1lfWAKCX0pCmVuZAoKZnVuY3Rpb24gVWk6U2hvd1Vuc3VwcG9ydGVkKEZ1bmNOYW1lOiBzdHJpbmcpCglVaTpTaG93TW9kYWwoewoJCSJVbmZvcnR1bmF0ZWx5IFNpZ21hIFNweSBpcyBub3Qgc3VwcG9ydGVkIG9uIHlvdXIgZXhlY3V0b3IiLAoJCWBcbk1pc3NpbmcgZnVuY3Rpb246IHtGdW5jTmFtZX1gCgl9KQplbmQKCmZ1bmN0aW9uIFVpOkNyZWF0ZU9wdGlvbnNGb3JEaWN0KFBhcmVudCwgRGljdDogdGFibGUsIENhbGxiYWNrKQoJbG9jYWwgT3B0aW9ucyA9IHt9CgoJLS0vLyBEaWN0b25hcnkgd3JhcAoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgRGljdCBkbwoJCU9wdGlvbnNbS2V5XSA9IHsKCQkJVmFsdWUgPSBWYWx1ZSwKCQkJTGFiZWwgPSBLZXksCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oXywgVmFsdWUpCgkJCQlEaWN0W0tleV0gPSBWYWx1ZQoKCQkJCS0tLy8gSW52b2tlIGNhbGxiYWNrCgkJCQlpZiBub3QgQ2FsbGJhY2sgdGhlbiByZXR1cm4gZW5kCgkJCQlDYWxsYmFjaygpCgkJCWVuZAoJCX0KCWVuZAoKCS0tLy8gQ3JlYXRlIGVsZW1lbnRzCglzZWxmOkNyZWF0ZUVsZW1lbnRzKFBhcmVudCwgT3B0aW9ucykKZW5kCgpmdW5jdGlvbiBVaTpDaGVja0tleWJpbmRMYXlvdXQoQ29udGFpbmVyLCBLZXlDb2RlOiBFbnVtLktleUNvZGUsIENhbGxiYWNrKQoJaWYgbm90IEtleUNvZGUgdGhlbiByZXR1cm4gQ29udGFpbmVyIGVuZAoKCS0tLy8gQ3JlYXRlIFJvdyBsYXlvdXQKCUNvbnRhaW5lciA9IENvbnRhaW5lcjpSb3coewoJCUhvcml6b250YWxGbGV4ID0gRW51bS5VSUZsZXhBbGlnbm1lbnQuU3BhY2VCZXR3ZWVuCgl9KQoKCS0tLy8gQWRkIEtleWJpbmQgZWxlbWVudAoJQ29udGFpbmVyOktleWJpbmQoewoJCUxhYmVsID0gIiIsCgkJVmFsdWUgPSBLZXlDb2RlLAoJCUxheW91dE9yZGVyID0gMiwKCQlJZ25vcmVHYW1lUHJvY2Vzc2VkID0gZmFsc2UsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCS0tLy8gQ2hlY2sgaWYga2V5YmluZHMgYXJlIGVuYWJsZWQKCQkJbG9jYWwgRW5hYmxlZCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiS2V5YmluZHNFbmFibGVkIikKCQkJaWYgbm90IEVuYWJsZWQgdGhlbiByZXR1cm4gZW5kCgoJCQktLS8vIEludm9rZSBjYWxsYmFjawoJCQlDYWxsYmFjaygpCgkJZW5kLAoJfSkKCglyZXR1cm4gQ29udGFpbmVyCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlRWxlbWVudHMoUGFyZW50LCBPcHRpb25zKQoJbG9jYWwgT3B0aW9uVHlwZXMgPSBzZWxmLk9wdGlvblR5cGVzCgkKCS0tLy8gQ3JlYXRlIHRhYmxlIGxheW91dAoJbG9jYWwgVGFibGUgPSBQYXJlbnQ6VGFibGUoewoJCU1heENvbHVtbnMgPSAzCgl9KTpOZXh0Um93KCkKCglmb3IgTmFtZSwgRGF0YSBpbiBPcHRpb25zIGRvCgkJbG9jYWwgVmFsdWUgPSBEYXRhLlZhbHVlCgkJbG9jYWwgVHlwZSA9IHR5cGVvZihWYWx1ZSkKCgkJLS0vLyBBZGQgbWlzc2luZyB2YWx1ZXMgaW50byBvcHRpb25zIHRhYmxlCgkJUmVHdWk6Q2hlY2tDb25maWcoRGF0YSwgewoJCQlDbGFzcyA9IE9wdGlvblR5cGVzW1R5cGVdLAoJCQlMYWJlbCA9IE5hbWUsCgkJfSkKCQkKCQktLS8vIENoZWNrIGlmIGEgZWxlbWVudCB0eXBlIGV4aXN0cyBmb3IgdmFsdWUgdHlwZQoJCWxvY2FsIENsYXNzID0gRGF0YS5DbGFzcwoJCWFzc2VydChDbGFzcywgYE5vIHtUeXBlfSB0eXBlIGV4aXN0cyBmb3Igb3B0aW9uYCkKCgkJbG9jYWwgQ29udGFpbmVyID0gVGFibGU6TmV4dENvbHVtbigpCgkJbG9jYWwgQ2hlY2tib3ggPSBuaWwKCgkJLS0vLyBDaGVjayBmb3IgYSBrZXliaW5kIGxheW91dAoJCWxvY2FsIEtleWJpbmQgPSBEYXRhLktleWJpbmQKCQlDb250YWluZXIgPSBzZWxmOkNoZWNrS2V5YmluZExheW91dChDb250YWluZXIsIEtleWJpbmQsIGZ1bmN0aW9uKCkKCQkJQ2hlY2tib3g6VG9nZ2xlKCkKCQllbmQpCgkJCgkJLS0vLyBDcmVhdGUgY29sdW1uIGFuZCBlbGVtZW50CgkJQ2hlY2tib3ggPSBDb250YWluZXJbQ2xhc3NdKENvbnRhaW5lciwgRGF0YSkKCWVuZAplbmQKCi0tLy8gQm9paWlpIHdoYXQgZGlkIHlvdSBzYXkgYWJvdXQgU2lnbWEgU3B5IPCfkoDwn5KACmZ1bmN0aW9uIFVpOkRpc3BsYXlBdXJhKCkKICAgIGxvY2FsIFdpbmRvdyA9IHNlbGYuV2luZG93CiAgICBsb2NhbCBSYW5kID0gc2VsZi5SYW5kb21TZWVkCgoJLS0vLyBBdXJhIChib2lpaWlpKQogICAgbG9jYWwgQVVSQSA9IFJhbmQ6TmV4dEludGVnZXIoMSwgOTk5OTk5OSkKICAgIGxvY2FsIEFVUkFERUxBWSA9IFJhbmQ6TmV4dEludGVnZXIoMSwgNSkKCgktLS8vIFRpdGxlCglsb2NhbCBUaXRsZSA9IGBTaWdtYSBTcHkgLSBEZXBzbyB8IEFVUkE6IHtBVVJBfWAKCWxvY2FsIFNlYXNvbmFsID0gc2VsZjpUdXJuU2Vhc29uYWwoVGl0bGUpCiAgICBXaW5kb3c6U2V0VGl0bGUoU2Vhc29uYWwpCgogICAgd2FpdChBVVJBREVMQVkpCmVuZAoKZnVuY3Rpb24gVWk6QXVyYUNvdW50ZXJTZXJ2aWNlKCkKICAgIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgICAgIHdoaWxlIHRydWUgZG8KICAgICAgICAgICAgc2VsZjpEaXNwbGF5QXVyYSgpCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlV2luZG93Q29udGVudChXaW5kb3cpCiAgICAtLS8vIFdpbmRvdyBncm91cAogICAgbG9jYWwgTGF5b3V0ID0gV2luZG93Okxpc3QoewogICAgICAgIFVpUGFkZGluZyA9IDIsCiAgICAgICAgSG9yaXpvbnRhbEZsZXggPSBFbnVtLlVJRmxleEFsaWdubWVudC5GaWxsLAogICAgICAgIFZlcnRpY2FsRmxleCA9IEVudW0uVUlGbGV4QWxpZ25tZW50LkZpbGwsCiAgICAgICAgRmlsbERpcmVjdGlvbiA9IEVudW0uRmlsbERpcmVjdGlvbi5WZXJ0aWNhbCwKICAgICAgICBGaWxsID0gdHJ1ZQogICAgfSkKCgktLS8vIFJlbW90ZXMgbGlzdAogICAgc2VsZi5SZW1vdGVzTGlzdCA9IExheW91dDpDYW52YXMoewogICAgICAgIFNjcm9sbCA9IHRydWUsCiAgICAgICAgVWlQYWRkaW5nID0gNSwKICAgICAgICBBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLk5vbmUsCiAgICAgICAgRmxleE1vZGUgPSBFbnVtLlVJRmxleE1vZGUuTm9uZSwKICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDEzMCwgMSwgMCkKICAgIH0pCgoJLS0vLyBUYWIgYm94Cglsb2NhbCBJbmZvU2VsZWN0b3IgPSBMYXlvdXQ6VGFiU2VsZWN0b3IoewogICAgICAgIE5vQW5pbWF0aW9uID0gdHJ1ZSwKICAgICAgICBTaXplID0gVURpbTIubmV3KDEsIC0xMzAsIDAuNCwgMCksCiAgICB9KQoKCXNlbGYuSW5mb1NlbGVjdG9yID0gSW5mb1NlbGVjdG9yCglzZWxmLkNhbnZhc0xheW91dCA9IExheW91dAoKCS0tLy8gTWFrZSB0YWJzCglzZWxmOk1ha2VFZGl0b3JUYWIoSW5mb1NlbGVjdG9yKQoJc2VsZjpNYWtlT3B0aW9uc1RhYihJbmZvU2VsZWN0b3IpCgkKCWlmIENvbmZpZy5EZWJ1ZyB0aGVuCgkJc2VsZjpDb25zb2xlVGFiKEluZm9TZWxlY3RvcikKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOkNvbnNvbGVUYWIoSW5mb1NlbGVjdG9yKQoJbG9jYWwgVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9ICJDb25zb2xlIgoJfSkKCglsb2NhbCBCdXR0b25zUm93ID0gVGFiOlJvdygpCglCdXR0b25zUm93OkJ1dHRvbih7CgkJVGV4dCA9ICJDbGVhciIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCXNlbGYuQ29uc29sZTpDbGVhcigpCgkJZW5kCgl9KQoJQnV0dG9uc1JvdzpCdXR0b24oewoJCVRleHQgPSAiQ29weSIsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCWxvY2FsIENvbnRlbnQgPSBzZWxmLkNvbnNvbGU6R2V0VmFsdWUoKQoJCQl0b2NsaXBib2FyZChDb250ZW50KQoJCWVuZAoJfSkKCUJ1dHRvbnNSb3c6QnV0dG9uKHsKCQlUZXh0ID0gIlBhdXNlIiwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKHNlbGYpCgkJCWxvY2FsIEVuYWJsZWQgPSBub3Qgc2VsZi5Db25zb2xlLkVuYWJsZWQKCQkJbG9jYWwgVGV4dCA9IEVuYWJsZWQgYW5kICJQYXVzZWQiIG9yICJQYXVzZSIKCQkJc2VsZi5UZXh0ID0gVGV4dAoKCQkJLS0vLyBVcGRhdGUgY29uc29sZQoJCQlzZWxmLkNvbnNvbGUuRW5hYmxlZCA9IEVuYWJsZWQKCQllbmQsCgl9KQoJQnV0dG9uc1JvdzpFeHBhbmQoKQoKCS0tLy8gQ3JlYXRlIGNvbnNvbGUKCXNlbGYuQ29uc29sZSA9IFRhYjpDb25zb2xlKHsKCQlUZXh0ID0gIi0tIENyZWF0ZWQgYnkgZGVwc28iLAoJCVJlYWRPbmx5ID0gdHJ1ZSwKCQlCb3JkZXIgPSBmYWxzZSwKCQlGaWxsID0gdHJ1ZSwKCQlFbmFibGVkID0gdHJ1ZSwKCQlBdXRvU2Nyb2xsID0gdHJ1ZSwKCQlSaWNoVGV4dCA9IHRydWUsCgkJTWF4TGluZXMgPSA1MAoJfSkKZW5kCgpmdW5jdGlvbiBVaTpDb25zb2xlTG9nKC4uLjogc3RyaW5nPykKCWxvY2FsIENvbnNvbGUgPSBzZWxmLkNvbnNvbGUKCWlmIG5vdCBDb25zb2xlIHRoZW4gcmV0dXJuIGVuZAoKCUNvbnNvbGU6QXBwZW5kVGV4dCguLi4pCmVuZAoKZnVuY3Rpb24gVWk6TWFrZU9wdGlvbnNUYWIoSW5mb1NlbGVjdG9yKQoJbG9jYWwgVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9ICJPcHRpb25zIgoJfSkKCgktLS8vIEFkZCBnbG9iYWwgb3B0aW9ucwoJVGFiOlNlcGFyYXRvcih7VGV4dD0iTG9ncyJ9KQoJc2VsZjpDcmVhdGVCdXR0b25zKFRhYiwgewoJCUJhc2UgPSB7CgkJCVNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjApLAoJCQlBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCgkJfSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGxvZ3MiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgVGFiID0gQWN0aXZlRGF0YSBhbmQgQWN0aXZlRGF0YS5UYWIgb3IgbmlsCgoJCQkJCS0tLy8gUmVtb3ZlIHRoZSBSZW1vdGUgdGFiCgkJCQkJaWYgVGFiIHRoZW4KCQkJCQkJSW5mb1NlbGVjdG9yOlJlbW92ZVRhYihUYWIpCgkJCQkJZW5kCgoJCQkJCS0tLy8gQ2xlYXIgYWxsIGxvZyBlbGVtZW50cwoJCQkJCUFjdGl2ZURhdGEgPSBuaWwKCQkJCQlzZWxmOkNsZWFyTG9ncygpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ2xlYXIgYmxvY2tzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiQmxvY2tlZCIsIGZhbHNlKQoJCQkJZW5kLAoJCQl9LAoJCQl7CgkJCQlUZXh0ID0gIkNsZWFyIGV4Y2x1ZGVzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCVByb2Nlc3M6VXBkYXRlQWxsUmVtb3RlRGF0YSgiRXhjbHVkZWQiLCBmYWxzZSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDb3B5IERpc2NvcmQiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJc2VsZjpTZXRDbGlwYm9hcmQoImh0dHBzOi8vZGlzY29yZC5nZy9zOW5nbVVEV2diIikKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJDb3B5IEdpdGh1YiIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlzZWxmOlNldENsaXBib2FyZCgiaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vU2lnbWEtU3B5IikKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJFZGl0IFNwb29mcyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlzZWxmOkVkaXRGaWxlKCJSZXR1cm4gc3Bvb2ZzLmx1YSIsIHRydWUsIGZ1bmN0aW9uKFdpbmRvdywgQ29udGVudDogc3RyaW5nKQoJCQkJCQlXaW5kb3c6Q2xvc2UoKQoJCQkJCQlDb21tQ2hhbm5lbDpGaXJlKCJVcGRhdGVTcG9vZnMiLCBDb250ZW50KQoJCQkJCWVuZCkKCQkJCWVuZCwKCQkJfQoJCX0KCX0pCgoJLS0vLyBGbGFnIG9wdGlvbnMKCVRhYjpTZXBhcmF0b3Ioe1RleHQ9IlNldHRpbmdzIn0pCglzZWxmOkNyZWF0ZUVsZW1lbnRzKFRhYiwgRmxhZ3M6R2V0RmxhZ3MoKSkKCglzZWxmOkFkZERldGFpbHNTZWN0aW9uKFRhYikKZW5kCgpmdW5jdGlvbiBVaTpBZGREZXRhaWxzU2VjdGlvbihPcHRpb25zVGFiKQoJT3B0aW9uc1RhYjpTZXBhcmF0b3Ioe1RleHQ9IkluZm9ybWF0aW9uIn0pCglPcHRpb25zVGFiOkJ1bGxldFRleHQoewoJCVJvd3MgPSB7CgkJCSJTaWdtYSBzcHkgLSBXcml0dGVuIGJ5IGRlcHNvISIsCgkJCSJMaWJyYXJpZXM6IFJvYmxveC1QYXJzZXIsIERlYXItUmVHdWkiLAoJCQkiVGhhbmsgeW91IHN5bi5sdWEgZm9yIHN1Z2dlc3RpbmcgSSBtYWtlIHRoaXMiCgkJfQoJfSkKZW5kCgpsb2NhbCBmdW5jdGlvbiBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKE5hbWU6IHN0cmluZykKCXJldHVybiBmdW5jdGlvbiguLi4pCgkJaWYgbm90IEFjdGl2ZURhdGEgdGhlbiByZXR1cm4gZW5kCgkJcmV0dXJuIEFjdGl2ZURhdGFbTmFtZV0oQWN0aXZlRGF0YSwgLi4uKQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6TWFrZUVkaXRvclRhYihJbmZvU2VsZWN0b3IpCglsb2NhbCBEZWZhdWx0ID0gc2VsZi5EZWZhdWx0RWRpdG9yQ29udGVudAoJbG9jYWwgU3ludGF4Q29sb3JzID0gQ29uZmlnLlN5bnRheENvbG9ycwoKCS0tLy8gQ3JlYXRlIHRhYgoJbG9jYWwgRWRpdG9yVGFiID0gSW5mb1NlbGVjdG9yOkNyZWF0ZVRhYih7CgkJTmFtZSA9ICJFZGl0b3IiCgl9KQoKCS0tLy8gSURFCglsb2NhbCBDb2RlRWRpdG9yID0gRWRpdG9yVGFiOkNvZGVFZGl0b3IoewoJCUZpbGwgPSB0cnVlLAoJCUVkaXRhYmxlID0gdHJ1ZSwKCQlGb250U2l6ZSA9IDEzLAoJCUNvbG9ycyA9IFN5bnRheENvbG9ycywKCQlGb250RmFjZSA9IFRleHRGb250LAoJCVRleHQgPSBEZWZhdWx0Cgl9KQoKCS0tLy8gQnV0dG9ucwoJbG9jYWwgQnV0dG9uc1JvdyA9IEVkaXRvclRhYjpSb3coKQoJc2VsZjpDcmVhdGVCdXR0b25zKEJ1dHRvbnNSb3csIHsKCQlOb1RhYmxlID0gdHJ1ZSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNvcHkiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCQlzZWxmOlNldENsaXBib2FyZChTY3JpcHQpCgkJCQllbmQKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJSdW4iLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCQlsb2NhbCBGdW5jLCBFcnJvciA9IGxvYWRzdHJpbmcoU2NyaXB0LCAiU2lnbWFTcHktVVNFUlNDUklQVCIpCgoJCQkJCS0tLy8gU3ludGF4IGNoZWNrCgkJCQkJaWYgbm90IEZ1bmMgdGhlbgoJCQkJCQlzZWxmOlNob3dNb2RhbCh7IkVycm9yIHJ1bm5pbmcgc2NyaXB0IVxuIiwgRXJyb3J9KQoJCQkJCQlyZXR1cm4KCQkJCQllbmQKCgkJCQkJRnVuYygpCgkJCQllbmQKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJHZXQgcmV0dXJuIiwKCQkJCUNhbGxiYWNrID0gTWFrZUFjdGl2ZURhdGFDYWxsYmFjaygiR2V0UmV0dXJuIikKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJTY3JpcHQiLAoJCQkJQ2FsbGJhY2sgPSBNYWtlQWN0aXZlRGF0YUNhbGxiYWNrKCJTY3JpcHRPcHRpb25zIikKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJCdWlsZCIsCgkJCQlDYWxsYmFjayA9IE1ha2VBY3RpdmVEYXRhQ2FsbGJhY2soIkJ1aWxkU2NyaXB0IikKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJQb3Atb3V0IiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIFNjcmlwdCA9IENvZGVFZGl0b3I6R2V0VGV4dCgpCgkJCQkJbG9jYWwgVGlsZSA9IEFjdGl2ZURhdGEgYW5kIEFjdGl2ZURhdGEuVGFzayBvciAiU2lnbWEgU3B5IgoJCQkJCXNlbGY6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhTY3JpcHQsIHsKCQkJCQkJVGl0bGUgPSBUaWxlCgkJCQkJfSkKCQkJCWVuZAoJCQl9LAoJCX0KCX0pCgkKCXNlbGYuQ29kZUVkaXRvciA9IENvZGVFZGl0b3IKZW5kCgpmdW5jdGlvbiBVaTpTaG91bGRGb2N1cyhUYWIpOiBib29sZWFuCglsb2NhbCBJbmZvU2VsZWN0b3IgPSBzZWxmLkluZm9TZWxlY3RvcgoJbG9jYWwgQWN0aXZlVGFiID0gSW5mb1NlbGVjdG9yLkFjdGl2ZVRhYgoKCS0tLy8gSWYgdGhlcmUgaXMgYW4gZW1wdHkgdGFiCglpZiBub3QgQWN0aXZlVGFiIHRoZW4KCQlyZXR1cm4gdHJ1ZQoJZW5kCgoJcmV0dXJuIEluZm9TZWxlY3RvcjpDb21wYXJlVGFicyhBY3RpdmVUYWIsIFRhYikKZW5kCgpmdW5jdGlvbiBVaTpNYWtlRWRpdG9yUG9wb3V0V2luZG93KENvbnRlbnQ6IHN0cmluZywgV2luZG93Q29uZmlnOiB0YWJsZSkKCWxvY2FsIFdpbmRvdyA9IHNlbGY6Q3JlYXRlV2luZG93KFdpbmRvd0NvbmZpZykKCWxvY2FsIEJ1dHRvbnMgPSBXaW5kb3dDb25maWcuQnV0dG9ucyBvciB7fQoJbG9jYWwgQ29sb3JzID0gQ29uZmlnLlN5bnRheENvbG9ycwoKCWxvY2FsIENvZGVFZGl0b3IgPSBXaW5kb3c6Q29kZUVkaXRvcih7CgkJVGV4dCA9IENvbnRlbnQsCgkJRWRpdGFibGUgPSB0cnVlLAoJCUZpbGwgPSB0cnVlLAoJCUZvbnRTaXplID0gMTMsCgkJQ29sb3JzID0gQ29sb3JzLAoJCUZvbnRGYWNlID0gVGV4dEZvbnQKCX0pCgoJLS0vLyBEZWZhdWx0IGJ1dHRvbnMKCXRhYmxlLmluc2VydChCdXR0b25zLCB7CgkJVGV4dCA9ICJDb3B5IiwKCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJc2VsZjpTZXRDbGlwYm9hcmQoU2NyaXB0KQoJCWVuZAoJfSkKCgktLS8vIEJ1dHRvbnMKCWxvY2FsIEJ1dHRvbnNSb3cgPSBXaW5kb3c6Um93KCkKCXNlbGY6Q3JlYXRlQnV0dG9ucyhCdXR0b25zUm93LCB7CgkJTm9UYWJsZSA9IHRydWUsCgkJQnV0dG9ucyA9IEJ1dHRvbnMKCX0pCgoJV2luZG93OkNlbnRlcigpCglyZXR1cm4gQ29kZUVkaXRvciwgV2luZG93CmVuZAoKZnVuY3Rpb24gVWk6RWRpdEZpbGUoRmlsZVBhdGg6IHN0cmluZywgSW5Gb2xkZXI6IGJvb2xlYW4sIE9uU2F2ZUZ1bmM6ICgodGFibGUsIHN0cmluZykgLT4gbmlsKT8pCglsb2NhbCBGb2xkZXIgPSBGaWxlcy5Gb2xkZXJOYW1lCglsb2NhbCBDb2RlRWRpdG9yLCBXaW5kb3cKCgktLS8vIFJlbGF0aXZlIHRvIFNpZ21hIFNweSBmb2xkZXIKCWlmIEluRm9sZGVyIHRoZW4KCQlGaWxlUGF0aCA9IGB7Rm9sZGVyfS97RmlsZVBhdGh9YAoJZW5kCgoJLS0vLyBHZXQgZmlsZSBjb250ZW50Cglsb2NhbCBDb250ZW50ID0gcmVhZGZpbGUoRmlsZVBhdGgpCglDb250ZW50ID0gQ29udGVudDpnc3ViKCJcclxuIiwgIlxuIikKCQoJbG9jYWwgQnV0dG9ucyA9IHsKCQl7CgkJCVRleHQgPSAiU2F2ZSIsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJbG9jYWwgU2NyaXB0ID0gQ29kZUVkaXRvcjpHZXRUZXh0KCkKCQkJCWxvY2FsIFN1Y2Nlc3MsIEVycm9yID0gbG9hZHN0cmluZyhTY3JpcHQsICJTaWdtYVNweS1FZGl0b3IiKQoKCQkJCS0tLy8gU3ludGF4IGNoZWNrCgkJCQlpZiBub3QgU3VjY2VzcyB0aGVuCgkJCQkJc2VsZjpTaG93TW9kYWwoeyJFcnJvciBzYXZpbmcgZmlsZSFcbiIsIEVycm9yfSkKCQkJCQlyZXR1cm4KCQkJCWVuZAoJCQkJCgkJCQktLS8vIFNhdmUgY29udGVudHMKCQkJCXdyaXRlZmlsZShGaWxlUGF0aCwgU2NyaXB0KQoKCQkJCS0tLy8gSW52b2tlIG9uIHNhdmUgZnVuY3Rpb24KCQkJCWlmIE9uU2F2ZUZ1bmMgdGhlbgoJCQkJCU9uU2F2ZUZ1bmMoV2luZG93LCBTY3JpcHQpCgkJCQllbmQKCQkJZW5kCgkJfQoJfQoKCS0tLy8gQ3JlYXRlIEVkaXRvciBXaW5kb3cKCUNvZGVFZGl0b3IsIFdpbmRvdyA9IHNlbGY6TWFrZUVkaXRvclBvcG91dFdpbmRvdyhDb250ZW50LCB7CgkJVGl0bGUgPSBgRWRpdGluZzoge0ZpbGVQYXRofWAsCgkJQnV0dG9ucyA9IEJ1dHRvbnMKCX0pCmVuZAoKdHlwZSBNZW51T3B0aW9ucyA9IHsKCVtzdHJpbmddOiAoR3VpQnV0dG9uLCAuLi5hbnkpIC0+IG5pbAp9CmZ1bmN0aW9uIFVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbjogSW5zdGFuY2UsIFVucGFjazogdGFibGUsIE9wdGlvbnM6IE1lbnVPcHRpb25zKQoJbG9jYWwgV2luZG93ID0gc2VsZi5XaW5kb3cKCWxvY2FsIFBvcHVwID0gV2luZG93OlBvcHVwQ2FudmFzKHsKCQlSZWxhdGl2ZVRvID0gQnV0dG9uLAoJCU1heFNpemVYID0gNTAwLAoJfSkKCgktLS8vIENyZWF0ZSBTZWxlY3RhYmxlcyBmb3Igc3RyaW5nLCBmdW5jdGlvbgoJZm9yIE5hbWUsIEZ1bmMgaW4gT3B0aW9ucyBkbwoJCSBQb3B1cDpTZWxlY3RhYmxlKHsKCQkJVGV4dCA9IE5hbWUsCgkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJRnVuYyhQcm9jZXNzOlVucGFjayhVbnBhY2spKQoJCQllbmQsCgkJfSkKCWVuZAplbmQKCmZ1bmN0aW9uIFVpOlJlbW92ZVByZXZpb3VzVGFiKFRpdGxlOiBzdHJpbmcpOiBib29sZWFuCgktLS8vIE5vIHByZXZpb3VzIHRhYnMKCWlmIG5vdCBBY3RpdmVEYXRhIHRoZW4gCgkJcmV0dXJuIGZhbHNlIAoJZW5kCgoJLS0vLyBUYWJTZWxlY3RvcgoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCgktLS8vIFByZXZpb3VzIGVsZW1lbnRzCglsb2NhbCBQcmV2aW91c1RhYiA9IEFjdGl2ZURhdGEuVGFiCglsb2NhbCBQcmV2aW91c1NlbGVjdGFibGUgPSBBY3RpdmVEYXRhLlNlbGVjdGFibGUKCgktLS8vIFJlbW92ZSBwcmV2aW91cyB0YWIgYW5kIHNldCBzZWxlY3RhYmxlIGZvY3VzCglsb2NhbCBUYWJGb2N1c2VkID0gc2VsZjpTaG91bGRGb2N1cyhQcmV2aW91c1RhYikKCUluZm9TZWxlY3RvcjpSZW1vdmVUYWIoUHJldmlvdXNUYWIpCglQcmV2aW91c1NlbGVjdGFibGU6U2V0U2VsZWN0ZWQoZmFsc2UpCgoJLS0vLyBDcmVhdGUgbmV3IHRhYgoJcmV0dXJuIFRhYkZvY3VzZWQKZW5kCgpmdW5jdGlvbiBVaTpNYWtlVGFibGVIZWFkZXJzKFRhYmxlLCBSb3dzOiB0YWJsZSkKCWxvY2FsIEhlYWRlclJvdyA9IFRhYmxlOkhlYWRlclJvdygpCglmb3IgXywgQ2F0YWdvcnkgaW4gUm93cyBkbwoJCWxvY2FsIENvbHVtbiA9IEhlYWRlclJvdzpOZXh0Q29sdW1uKCkKCQlDb2x1bW46TGFiZWwoe1RleHQ9Q2F0YWdvcnl9KQoJZW5kCmVuZAoKZnVuY3Rpb24gVWk6RGVjb21waWxlKEVkaXRvcjogdGFibGUsIFNjcmlwdDogU2NyaXB0KQoJbG9jYWwgSGVhZGVyID0gIi0tQk9PSUlJSSBUSElTIElTIFNPIFRVRkYgRkxJUFBZIFNLSUJJREkgQVVSQSAoU0lHTUEgU1BZKSIKCUVkaXRvcjpTZXRUZXh0KCItLURlY29tcGlsaW5nLi4uICs5OTk5OTk5IEFVUkEgKG1hbmdvIHBob25rKSIpCgoJLS0vLyBEZWNvbXBpbGUgc2NyaXB0Cglsb2NhbCBEZWNvbXBpbGVkLCBJc0Vycm9yID0gUHJvY2VzczpEZWNvbXBpbGUoU2NyaXB0KQoKCS0tLy8gQWRkIGhlYWRlciBmb3Igc3VjY2Vzc2Z1bCBkZWNvbXBpbGF0aW9ucwoJaWYgbm90IElzRXJyb3IgdGhlbgoJCURlY29tcGlsZWQgPSBge0hlYWRlcn1cbntEZWNvbXBpbGVkfWAKCWVuZAoKCUVkaXRvcjpTZXRUZXh0KERlY29tcGlsZWQpCmVuZAoKdHlwZSBEaXNwbGF5VGFibGVDb25maWcgPSB7CglSb3dzOiB0YWJsZSwKCUZsYWdzOiB0YWJsZT8sCglUb0Rpc3BsYXk6IHRhYmxlLAoJVGFibGU6IHRhYmxlCn0KZnVuY3Rpb24gVWk6RGlzcGxheVRhYmxlKFBhcmVudCwgQ29uZmlnOiBEaXNwbGF5VGFibGVDb25maWcpOiB0YWJsZQoJLS0vLyBDb25maWd1cmF0aW9uCglsb2NhbCBSb3dzID0gQ29uZmlnLlJvd3MKCWxvY2FsIEZsYWdzID0gQ29uZmlnLkZsYWdzCglsb2NhbCBEYXRhVGFibGUgPSBDb25maWcuVGFibGUKCWxvY2FsIFRvRGlzcGxheSA9IENvbmZpZy5Ub0Rpc3BsYXkKCglGbGFncy5NYXhDb2x1bW5zID0gI1Jvd3MKCgktLS8vIENyZWF0ZSB0YWJsZQoJbG9jYWwgVGFibGUgPSBQYXJlbnQ6VGFibGUoRmxhZ3MpCgoJLS0vLyBUYWJsZSBoZWFkZXJzCglzZWxmOk1ha2VUYWJsZUhlYWRlcnMoVGFibGUsIFJvd3MpCgoJLS0vLyBUYWJsZSBsYXlvdXQKCWZvciBSb3dJbmRleCwgTmFtZSBpbiBUb0Rpc3BsYXkgZG8KCQlsb2NhbCBSb3cgPSBUYWJsZTpSb3coKQoJCQoJCS0tLy8gQ3JlYXRlIENvbHVtbnMKCQlmb3IgQ291bnQsIENhdGFnb3J5IGluIFJvd3MgZG8KCQkJbG9jYWwgQ29sdW1uID0gUm93Ok5leHRDb2x1bW4oKQoJCQkKCQkJLS0vLyBWYWx1ZSB0ZXh0CgkJCWxvY2FsIFZhbHVlID0gQ2F0YWdvcnkgPT0gIk5hbWUiIGFuZCBOYW1lIG9yIERhdGFUYWJsZVtOYW1lXQoJCQlpZiBub3QgVmFsdWUgdGhlbiBjb250aW51ZSBlbmQKCgkJCS0tLy8gQ3JlYXRlIGZpbHRlcmVkIGxhYmVsCgkJCWxvY2FsIFN0cmluZyA9IHNlbGY6RmlsdGVyTmFtZShge1ZhbHVlfWAsIDE1MCkKCQkJQ29sdW1uOkxhYmVsKHtUZXh0PVN0cmluZ30pCgkJZW5kCgllbmQKCglyZXR1cm4gVGFibGUKZW5kCgpmdW5jdGlvbiBVaTpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgktLS8vIFVucGFjayByZW1vdGUgZGF0YQoJbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUKCWxvY2FsIE1ldGhvZCA9IERhdGEuTWV0aG9kCglsb2NhbCBJc1JlY2VpdmUgPSBEYXRhLklzUmVjZWl2ZQoJbG9jYWwgU2NyaXB0ID0gRGF0YS5DYWxsaW5nU2NyaXB0Cglsb2NhbCBDbGFzc0RhdGEgPSBEYXRhLkNsYXNzRGF0YQoJbG9jYWwgSGVhZGVyRGF0YSA9IERhdGEuSGVhZGVyRGF0YQoJbG9jYWwgVmFsdWVTd2FwcyA9IERhdGEuVmFsdWVTd2FwcwoJbG9jYWwgQXJncyA9IERhdGEuQXJncwoJbG9jYWwgSWQgPSBEYXRhLklkCgoJLS0vLyBGbGFncwoJbG9jYWwgVGFibGVBcmdzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJUYWJsZUFyZ3MiKQoJbG9jYWwgTm9WYXJpYWJsZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVmFyaWFibGVzIikKCgktLS8vIFVucGFjayBpbmZvCglsb2NhbCBSZW1vdGVEYXRhID0gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkKQoJbG9jYWwgSXNSZW1vdGVGdW5jdGlvbiA9IENsYXNzRGF0YS5Jc1JlbW90ZUZ1bmN0aW9uCglsb2NhbCBSZW1vdGVOYW1lID0gc2VsZjpGaWx0ZXJOYW1lKGB7UmVtb3RlfWAsIDUwKQoKCS0tLy8gVUkgZGF0YQoJbG9jYWwgQ29kZUVkaXRvciA9IHNlbGYuQ29kZUVkaXRvcgoJbG9jYWwgVG9EaXNwbGF5ID0gc2VsZi5EaXNwbGF5UmVtb3RlSW5mbwoJbG9jYWwgSW5mb1NlbGVjdG9yID0gc2VsZi5JbmZvU2VsZWN0b3IKCglsb2NhbCBUYWJGb2N1c2VkID0gc2VsZjpSZW1vdmVQcmV2aW91c1RhYigpCglsb2NhbCBUYWIgPSBJbmZvU2VsZWN0b3I6Q3JlYXRlVGFiKHsKCQlOYW1lID0gc2VsZjpGaWx0ZXJOYW1lKGBSZW1vdGU6IHtSZW1vdGVOYW1lfWAsIDUwKSwKCQlGb2N1c2VkID0gVGFiRm9jdXNlZAoJfSkKCgktLS8vIENyZWF0ZSBuZXcgcGFyc2VyCglsb2NhbCBNb2R1bGUgPSBHZW5lcmF0aW9uOk5ld1BhcnNlcih7CgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcwoJfSkKCWxvY2FsIFBhcnNlciA9IE1vZHVsZS5QYXJzZXIKCWxvY2FsIEZvcm1hdHRlciA9IE1vZHVsZS5Gb3JtYXR0ZXIKCUZvcm1hdHRlcjpTZXRWYWx1ZVN3YXBzKFZhbHVlU3dhcHMpCgoJLS0vLyBTZXQgdGhpcyBsb2cgdG8gYmUgc2VsZWN0ZWQKCUFjdGl2ZURhdGEgPSBEYXRhCglEYXRhLlRhYiA9IFRhYgoJRGF0YS5TZWxlY3RhYmxlOlNldFNlbGVjdGVkKHRydWUpCgoJbG9jYWwgZnVuY3Rpb24gU2V0SURFVGV4dChDb250ZW50OiBzdHJpbmcsIFRhc2s6IHN0cmluZz8pCgkJRGF0YS5UYXNrID0gVGFzayBvciAiU2lnbWEgU3B5IgoJCUNvZGVFZGl0b3I6U2V0VGV4dChDb250ZW50KQoJZW5kCglsb2NhbCBmdW5jdGlvbiBEYXRhQ29ubmVjdGlvbihOYW1lLCAuLi4pCgkJbG9jYWwgQXJncyA9IHsuLi59CgkJcmV0dXJuIGZ1bmN0aW9uKCkKCQkJcmV0dXJuIERhdGFbTmFtZV0oRGF0YSwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZW5kCgllbmQKCWxvY2FsIGZ1bmN0aW9uIFNjcmlwdENoZWNrKFNjcmlwdCwgTm9NaXNzaW5nQ2hlY2s6IGJvb2xlYW4pOiBib29sZWFuPwoJCS0tLy8gUmVqZWN0IGNsaWVudCBldmVudHMKCQlpZiBJc1JlY2VpdmUgdGhlbiAKCQkJVWk6U2hvd01vZGFsKHsKCQkJCSJSZWNpZXZlcyBkbyBub3QgaGF2ZSBhIHNjcmlwdCBiZWNhdXNlIGl0J3MgYSBDb25uZWN0aW9uIgoJCQl9KQoJCQlyZXR1cm4gCgkJZW5kCgoJCS0tLy8gQ2hlY2sgaWYgc2NyaXB0IGV4aXN0cwoJCWlmIG5vdCBTY3JpcHQgYW5kIG5vdCBOb01pc3NpbmdDaGVjayB0aGVuIAoJCQlVaTpTaG93TW9kYWwoeyJUaGUgU2NyaXB0IGhhcyBiZWVuIGRlc3Ryb3llZCBieSB0aGUgZ2FtZSAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgoJCXJldHVybiB0cnVlCgllbmQKCgktLS8vIEZ1bmN0aW9ucwoJZnVuY3Rpb24gRGF0YTpTY3JpcHRPcHRpb25zKEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiQ2FsbGVyIEluZm8iXSA9IERhdGFDb25uZWN0aW9uKCJHZW5lcmF0ZUluZm8iKSwKCQkJWyJEZWNvbXBpbGUiXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiU291cmNlU2NyaXB0IiksCgkJCVsiRGVjb21waWxlIENhbGxpbmciXSA9IERhdGFDb25uZWN0aW9uKCJEZWNvbXBpbGUiLCAiQ2FsbGluZ1NjcmlwdCIpLAoJCQlbIlJlcGVhdCBDYWxsIl0gPSBEYXRhQ29ubmVjdGlvbigiUmVwZWF0Q2FsbCIpLAoJCQlbIlNhdmUgQnl0ZWNvZGUiXSA9IERhdGFDb25uZWN0aW9uKCJTYXZlQnl0ZWNvZGUiKSwKCQl9KQoJZW5kCglmdW5jdGlvbiBEYXRhOkJ1aWxkU2NyaXB0KEJ1dHRvbjogR3VpQnV0dG9uKQoJCVVpOk1ha2VCdXR0b25NZW51KEJ1dHRvbiwge3NlbGZ9LCB7CgkJCVsiQ2FsbCBSZW1vdGUiXSA9IERhdGFDb25uZWN0aW9uKCJNYWtlU2NyaXB0IiwgIlJlbW90ZSIpLAoJCQlbIkJsb2NrIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiQmxvY2siKSwKCQkJWyJSZXBlYXQgRm9yIl0gPSBEYXRhQ29ubmVjdGlvbigiTWFrZVNjcmlwdCIsICJSZXBlYXQiKSwKCQkJWyJTcGFtIFJlbW90ZSJdID0gRGF0YUNvbm5lY3Rpb24oIk1ha2VTY3JpcHQiLCAiU3BhbSIpCgkJfSkKCWVuZAoJZnVuY3Rpb24gRGF0YTpTYXZlQnl0ZWNvZGUoKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhTY3JpcHQsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIGdldHNjcmlwdGJ5dGVjb2RlCiAgICAJbG9jYWwgU3VjY2VzcywgQnl0ZWNvZGUgPSBwY2FsbChnZXRzY3JpcHRieXRlY29kZSwgU2NyaXB0KQoJCWlmIG5vdCBTdWNjZXNzIHRoZW4KCQkJVWk6U2hvd01vZGFsKHsiRmFpbGVkIHRvIGdldCBTY3JpcHRlIGJ5dGVjb2RlICgtOTk5OTk5OSBBVVJBKSJ9KQoJCQlyZXR1cm4KCQllbmQKCgkJLS0vLyBTYXZlIGZpbGUKCQlsb2NhbCBQYXRoQmFzZSA9IGB7U2NyaXB0fSAlcy50eHRgCgkJbG9jYWwgRmlsZVBhdGggPSBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoUGF0aEJhc2UpCgkJd3JpdGVmaWxlKEZpbGVQYXRoLCBCeXRlY29kZSkKCgkJVWk6U2hvd01vZGFsKHsiU2F2ZWQgYnl0ZWNvZGUgdG8iLCBGaWxlUGF0aH0pCgllbmQKCWZ1bmN0aW9uIERhdGE6TWFrZVNjcmlwdChTY3JpcHRUeXBlOiBzdHJpbmcpCgkJbG9jYWwgU2NyaXB0ID0gR2VuZXJhdGlvbjpSZW1vdGVTY3JpcHQoTW9kdWxlLCBzZWxmLCBTY3JpcHRUeXBlKQoJCVNldElERVRleHQoU2NyaXB0LCBgRWRpdGluZzoge1JlbW90ZU5hbWV9Lmx1YWApCgllbmQKCWZ1bmN0aW9uIERhdGE6UmVwZWF0Q2FsbCgpCgkJbG9jYWwgU2lnbmFsID0gSG9vazpJbmRleChSZW1vdGUsIE1ldGhvZCkKCgkJaWYgSXNSZWNlaXZlIHRoZW4KCQkJZmlyZXNpZ25hbChTaWduYWwsIFByb2Nlc3M6VW5wYWNrKEFyZ3MpKQoJCWVsc2UKCQkJU2lnbmFsKFJlbW90ZSwgUHJvY2VzczpVbnBhY2soQXJncykpCgkJZW5kCgllbmQKCWZ1bmN0aW9uIERhdGE6R2V0UmV0dXJuKCkKCQlsb2NhbCBSZXR1cm5WYWx1ZXMgPSBzZWxmLlJldHVyblZhbHVlcwoKCQktLS8vIEVycm9yIG1lc3NhZ2VzCgkJaWYgbm90IElzUmVtb3RlRnVuY3Rpb24gdGhlbgoJCQlVaTpTaG93TW9kYWwoeyJUaGUgUmVtb3RlIGlzIG5vdCBhIFJlbW90ZSBGdW5jdGlvbiAoLTk5OTk5OTkgQVVSQSkifSkKCQkJcmV0dXJuCgkJZW5kCgkJaWYgbm90IFJldHVyblZhbHVlcyB0aGVuCgkJCVVpOlNob3dNb2RhbCh7Ik5vIHJldHVybiB2YWx1ZXMgKC05OTk5OTk5IEFVUkEpIn0pCgkJCXJldHVybgoJCWVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246VGFibGVTY3JpcHQoTW9kdWxlLCBSZXR1cm5WYWx1ZXMpCgkJU2V0SURFVGV4dChTY3JpcHQsIGBSZXR1cm4gVmFsdWVzIGZvcjoge1JlbW90ZU5hbWV9YCkKCWVuZAoJZnVuY3Rpb24gRGF0YTpHZW5lcmF0ZUluZm8oKQoJCS0tLy8gUHJvYmxlbSBjaGVjawoJCWlmIG5vdCBTY3JpcHRDaGVjayhuaWwsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQktLS8vIEdlbmVyYXRlIHNjcmlwdAoJCWxvY2FsIFNjcmlwdCA9IEdlbmVyYXRpb246QWR2YW5jZWRJbmZvKE1vZHVsZSwgc2VsZikKCQlTZXRJREVUZXh0KFNjcmlwdCwgYEFkdmFuY2VkIEluZm8gZm9yOiB7UmVtb3RlTmFtZX1gKQoJZW5kCglmdW5jdGlvbiBEYXRhOkRlY29tcGlsZShXaGljaFNjcmlwdDogc3RyaW5nKQoJCWxvY2FsIERlY29tcGlsZVBvcG91dCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRGVjb21waWxlUG9wb3V0IikKCQlsb2NhbCBUb0RlY29tcGlsZSA9IERhdGFbV2hpY2hTY3JpcHRdCgkJbG9jYWwgRWRpdG9yID0gQ29kZUVkaXRvcgoKCQktLS8vIFByb2JsZW0gY2hlY2sKCQlpZiBub3QgU2NyaXB0Q2hlY2soVG9EZWNvbXBpbGUsIHRydWUpIHRoZW4gcmV0dXJuIGVuZAoKCQlsb2NhbCBUYXNrID0gVWk6RmlsdGVyTmFtZShgVmlld2luZzoge1RvRGVjb21waWxlfS5sdWFgLCAyMDApCgkJCgkJLS0vLyBBdXRvbWF0aWNhbGx5IFBvcC1vdXQgdGhlIGVkaXRvciBmb3IgZGVjb21waWxpbmcgaWYgZW5hYmxlZAoJCWlmIERlY29tcGlsZVBvcG91dCB0aGVuCgkJCUVkaXRvciA9IFVpOk1ha2VFZGl0b3JQb3BvdXRXaW5kb3coIiIsIHsKCQkJCVRpdGxlID0gVGFzawoJCQl9KQoJCWVuZAoKCQlVaTpEZWNvbXBpbGUoRWRpdG9yLCBUb0RlY29tcGlsZSkKCWVuZAoJCgktLS8vIFJlbW90ZU9wdGlvbnMKCXNlbGY6Q3JlYXRlT3B0aW9uc0ZvckRpY3QoVGFiLCBSZW1vdGVEYXRhLCBmdW5jdGlvbigpCgkJUHJvY2VzczpVcGRhdGVSZW1vdGVEYXRhKElkLCBSZW1vdGVEYXRhKQoJZW5kKQoKCS0tLy8gSW5zdGFuY2Ugb3B0aW9ucwoJc2VsZjpDcmVhdGVCdXR0b25zKFRhYiwgewoJCUJhc2UgPSB7CgkJCVNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjApLAoJCQlBdXRvbWF0aWNTaXplID0gRW51bS5BdXRvbWF0aWNTaXplLlksCgkJfSwKCQlCdXR0b25zID0gewoJCQl7CgkJCQlUZXh0ID0gIkNvcHkgc2NyaXB0IHBhdGgiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJU2V0Q2xpcGJvYXJkKFBhcnNlcjpNYWtlUGF0aFN0cmluZyh7CgkJCQkJCU9iamVjdCA9IFNjcmlwdCwKCQkJCQkJTm9WYXJpYWJsZXMgPSB0cnVlCgkJCQkJfSkpCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiQ29weSByZW1vdGUgcGF0aCIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlTZXRDbGlwYm9hcmQoUGFyc2VyOk1ha2VQYXRoU3RyaW5nKHsKCQkJCQkJT2JqZWN0ID0gUmVtb3RlLAoJCQkJCQlOb1ZhcmlhYmxlcyA9IHRydWUKCQkJCQl9KSkKCQkJCWVuZCwKCQkJfSwKCQkJewoJCQkJVGV4dCA9ICJSZW1vdmUgbG9nIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCUluZm9TZWxlY3RvcjpSZW1vdmVUYWIoVGFiKQoJCQkJCURhdGEuU2VsZWN0YWJsZTpSZW1vdmUoKQoJCQkJCUhlYWRlckRhdGE6UmVtb3ZlKCkKCQkJCQlBY3RpdmVEYXRhID0gbmlsCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiRHVtcCBsb2dzIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oKQoJCQkJCWxvY2FsIExvZ3MgPSBIZWFkZXJEYXRhLkVudHJpZXMKCQkJCQlsb2NhbCBGaWxlUGF0aCA9IEdlbmVyYXRpb246RHVtcExvZ3MoTG9ncykKCQkJCQlzZWxmOlNob3dNb2RhbCh7IlNhdmVkIGR1bXAgdG8iLCBGaWxlUGF0aH0pCgkJCQllbmQsCgkJCX0sCgkJCXsKCQkJCVRleHQgPSAiVmlldyBDb25uZWN0aW9ucyIsCgkJCQlDYWxsYmFjayA9IGZ1bmN0aW9uKCkKCQkJCQlsb2NhbCBNZXRob2QgPSBDbGFzc0RhdGEuUmVjZWl2ZVsxXQoJCQkJCWxvY2FsIFNpZ25hbCA9IFJlbW90ZVtNZXRob2RdCgkJCQkJc2VsZjpWaWV3Q29ubmVjdGlvbnMoUmVtb3RlTmFtZSwgU2lnbmFsKQoJCQkJZW5kLAoJCQl9CgkJfQoJfSkKCgktLS8vIFJlbW90ZSBpbmZvcm1hdGlvbiB0YWJsZQoJc2VsZjpEaXNwbGF5VGFibGUoVGFiLCB7CgkJUm93cyA9IHsiTmFtZSIsICJWYWx1ZSJ9LAoJCVRhYmxlID0gRGF0YSwKCQlUb0Rpc3BsYXkgPSBUb0Rpc3BsYXksCgkJRmxhZ3MgPSB7CgkJCUJvcmRlciA9IHRydWUsCgkJCVJvd0JhY2tncm91bmQgPSB0cnVlLAoJCQlNYXhDb2x1bW5zID0gMgoJCX0KCX0pCgkKCS0tLy8gQXJndW1lbnRzIHRhYmxlIHNjcmlwdAoJaWYgVGFibGVBcmdzIHRoZW4KCQlsb2NhbCBQYXJzZWQgPSBHZW5lcmF0aW9uOlRhYmxlU2NyaXB0KE1vZHVsZSwgQXJncykKCQlTZXRJREVUZXh0KFBhcnNlZCwgYEFyZ3VtZW50cyBmb3Ige1JlbW90ZU5hbWV9YCkKCQlyZXR1cm4KCWVuZAoKCS0tLy8gUmVtb3RlIGNhbGwgc2NyaXB0CglEYXRhOk1ha2VTY3JpcHQoIlJlbW90ZSIpCmVuZAoKZnVuY3Rpb24gVWk6Vmlld0Nvbm5lY3Rpb25zKFJlbW90ZU5hbWU6IHN0cmluZywgU2lnbmFsOiBSQlhTY3JpcHRDb25uZWN0aW9uKQoJbG9jYWwgV2luZG93ID0gc2VsZjpDcmVhdGVXaW5kb3coewoJCVRpdGxlID0gYENvbm5lY3Rpb25zIGZvcjoge1JlbW90ZU5hbWV9YCwKCQlTaXplID0gVURpbTIuZnJvbU9mZnNldCg0NTAsIDI1MCkKCX0pCgoJbG9jYWwgVG9EaXNwbGF5ID0gewoJCSJFbmFibGVkIiwKCQkiTHVhQ29ubmVjdGlvbiIsCgkJIlNjcmlwdCIKCX0KCgktLS8vIEdldCBGaWx0ZXJlZCBjb25uZWN0aW9ucwoJbG9jYWwgQ29ubmVjdGlvbnMgPSBQcm9jZXNzOkZpbHRlckNvbm5lY3Rpb25zKFNpZ25hbCwgVG9EaXNwbGF5KQoKCS0tLy8gVGFibGUKCWxvY2FsIFRhYmxlID0gV2luZG93OlRhYmxlKHsKCQlCb3JkZXIgPSB0cnVlLAoJCVJvd0JhY2tncm91bmQgPSB0cnVlLAoJCU1heENvbHVtbnMgPSAzCgl9KQoKCWxvY2FsIEJ1dHRvbnNGb3JWYWx1ZXMgPSB7CgkJWyJTY3JpcHQiXSA9IGZ1bmN0aW9uKFJvdywgVmFsdWUpCgkJCVJvdzpCdXR0b24oewoJCQkJVGV4dCA9ICJEZWNvbXBpbGUiLAoJCQkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCQkJbG9jYWwgVGFzayA9IHNlbGY6RmlsdGVyTmFtZShgVmlld2luZzoge1ZhbHVlfS5sdWFgLCAyMDApCgkJCQkJbG9jYWwgRWRpdG9yID0gc2VsZjpNYWtlRWRpdG9yUG9wb3V0V2luZG93KG5pbCwgewoJCQkJCQlUaXRsZSA9IFRhc2sKCQkJCQl9KQoJCQkJCXNlbGY6RGVjb21waWxlKEVkaXRvciwgVmFsdWUpCgkJCQllbmQKCQkJfSkKCQllbmQsCgkJWyJFbmFibGVkIl0gPSBmdW5jdGlvbihSb3csIEVuYWJsZWQsIENvbm5lY3Rpb24pCgkJCVJvdzpCdXR0b24oewoJCQkJVGV4dCA9IEVuYWJsZWQgYW5kICJEaXNhYmxlIiBvciAiRW5hYmxlIiwKCQkJCUNhbGxiYWNrID0gZnVuY3Rpb24oc2VsZikKCQkJCQlFbmFibGVkID0gbm90IEVuYWJsZWQKCQkJCQlzZWxmLlRleHQgPSBFbmFibGVkIGFuZCAiRGlzYWJsZSIgb3IgIkVuYWJsZSIKCgkJCQkJLS0vLyBFbmFibGUgb3IgZGlzYWJsZSB0aGUgY29ubmVjdGlvbgoJCQkJCWlmIEVuYWJsZWQgdGhlbgoJCQkJCQlDb25uZWN0aW9uOkVuYWJsZSgpCgkJCQkJZWxzZQoJCQkJCQlDb25uZWN0aW9uOkRpc2FibGUoKQoJCQkJCWVuZAoJCQkJZW5kCgkJCX0pCgkJZW5kCgl9CgoJLS0vLyBNYWtlIGhlYWRlcnMgb24gdGhlIHRhYmxlCglzZWxmOk1ha2VUYWJsZUhlYWRlcnMoVGFibGUsIFRvRGlzcGxheSkKCglmb3IgXywgQ29ubmVjdGlvbiBpbiBDb25uZWN0aW9ucyBkbwoJCWxvY2FsIFJvdyA9IFRhYmxlOlJvdygpCgoJCWZvciBfLCBQcm9wZXJ0eSBpbiBUb0Rpc3BsYXkgZG8KCQkJbG9jYWwgQ29sdW1uID0gUm93Ok5leHRDb2x1bW4oKQoJCQlsb2NhbCBDb2x1bW5Sb3cgPSBDb2x1bW46Um93KCkKCgkJCWxvY2FsIFZhbHVlID0gQ29ubmVjdGlvbltQcm9wZXJ0eV0KCQkJbG9jYWwgQ2FsbGJhY2sgPSBCdXR0b25zRm9yVmFsdWVzW1Byb3BlcnR5XQoKCQkJLS0vLyBWYWx1ZSBsYWJlbAoJCQlDb2x1bW5Sb3c6TGFiZWwoe1RleHQ9YHtWYWx1ZX1gfSkKCgkJCS0tLy8gQWRkIGJ1dHRvbnMKCQkJaWYgQ2FsbGJhY2sgdGhlbgoJCQkJQ2FsbGJhY2soQ29sdW1uUm93LCBWYWx1ZSwgQ29ubmVjdGlvbikKCQkJZW5kCgkJZW5kCgllbmQKCgktLS8vIENlbnRlciBXaW5kb3cKCVdpbmRvdzpDZW50ZXIoKQplbmQKCmZ1bmN0aW9uIFVpOkdldFJlbW90ZUhlYWRlcihEYXRhOiBMb2cpCglsb2NhbCBMb2dMaW1pdCA9IHNlbGYuTG9nTGltaXQKCWxvY2FsIExvZ3MgPSBzZWxmLkxvZ3MKCWxvY2FsIFJlbW90ZXNMaXN0ID0gc2VsZi5SZW1vdGVzTGlzdAoKCS0tLy8gUmVtb3RlIGluZm8KCWxvY2FsIElkID0gRGF0YS5JZAoJbG9jYWwgUmVtb3RlID0gRGF0YS5SZW1vdGUKCWxvY2FsIFJlbW90ZU5hbWUgPSBzZWxmOkZpbHRlck5hbWUoYHtSZW1vdGV9YCwgMzApCgoJLS0vLyBOb1RyZWVOb2RlcwoJbG9jYWwgTm9UcmVlTm9kZXMgPSBGbGFnczpHZXRGbGFnVmFsdWUoIk5vVHJlZU5vZGVzIikKCgktLS8vIENoZWNrIGZvciBleGlzdGluZyBUcmVlTm9kZQoJbG9jYWwgRXhpc3RpbmcgPSBMb2dzW0lkXQoJaWYgRXhpc3RpbmcgdGhlbiByZXR1cm4gRXhpc3RpbmcgZW5kCgoJLS0vLyBIZWFkZXIgZGF0YQoJbG9jYWwgSGVhZGVyRGF0YSA9IHsJCgkJTG9nQ291bnQgPSAwLAoJCURhdGEgPSBEYXRhLAoJCUVudHJpZXMgPSB7fQoJfQoKCS0tLy8gSW5jcmVtZW50IHRyZWVub2RlIGNvdW50CglSZW1vdGVzQ291bnQgKz0gMQoKCS0tLy8gQ3JlYXRlIG5ldyB0cmVlbm9kZSBlbGVtZW50CglpZiBub3QgTm9UcmVlTm9kZXMgdGhlbgoJCUhlYWRlckRhdGEuVHJlZU5vZGUgPSBSZW1vdGVzTGlzdDpUcmVlTm9kZSh7CgkJCUxheW91dE9yZGVyID0gLTEgKiBSZW1vdGVzQ291bnQsCgkJCVRpdGxlID0gUmVtb3RlTmFtZQoJCX0pCgllbmQKCglmdW5jdGlvbiBIZWFkZXJEYXRhOkNoZWNrTGltaXQoKQoJCWxvY2FsIEVudHJpZXMgPSBzZWxmLkVudHJpZXMKCQlpZiAjRW50cmllcyA8IExvZ0xpbWl0IHRoZW4gcmV0dXJuIGVuZAoJCQkKCQktLS8vIEdldCBhbmQgcmVtb3ZlIGxhc3QgZWxlbWVudAoJCWxvY2FsIExvZyA9IHRhYmxlLnJlbW92ZShFbnRyaWVzLCAxKQoJCUxvZy5TZWxlY3RhYmxlOlJlbW92ZSgpCgllbmQKCglmdW5jdGlvbiBIZWFkZXJEYXRhOkxvZ0FkZGVkKERhdGEpCgkJLS0vLyBJbmNyZW1lbnQgbG9nIGNvdW50CgkJc2VsZi5Mb2dDb3VudCArPSAxCgkJc2VsZjpDaGVja0xpbWl0KCkKCgkJLS0vLyBBZGQgZW50cnkKCQlsb2NhbCBFbnRyaWVzID0gc2VsZi5FbnRyaWVzCgkJdGFibGUuaW5zZXJ0KEVudHJpZXMsIERhdGEpCgkJCgkJcmV0dXJuIHNlbGYKCWVuZAoKCWZ1bmN0aW9uIEhlYWRlckRhdGE6UmVtb3ZlKCkKCQktLS8vIFJlbW92ZSBUcmVlTm9kZQoJCWxvY2FsIFRyZWVOb2RlID0gc2VsZi5UcmVlTm9kZQoJCWlmIFRyZWVOb2RlIHRoZW4KCQkJVHJlZU5vZGU6UmVtb3ZlKCkKCQllbmQKCgkJLS0vLyBDbGVhciB0YWJsZXMgZnJvbSBtZW1vcnkKCQlMb2dzW0lkXSA9IG5pbAoJCXRhYmxlLmNsZWFyKEhlYWRlckRhdGEpCgllbmQKCglMb2dzW0lkXSA9IEhlYWRlckRhdGEKCXJldHVybiBIZWFkZXJEYXRhCmVuZAoKZnVuY3Rpb24gVWk6Q2xlYXJMb2dzKCkKCWxvY2FsIExvZ3MgPSBzZWxmLkxvZ3MKCWxvY2FsIFJlbW90ZXNMaXN0ID0gc2VsZi5SZW1vdGVzTGlzdAoKCS0tLy8gQ2xlYXIgYWxsIGVsZW1lbnRzCglSZW1vdGVzQ291bnQgPSAwCglSZW1vdGVzTGlzdDpDbGVhckNoaWxkRWxlbWVudHMoKQoKCS0tLy8gQ2xlYXIgbG9ncyBmcm9tIG1lbW9yeQoJdGFibGUuY2xlYXIoTG9ncykKZW5kCgpmdW5jdGlvbiBVaTpRdWV1ZUxvZyhEYXRhKQoJbG9jYWwgTG9nUXVldWUgPSBzZWxmLkxvZ1F1ZXVlCiAgICB0YWJsZS5pbnNlcnQoTG9nUXVldWUsIERhdGEpCmVuZAoKZnVuY3Rpb24gVWk6UHJvY2Vzc0xvZ1F1ZXVlKCkKCWxvY2FsIFF1ZXVlID0gc2VsZi5Mb2dRdWV1ZQogICAgaWYgI1F1ZXVlIDw9IDAgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDcmVhdGUgYSBsb2cgZWxlbWVudCBmb3IgZWFjaCBpbiB0aGUgUXVldWUKICAgIGZvciBJbmRleCwgRGF0YSBpbiBuZXh0LCBRdWV1ZSBkbwogICAgICAgIHNlbGY6Q3JlYXRlTG9nKERhdGEpCiAgICAgICAgdGFibGUucmVtb3ZlKFF1ZXVlLCBJbmRleCkKICAgIGVuZAplbmQKCmZ1bmN0aW9uIFVpOkJlZ2luTG9nU2VydmljZSgpCgljb3JvdXRpbmUud3JhcChmdW5jdGlvbigpCgkJd2hpbGUgdHJ1ZSBkbwoJCQlzZWxmOlByb2Nlc3NMb2dRdWV1ZSgpCgkJCXRhc2sud2FpdCgpCgkJZW5kCgllbmQpKCkKZW5kCgpmdW5jdGlvbiBVaTpGaWx0ZXJOYW1lKE5hbWU6IHN0cmluZywgQ2hhcmFjdGVyTGltaXQ6IG51bWJlcj8pOiBzdHJpbmcKCWxvY2FsIFRyaW1tZWQgPSBOYW1lOnN1YigxLCBDaGFyYWN0ZXJMaW1pdCBvciAyMCkKCWxvY2FsIEZpbHRyZWQgPSBUcmltbWVkOmdzdWIoIltcblxyXSIsICIiKQoJRmlsdHJlZCA9IEdlbmVyYXRpb246TWFrZVByaW50YWJsZShGaWx0cmVkKQoKCXJldHVybiBGaWx0cmVkCmVuZAoKZnVuY3Rpb24gVWk6Q3JlYXRlTG9nKERhdGE6IExvZykKCS0tLy8gVW5wYWNrIGxvZyBkYXRhCiAgICBsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQoJbG9jYWwgTWV0aG9kID0gRGF0YS5NZXRob2QKICAgIGxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MKICAgIGxvY2FsIElzUmVjZWl2ZSA9IERhdGEuSXNSZWNlaXZlCglsb2NhbCBJZCA9IERhdGEuSWQKCWxvY2FsIFRpbWVzdGFtcCA9IERhdGEuVGltZXN0YW1wCglsb2NhbCBJc0V4cGxvaXQgPSBEYXRhLklzRXhwbG9pdAoJCglsb2NhbCBJc05pbFBhcmVudCA9IEhvb2s6SW5kZXgoUmVtb3RlLCAiUGFyZW50IikgPT0gbmlsCglsb2NhbCBSZW1vdGVEYXRhID0gUHJvY2VzczpHZXRSZW1vdGVEYXRhKElkKQoKCS0tLy8gUGF1c2VkCglsb2NhbCBQYXVzZWQgPSBGbGFnczpHZXRGbGFnVmFsdWUoIlBhdXNlZCIpCglpZiBQYXVzZWQgdGhlbiByZXR1cm4gZW5kCgoJLS0vLyBDaGVjayBjYWxsZXIgKElnbm9yZSBleHBsb2l0IGNhbGxzKQoJbG9jYWwgTG9nRXhwbG9pdCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTG9nRXhwbG9pdCIpCglpZiBub3QgTG9nRXhwbG9pdCBhbmQgSXNFeHBsb2l0IHRoZW4gcmV0dXJuIGVuZAoKCS0tLy8gSWdub3JlTmlsCglsb2NhbCBJZ25vcmVOaWwgPSBGbGFnczpHZXRGbGFnVmFsdWUoIklnbm9yZU5pbCIpCglpZiBJZ25vcmVOaWwgYW5kIElzTmlsUGFyZW50IHRoZW4gcmV0dXJuIGVuZAoKICAgIC0tLy8gTG9nUmVjaXZlcyBjaGVjawoJbG9jYWwgTG9nUmVjaXZlcyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiTG9nUmVjaXZlcyIpCglpZiBub3QgTG9nUmVjaXZlcyBhbmQgSXNSZWNlaXZlIHRoZW4gcmV0dXJuIGVuZAoKCWxvY2FsIFNlbGVjdE5ld2VzdCA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiU2VsZWN0TmV3ZXN0IikKCWxvY2FsIE5vVHJlZU5vZGVzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb1RyZWVOb2RlcyIpCgogICAgLS0vLyBFeGNsdWRlZCBjaGVjawogICAgaWYgUmVtb3RlRGF0YS5FeGNsdWRlZCB0aGVuIHJldHVybiBlbmQKCgktLS8vIERlc2VyaWFsaXplIGFyZ3VtZW50cwoJQXJncyA9IENvbW11bmljYXRpb246RGVzZXJpYWxpemVUYWJsZShBcmdzKQoKCS0tLy8gRGVlcCBjbG9uZSBkYXRhCglsb2NhbCBDbG9uZWRBcmdzID0gUHJvY2VzczpEZWVwQ2xvbmVUYWJsZShBcmdzKQoJRGF0YS5BcmdzID0gQ2xvbmVkQXJncwoJRGF0YS5WYWx1ZVN3YXBzID0gR2VuZXJhdGlvbjpNYWtlVmFsdWVTd2Fwc1RhYmxlKFRpbWVzdGFtcCkKCgktLS8vIEdlbmVyYXRlIGxvZyB0aXRsZQoJbG9jYWwgQ29sb3IgPSBDb25maWcuTWV0aG9kQ29sb3JzW01ldGhvZDpsb3dlcigpXQoJbG9jYWwgVGV4dCA9IE5vVHJlZU5vZGVzIGFuZCBge1JlbW90ZX0gfCB7TWV0aG9kfWAgb3IgTWV0aG9kCgoJLS0vLyBGaW5kU3RyaW5nRm9yTmFtZSBjaGVjawoJbG9jYWwgRmluZFN0cmluZyA9IEZsYWdzOkdldEZsYWdWYWx1ZSgiRmluZFN0cmluZ0Zvck5hbWUiKQoJaWYgRmluZFN0cmluZyB0aGVuCgkJZm9yIF8sIEFyZyBpbiBuZXh0LCBDbG9uZWRBcmdzIGRvCgkJCWlmIHR5cGVvZihBcmcpID09ICJzdHJpbmciIHRoZW4KCQkJCWxvY2FsIEZpbHRyZWQgPSBzZWxmOkZpbHRlck5hbWUoQXJnKQoJCQkJVGV4dCA9IGB7RmlsdHJlZH0gfCB7VGV4dH1gCgkJCQlicmVhawoJCQllbmQKCQllbmQKCWVuZAoKCS0tLy8gRmV0Y2ggSGVhZGVyRGF0YSBieSB0aGUgUmVtb3RlSUQgdXNlZCBmb3Igc3RhY2tpbmcKCWxvY2FsIEhlYWRlciA9IHNlbGY6R2V0UmVtb3RlSGVhZGVyKERhdGEpCglsb2NhbCBSZW1vdGVzTGlzdCA9IHNlbGYuUmVtb3Rlc0xpc3QKCglsb2NhbCBMb2dDb3VudCA9IEhlYWRlci5Mb2dDb3VudAoJbG9jYWwgVHJlZU5vZGUgPSBIZWFkZXIuVHJlZU5vZGUgCglsb2NhbCBQYXJlbnQgPSBUcmVlTm9kZSBvciBSZW1vdGVzTGlzdAoKCS0tLy8gSW5jcmVhc2UgbG9nIGNvdW50IC0gVHJlZU5vZGVzIGFyZSBpbiBHZXRSZW1vdGVIZWFkZXIgZnVuY3Rpb24KCWlmIE5vVHJlZU5vZGVzIHRoZW4KCQlSZW1vdGVzQ291bnQgKz0gMQoJCUxvZ0NvdW50ID0gUmVtb3Rlc0NvdW50CgllbmQKCiAgICAtLS8vIENyZWF0ZSBmb2N1cyBidXR0b24KCURhdGEuSGVhZGVyRGF0YSA9IEhlYWRlcgoJRGF0YS5TZWxlY3RhYmxlID0gUGFyZW50OlNlbGVjdGFibGUoewoJCVRleHQgPSBUZXh0LAogICAgICAgIExheW91dE9yZGVyID0gLTEgKiBMb2dDb3VudCwKCQlUZXh0Q29sb3IzID0gQ29sb3IsCgkJVGV4dFhBbGlnbm1lbnQgPSBFbnVtLlRleHRYQWxpZ25tZW50LkxlZnQsCgkJQ2FsbGJhY2sgPSBmdW5jdGlvbigpCgkJCXNlbGY6U2V0Rm9jdXNlZFJlbW90ZShEYXRhKQoJCWVuZCwKICAgIH0pCgoJSGVhZGVyOkxvZ0FkZGVkKERhdGEpCgoJLS0vLyBBdXRvIHNlbGVjdCBjaGVjawoJbG9jYWwgR3JvdXBTZWxlY3RlZCA9IEFjdGl2ZURhdGEgYW5kIEFjdGl2ZURhdGEuSGVhZGVyRGF0YSA9PSBIZWFkZXIKCWlmIFNlbGVjdE5ld2VzdCBhbmQgR3JvdXBTZWxlY3RlZCB0aGVuCgkJc2VsZjpTZXRGb2N1c2VkUmVtb3RlKERhdGEpCgllbmQKZW5kCgpyZXR1cm4gVWk=]]
},Generation={'base64',
[[dHlwZSB0YWJsZSA9IHsNCglbYW55XTogYW55DQp9DQoNCnR5cGUgUmVtb3RlRGF0YSA9IHsNCglSZW1vdGU6IEluc3RhbmNlLA0KCUlzUmVjZWl2ZTogYm9vbGVhbj8sDQoJTWV0YU1ldGhvZDogc3RyaW5nLA0KCUFyZ3M6IHRhYmxlLA0KCU1ldGhvZDogc3RyaW5nLA0KICAgIFRyYW5zZmVyVHlwZTogc3RyaW5nLA0KCVZhbHVlUmVwbGFjZW1lbnRzOiB0YWJsZSwNCglOb1ZhcmlhYmxlczogYm9vbGVhbj8NCn0NCg0KLS0vLyBNb2R1bGUNCmxvY2FsIEdlbmVyYXRpb24gPSB7DQoJRHVtcEJhc2VOYW1lID0gIlNpZ21hU3B5LUR1bXAgJXMubHVhIiwgLS0gIi0tIEdlbmVyYXRlZCB3aXRoIHNpZ21hIHNweSBCT0lJSUlJSUlJSSAoKzk5OTk5OTkgQVVSQSlcbiINCglIZWFkZXIgPSAiLS0gR2VuZXJhdGVkIHdpdGggU2lnbWEgU3B5IEdpdGh1YjogaHR0cHM6Ly9naXRodWIuY29tL2RlcHRoc28vU2lnbWEtU3B5XG4iLA0KCVNjcmlwdFRlbXBsYXRlcyA9IHsNCgkJWyJSZW1vdGUiXSA9IHsNCgkJCXsiJVJlbW90ZUNhbGwlIn0NCgkJfSwNCgkJWyJTcGFtIl0gPSB7DQoJCQl7IndoaWxlIHdhaXQoKSBkbyJ9LA0KCQkJeyIlUmVtb3RlQ2FsbCUiLCAyfSwNCgkJCXsiZW5kIn0NCgkJfSwNCgkJWyJSZXBlYXQiXSA9IHsNCgkJCXsiZm9yIEluZGV4ID0gMSwgMTAgZG8ifSwNCgkJCXsiJVJlbW90ZUNhbGwlIiwgMn0sDQoJCQl7ImVuZCJ9DQoJCX0sDQoJCVsiQmxvY2siXSA9IHsNCgkJCVsiX19pbmRleCJdID0gew0KCQkJCXsibG9jYWwgT2xkOyBPbGQgPSBob29rZnVuY3Rpb24oJVNpZ25hbCUsIGZ1bmN0aW9uKHNlbGYsIC4uLikifSwNCgkJCQl7ImlmIHNlbGYgPT0gJVJlbW90ZSUgdGhlbiIsIDJ9LA0KCQkJCXsicmV0dXJuIiwgM30sDQoJCQkJeyJlbmQiLCAyfSwNCgkJCQl7InJldHVybiBPbGQoc2VsZiwgLi4uKSIsIDJ9LA0KCQkJCXsiZW5kKSJ9DQoJCQl9LA0KCQkJWyJfX25hbWVjYWxsIl0gPSB7DQoJCQkJeyJsb2NhbCBPbGQ7IE9sZCA9IGhvb2ttZXRhbWV0aG9kKGdhbWUsIFwiX19uYW1lY2FsbFwiLCBmdW5jdGlvbihzZWxmLCAuLi4pIn0sDQoJCQkJeyJsb2NhbCBNZXRob2QgPSBnZXRuYW1lY2FsbG1ldGhvZCgpIiwgMn0sDQoJCQkJeyJpZiBzZWxmID09ICVSZW1vdGUlIGFuZCBNZXRob2QgPT0gXCIlTWV0aG9kJVwiIHRoZW4iLCAyfSwNCgkJCQl7InJldHVybiIsIDN9LA0KCQkJCXsiZW5kIiwgMn0sDQoJCQkJeyJyZXR1cm4gT2xkKHNlbGYsIC4uLikiLCAyfSwNCgkJCQl7ImVuZCkifQ0KCQkJfSwNCgkJCVsiQ29ubmVjdCJdID0gew0KCQkJCXsiZm9yIF8sIENvbm5lY3Rpb24gaW4gZ2V0Y29ubmVjdGlvbnMoJVNpZ25hbCUpIGRvIn0sDQoJCQkJeyJDb25uZWN0aW9uOkRpc2FibGUoKSIsIDJ9LA0KCQkJCXsiZW5kIn0NCgkJCX0NCgkJfQ0KCX0NCn0NCg0KLS0vLyBNb2R1bGVzDQpsb2NhbCBDb25maWcNCmxvY2FsIEhvb2sNCmxvY2FsIFBhcnNlck1vZHVsZQ0KbG9jYWwgRmxhZ3MNCmxvY2FsIFRoaXNTY3JpcHQgPSBzY3JpcHQNCg0KbG9jYWwgZnVuY3Rpb24gTWVyZ2UoQmFzZTogdGFibGUsIE5ldzogdGFibGU/KQ0KCWlmIG5vdCBOZXcgdGhlbiByZXR1cm4gZW5kDQoJZm9yIEtleSwgVmFsdWUgaW4gbmV4dCwgTmV3IGRvDQoJCUJhc2VbS2V5XSA9IFZhbHVlDQoJZW5kDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpJbml0KERhdGE6IHRhYmxlKQ0KICAgIGxvY2FsIE1vZHVsZXMgPSBEYXRhLk1vZHVsZXMNCglsb2NhbCBDb25maWd1cmF0aW9uID0gTW9kdWxlcy5Db25maWd1cmF0aW9uDQoNCgktLS8vIE1vZHVsZXMNCglDb25maWcgPSBNb2R1bGVzLkNvbmZpZw0KCUhvb2sgPSBNb2R1bGVzLkhvb2sNCglGbGFncyA9IE1vZHVsZXMuRmxhZ3MNCgkNCgktLS8vIEltcG9ydCBwYXJzZXINCglsb2NhbCBQYXJzZXJVcmwgPSBDb25maWd1cmF0aW9uLlBhcnNlclVybA0KCXNlbGY6TG9hZFBhcnNlcihQYXJzZXJVcmwpDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlUHJpbnRhYmxlKFN0cmluZzogc3RyaW5nKTogc3RyaW5nDQoJbG9jYWwgRm9ybWF0dGVyID0gUGFyc2VyTW9kdWxlLk1vZHVsZXMuRm9ybWF0dGVyDQoJcmV0dXJuIEZvcm1hdHRlcjpNYWtlUHJpbnRhYmxlKFN0cmluZykNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOlRpbWVTdGFtcEZpbGUoRmlsZVBhdGg6IHN0cmluZyk6IHN0cmluZw0KCWxvY2FsIFRpbWVTdGFtcCA9IG9zLmRhdGUoIiVZLSVtLSVkXyVILSVNLSVTIikNCglsb2NhbCBGb3JtYXR0ZWQgPSBGaWxlUGF0aDpmb3JtYXQoVGltZVN0YW1wKQ0KCXJldHVybiBGb3JtYXR0ZWQNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOldyaXRlRHVtcChDb250ZW50OiBzdHJpbmcpOiBzdHJpbmcNCglsb2NhbCBEdW1wQmFzZU5hbWUgPSBzZWxmLkR1bXBCYXNlTmFtZQ0KCWxvY2FsIEZpbGVQYXRoID0gc2VsZjpUaW1lU3RhbXBGaWxlKER1bXBCYXNlTmFtZSkNCg0KCS0tLy8gV3JpdGUgdG8gZmlsZQ0KCXdyaXRlZmlsZShGaWxlUGF0aCwgQ29udGVudCkNCg0KCXJldHVybiBGaWxlUGF0aA0KZW5kDQoNCmZ1bmN0aW9uIEdlbmVyYXRpb246TG9hZFBhcnNlcihNb2R1bGVVcmw6IHN0cmluZykNCglQYXJzZXJNb2R1bGUgPSBsb2Fkc3RyaW5nKGdhbWU6SHR0cEdldChNb2R1bGVVcmwpLCAiUGFyc2VyIikoKQ0KZW5kDQoNCmZ1bmN0aW9uIEdlbmVyYXRpb246TWFrZVZhbHVlU3dhcHNUYWJsZSgpOiB0YWJsZQ0KCWxvY2FsIEZvcm1hdHRlciA9IFBhcnNlck1vZHVsZS5Nb2R1bGVzLkZvcm1hdHRlcg0KCXJldHVybiBGb3JtYXR0ZXI6TWFrZVJlcGxhY2VtZW50cygpDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpTZXRTd2Fwc0NhbGxiYWNrKENhbGxiYWNrOiAoSW50ZXJmYWNlOiB0YWJsZSkgLT4gKCkpDQoJc2VsZi5Td2Fwc0NhbGxiYWNrID0gQ2FsbGJhY2sNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOkdldEJhc2UoTW9kdWxlKTogKHN0cmluZywgYm9vbGVhbikNCglsb2NhbCBOb0NvbW1lbnRzID0gRmxhZ3M6R2V0RmxhZ1ZhbHVlKCJOb0NvbW1lbnRzIikNCglsb2NhbCBIZWFkZXIgPSBzZWxmLkhlYWRlcg0KDQoJbG9jYWwgQ29kZSA9IE5vQ29tbWVudHMgYW5kICIiIG9yIEhlYWRlcg0KDQoJLS0vLyBHZW5lcmF0ZSB2YXJpYWJsZXMgY29kZQ0KCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5QYXJzZXI6TWFrZVZhcmlhYmxlQ29kZSh7DQoJCSJTZXJ2aWNlcyIsICJSZW1vdGUiLCAiVmFyaWFibGVzIg0KCX0sIE5vQ29tbWVudHMpDQoNCglsb2NhbCBOb1ZhcmlhYmxlcyA9IFZhcmlhYmxlcyA9PSAiIg0KCUNvZGUgLi49IFZhcmlhYmxlcw0KDQoJcmV0dXJuIENvZGUsIE5vVmFyaWFibGVzDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpHZXRTd2FwcygpDQoJbG9jYWwgRnVuYyA9IHNlbGYuU3dhcHNDYWxsYmFjaw0KCWxvY2FsIFN3YXBzID0ge30NCg0KCWxvY2FsIEludGVyZmFjZSA9IHt9DQoJZnVuY3Rpb24gSW50ZXJmYWNlOkFkZFN3YXAoT2JqZWN0OiBJbnN0YW5jZSwgRGF0YTogdGFibGUpDQoJCWlmIG5vdCBPYmplY3QgdGhlbiByZXR1cm4gZW5kDQoJCVN3YXBzW09iamVjdF0gPSBEYXRhDQoJZW5kDQoNCgktLS8vIEludm9rZSBHZXRTd2FwcyBmdW5jdGlvbg0KCUZ1bmMoSW50ZXJmYWNlKQ0KDQoJcmV0dXJuIFN3YXBzDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpQaWNrVmFyaWFibGVOYW1lKCk6IHN0cmluZw0KCWxvY2FsIE5hbWVzID0gQ29uZmlnLlZhcmlhYmxlTmFtZXMNCglyZXR1cm4gTmFtZXNbbWF0aC5yYW5kb20oMSwgI05hbWVzKV0NCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOk5ld1BhcnNlcihFeHRyYTogdGFibGU/KQ0KCWxvY2FsIFZhcmlhYmxlTmFtZSA9IHNlbGY6UGlja1ZhcmlhYmxlTmFtZSgpDQoJbG9jYWwgU3dhcHMgPSBzZWxmOkdldFN3YXBzKCkNCg0KCWxvY2FsIENvbmZpZ3VyYXRpb24gPSB7DQoJCVZhcmlhYmxlQmFzZSA9IFZhcmlhYmxlTmFtZSwNCgkJU3dhcHMgPSBTd2FwcywNCgkJSW5kZXhGdW5jID0gZnVuY3Rpb24oLi4uKQ0KCQkJcmV0dXJuIEhvb2s6SW5kZXgoLi4uKQ0KCQllbmQsDQoJfQ0KDQoJLS0vLyBNZXJnZSBleHRyYSBjb25maWd1cmF0aW9uDQoJTWVyZ2UoQ29uZmlndXJhdGlvbiwgRXh0cmEpDQoNCgktLS8vIENyZWF0ZSBuZXcgcGFyc2VyIGluc3RhbmNlDQoJcmV0dXJuIFBhcnNlck1vZHVsZTpOZXcoQ29uZmlndXJhdGlvbikNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOkluZGVudChJbmRlbnRTdHJpbmc6IHN0cmluZywgTGluZTogc3RyaW5nKQ0KCXJldHVybiBge0luZGVudFN0cmluZ317TGluZX1gDQplbmQNCg0KdHlwZSBDYWxsSW5mbyA9IHsNCglBcmd1bWVudHM6IHRhYmxlLA0KCUluZGVudDogbnVtYmVyLA0KCVJlbW90ZVZhcmlhYmxlOiBzdHJpbmcsDQoJTW9kdWxlOiB0YWJsZQ0KfQ0KZnVuY3Rpb24gR2VuZXJhdGlvbjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIEluZm86IENhbGxJbmZvKTogc3RyaW5nDQoJbG9jYWwgSXNSZWNlaXZlID0gRGF0YS5Jc1JlY2VpdmUNCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZA0KCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MNCg0KCWxvY2FsIFJlbW90ZVZhcmlhYmxlID0gSW5mby5SZW1vdGVWYXJpYWJsZQ0KCWxvY2FsIEluZGVudCA9IEluZm8uSW5kZW50IG9yIDANCglsb2NhbCBNb2R1bGUgPSBJbmZvLk1vZHVsZQ0KDQoJbG9jYWwgVmFyaWFibGVzID0gTW9kdWxlLlZhcmlhYmxlcw0KCWxvY2FsIFBhcnNlciA9IE1vZHVsZS5QYXJzZXINCglsb2NhbCBOb1ZhcmlhYmxlcyA9IERhdGEuTm9WYXJpYWJsZXMNCg0KCWxvY2FsIEluZGVudFN0cmluZyA9IHNlbGY6TWFrZUluZGVudChJbmRlbnQpDQoNCgktLS8vIFBhcnNlIGFyZ3VtZW50cw0KCWxvY2FsIFBhcnNlZEFyZ3MsIEl0ZW1zQ291bnQsIElzQXJyYXkgPSBQYXJzZXI6UGFyc2VUYWJsZUludG9TdHJpbmcoew0KCQlOb0JyYWNrZXRzID0gdHJ1ZSwNCgkJTm9WYXJpYWJsZXMgPSBOb1ZhcmlhYmxlcywNCgkJVGFibGUgPSBBcmdzLA0KCQlJbmRlbnQgPSBJbmRlbnQNCgl9KQ0KDQoJLS0vLyBDcmVhdGUgdGFibGUgdmFyaWFibGUgaWYgbm90IGFuIGFycmF5DQoJaWYgbm90IElzQXJyYXkgb3IgTm9WYXJpYWJsZXMgdGhlbg0KCQlQYXJzZWRBcmdzID0gVmFyaWFibGVzOk1ha2VWYXJpYWJsZSh7DQoJCQlWYWx1ZSA9ICgieyVzfSIpOmZvcm1hdChQYXJzZWRBcmdzKSwNCgkJCUNvbW1lbnQgPSBub3QgSXNBcnJheSBhbmQgIkFyZ3VtZW50cyBhcmVuJ3Qgb3JkZXJlZCIgb3IgbmlsLA0KCQkJTmFtZSA9ICJSZW1vdGVBcmdzIiwNCgkJCUNsYXNzID0gIlJlbW90ZSINCgkJfSkNCgllbmQNCg0KCS0tLy8gV3JhcCBpbiBhIHVucGFjayBpZiB0aGUgdGFibGUgaXMgYSBkaWN0DQoJaWYgSXRlbXNDb3VudCA+IDAgYW5kIG5vdCBJc0FycmF5IHRoZW4NCgkJUGFyc2VkQXJncyA9IGB1bnBhY2soe1BhcnNlZEFyZ3N9LCAxLCB0YWJsZS5tYXhuKHtQYXJzZWRBcmdzfSkpYA0KCWVuZA0KDQoJLS0vLyBGaXJlc2lnbmFsIHNjcmlwdCBmb3IgY2xpZW50IHJlY2lldmVzDQoJaWYgSXNSZWNlaXZlIHRoZW4NCgkJbG9jYWwgU2Vjb25kID0gSXRlbXNDb3VudCA8PSAwIGFuZCAiIiBvciBgLCB7UGFyc2VkQXJnc31gDQoJCWxvY2FsIFNpZ25hbCA9IGB7UmVtb3RlVmFyaWFibGV9LntNZXRob2R9YA0KDQoJCWxvY2FsIENvZGUgPSBgLS0gVGhpcyBkYXRhIHdhcyByZWNlaXZlZCBmcm9tIHRoZSBzZXJ2ZXJgDQoJCVBhcnNlZEFyZ3MgPSBzZWxmOkluZGVudChJbmRlbnRTdHJpbmcsIENvZGUpDQoJCUNvZGUgLi49IGBcbntJbmRlbnRTdHJpbmd9ZmlyZXNpZ25hbCh7U2lnbmFsfXtTZWNvbmR9KWANCgkJDQoJCXJldHVybiBDb2RlDQoJZW5kDQoJDQoJLS0vLyBSZW1vdGUgaW52b2tlIHNjcmlwdA0KCXJldHVybiBge1JlbW90ZVZhcmlhYmxlfTp7TWV0aG9kfSh7UGFyc2VkQXJnc30pYA0KZW5kDQoNCi0tLy8gVmFyaWFibGVzOiAlVmFyaWFibGVOYW1lJQ0KZnVuY3Rpb24gR2VuZXJhdGlvbjpBcHBseVZhcmlhYmxlcyhTdHJpbmc6IHN0cmluZywgVmFyaWFibGVzOiB0YWJsZSwgLi4uKTogc3RyaW5nDQoJZm9yIFZhcmlhYmxlLCBWYWx1ZSBpbiBWYXJpYWJsZXMgZG8NCgkJLS0vLyBJbnZva2UgdmFsdWUgZnVuY3Rpb24NCgkJaWYgdHlwZW9mKFZhbHVlKSA9PSAiZnVuY3Rpb24iIHRoZW4NCgkJCVZhbHVlID0gVmFsdWUoLi4uKQ0KCQllbmQNCg0KCQlTdHJpbmcgPSBTdHJpbmc6Z3N1YihgJSV7VmFyaWFibGV9JSVgLCBmdW5jdGlvbigpDQoJCQlyZXR1cm4gVmFsdWUNCgkJZW5kKQ0KCWVuZA0KCXJldHVybiBTdHJpbmcNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VJbmRlbnQoSW5kZW50OiBudW1iZXIpDQoJcmV0dXJuIHN0cmluZy5yZXAoIgkiLCBJbmRlbnQpDQplbmQNCg0KdHlwZSBTY3JpcHREYXRhID0gew0KCVZhcmlhYmxlczogdGFibGUsDQoJTWV0YU1ldGhvZDogc3RyaW5nDQp9DQpmdW5jdGlvbiBHZW5lcmF0aW9uOk1ha2VDYWxsQ29kZShTY3JpcHRUeXBlOiBzdHJpbmcsIERhdGE6IFNjcmlwdERhdGEpOiBzdHJpbmcNCglsb2NhbCBTY3JpcHRUZW1wbGF0ZXMgPSBzZWxmLlNjcmlwdFRlbXBsYXRlcw0KCWxvY2FsIFRlbXBsYXRlID0gU2NyaXB0VGVtcGxhdGVzW1NjcmlwdFR5cGVdDQoNCglhc3NlcnQoVGVtcGxhdGUsIGB7U2NyaXB0VHlwZX0gaXMgbm90IGEgdmFsaWQgc2NyaXB0IHR5cGUhYCkNCg0KCWxvY2FsIFZhcmlhYmxlcyA9IERhdGEuVmFyaWFibGVzDQoJbG9jYWwgTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZA0KCWxvY2FsIE1ldGFNZXRob2RzID0geyJfX2luZGV4IiwgIl9fbmFtZWNhbGwiLCAiQ29ubmVjdCJ9DQoNCglsb2NhbCBmdW5jdGlvbiBDb21waWxlKFRlbXBsYXRlOiB0YWJsZSk6IHN0cmluZw0KCQlsb2NhbCBPdXQgPSAiIg0KDQoJCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRlbXBsYXRlIGRvDQoJCQktLS8vIE1ldGFNZXRob2QgY2hlY2sNCgkJCWxvY2FsIElzTWV0YVR5cGVPbmx5ID0gdGFibGUuZmluZChNZXRhTWV0aG9kcywgS2V5KQ0KCQkJaWYgSXNNZXRhVHlwZU9ubHkgdGhlbg0KCQkJCWlmIEtleSA9PSBNZXRhTWV0aG9kIHRoZW4NCgkJCQkJbG9jYWwgTGluZSA9IENvbXBpbGUoVmFsdWUpDQoJCQkJCU91dCAuLj0gTGluZQ0KCQkJCWVuZA0KCQkJCWNvbnRpbnVlDQoJCQllbmQNCg0KCQkJLS0vLyBJbmZvcm1hdGlvbg0KCQkJbG9jYWwgQ29udGVudCwgSW5kZW50ID0gVmFsdWVbMV0sIFZhbHVlWzJdIG9yIDANCgkJCUluZGVudCA9IG1hdGguY2xhbXAoSW5kZW50LTEsIDAsIDk5OTkpDQoNCgkJCS0tLy8gTWFrZSBsaW5lDQoJCQlsb2NhbCBMaW5lID0gc2VsZjpBcHBseVZhcmlhYmxlcyhDb250ZW50LCBWYXJpYWJsZXMsIEluZGVudCkNCgkJCWxvY2FsIEluZGVudFN0cmluZyA9IHNlbGY6TWFrZUluZGVudChJbmRlbnQpDQoNCgkJCS0tLy8gQXBwZW5kIHRvIGNvZGUNCgkJCU91dCAuLj0gYHtJbmRlbnRTdHJpbmd9e0xpbmV9XG5gDQoJCWVuZA0KDQoJCXJldHVybiBPdXQNCgllbmQNCgkNCglyZXR1cm4gQ29tcGlsZShUZW1wbGF0ZSkNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOlJlbW90ZVNjcmlwdChNb2R1bGUsIERhdGE6IFJlbW90ZURhdGEsIFNjcmlwdFR5cGU6IHN0cmluZyk6IHN0cmluZw0KCS0tLy8gVW5wYWNrIGRhdGENCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQ0KCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MNCglsb2NhbCBNZXRob2QgPSBEYXRhLk1ldGhvZA0KCWxvY2FsIE1ldGFNZXRob2QgPSBEYXRhLk1ldGFNZXRob2QNCg0KCS0tLy8gUmVtb3RlIGluZm8NCglsb2NhbCBDbGFzc05hbWUgPSBIb29rOkluZGV4KFJlbW90ZSwgIkNsYXNzTmFtZSIpDQoJbG9jYWwgSXNOaWxQYXJlbnQgPSBIb29rOkluZGV4KFJlbW90ZSwgIlBhcmVudCIpID09IG5pbA0KCQ0KCWxvY2FsIFZhcmlhYmxlcyA9IE1vZHVsZS5WYXJpYWJsZXMNCglsb2NhbCBGb3JtYXR0ZXIgPSBNb2R1bGUuRm9ybWF0dGVyDQoJDQoJLS0vLyBQcmUtcmVuZGVyIHZhcmlhYmxlcw0KCVZhcmlhYmxlczpQcmVyZW5kZXJWYXJpYWJsZXMoQXJncywgeyJJbnN0YW5jZSJ9KQ0KDQoJLS0vLyBDcmVhdGUgcmVtb3RlIHZhcmlhYmxlDQoJbG9jYWwgUmVtb3RlVmFyaWFibGUgPSBWYXJpYWJsZXM6TWFrZVZhcmlhYmxlKHsNCgkJVmFsdWUgPSBGb3JtYXR0ZXI6Rm9ybWF0KFJlbW90ZSwgew0KCQkJTm9WYXJpYWJsZXMgPSB0cnVlDQoJCX0pLA0KCQlDb21tZW50ID0gYHtDbGFzc05hbWV9IHtJc05pbFBhcmVudCBhbmQgInwgUmVtb3RlIHBhcmVudCBpcyBuaWwiIG9yICIifWAsDQoJCU5hbWUgPSBGb3JtYXR0ZXI6TWFrZU5hbWUoUmVtb3RlKSwNCgkJTG9va3VwID0gUmVtb3RlLA0KCQlDbGFzcyA9ICJSZW1vdGUiDQoJfSkNCg0KCS0tLy8gR2VuZXJhdGUgY2FsbCBzY3JpcHQNCglsb2NhbCBDYWxsQ29kZSA9IHNlbGY6TWFrZUNhbGxDb2RlKFNjcmlwdFR5cGUsIHsNCgkJVmFyaWFibGVzID0gew0KCQkJWyJSZW1vdGVDYWxsIl0gPSBmdW5jdGlvbihJbmRlbnQ6IG51bWJlcikNCgkJCQlyZXR1cm4gc2VsZjpDYWxsUmVtb3RlU2NyaXB0KERhdGEsIHsNCgkJCQkJUmVtb3RlVmFyaWFibGUgPSBSZW1vdGVWYXJpYWJsZSwNCgkJCQkJSW5kZW50ID0gSW5kZW50LA0KCQkJCQlNb2R1bGUgPSBNb2R1bGUNCgkJCQl9KQ0KCQkJZW5kLA0KCQkJWyJSZW1vdGUiXSA9IFJlbW90ZVZhcmlhYmxlLA0KCQkJWyJNZXRob2QiXSA9IE1ldGhvZCwNCgkJCVsiU2lnbmFsIl0gPSBge1JlbW90ZVZhcmlhYmxlfS57TWV0aG9kfWANCgkJfSwNCgkJTWV0YU1ldGhvZCA9IE1ldGFNZXRob2QNCgl9KQ0KCQ0KCS0tLy8gTWFrZSBjb2RlDQoJbG9jYWwgQ29kZSA9IHNlbGY6R2V0QmFzZShNb2R1bGUpDQoJcmV0dXJuIGB7Q29kZX1cbntDYWxsQ29kZX1gDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpDb25uZWN0aW9uc1RhYmxlKFNpZ25hbDogUkJYU2NyaXB0U2lnbmFsKTogdGFibGUNCglsb2NhbCBDb25uZWN0aW9ucyA9IGdldGNvbm5lY3Rpb25zKFNpZ25hbCkNCglsb2NhbCBEYXRhQXJyYXkgPSB7fQ0KDQoJZm9yIF8sIENvbm5lY3Rpb24gaW4gbmV4dCwgQ29ubmVjdGlvbnMgZG8NCgkJbG9jYWwgRnVuY3Rpb24gPSBDb25uZWN0aW9uLkZ1bmN0aW9uDQoJCWxvY2FsIFNjcmlwdCA9IHJhd2dldChnZXRmZW52KEZ1bmN0aW9uKSwgInNjcmlwdCIpDQoNCgkJLS0vLyBTa2lwIGlmIHNlbGYNCgkJaWYgU2NyaXB0ID09IFRoaXNTY3JpcHQgdGhlbiBjb250aW51ZSBlbmQNCg0KCQktLS8vIENvbm5lY3Rpb24gZGF0YQ0KCQlsb2NhbCBEYXRhID0gew0KCQkJRnVuY3Rpb24gPSBGdW5jdGlvbiwNCgkJCVN0YXRlID0gQ29ubmVjdGlvbi5TdGF0ZSwNCgkJCVNjcmlwdCA9IFNjcmlwdA0KCQl9DQoNCgkJdGFibGUuaW5zZXJ0KERhdGFBcnJheSwgRGF0YSkNCgllbmQNCg0KCXJldHVybiBEYXRhQXJyYXkNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOlRhYmxlU2NyaXB0KE1vZHVsZSwgVGFibGU6IHRhYmxlKTogc3RyaW5nDQoJLS0vLyBQcmUtcmVuZGVyIHZhcmlhYmxlcw0KCU1vZHVsZS5WYXJpYWJsZXM6UHJlcmVuZGVyVmFyaWFibGVzKFRhYmxlLCB7Ikluc3RhbmNlIn0pDQoNCgktLS8vIFBhcnNlIGFyZ3VtZW50cw0KCWxvY2FsIFBhcnNlZFRhYmxlID0gTW9kdWxlLlBhcnNlcjpQYXJzZVRhYmxlSW50b1N0cmluZyh7DQoJCVRhYmxlID0gVGFibGUNCgl9KQ0KDQoJLS0vLyBHZW5lcmF0ZSBzY3JpcHQNCglsb2NhbCBDb2RlLCBOb1ZhcmlhYmxlcyA9IHNlbGY6R2V0QmFzZShNb2R1bGUpDQoJbG9jYWwgU2VwZXJhdG9yID0gTm9WYXJpYWJsZXMgYW5kICIiIG9yICJcbiINCglDb2RlIC4uPSBge1NlcGVyYXRvcn1yZXR1cm4ge1BhcnNlZFRhYmxlfWANCg0KCXJldHVybiBDb2RlDQplbmQNCg0KZnVuY3Rpb24gR2VuZXJhdGlvbjpNYWtlVHlwZXNUYWJsZShUYWJsZTogdGFibGUpOiB0YWJsZQ0KCWxvY2FsIFR5cGVzID0ge30NCg0KCWZvciBLZXksIFZhbHVlIGluIG5leHQsIFRhYmxlIGRvDQoJCWxvY2FsIFR5cGUgPSB0eXBlb2YoVmFsdWUpDQoJCWlmIFR5cGUgPT0gInRhYmxlIiB0aGVuDQoJCQlUeXBlID0gc2VsZjpNYWtlVHlwZXNUYWJsZShWYWx1ZSkNCgkJZW5kDQoNCgkJVHlwZXNbS2V5XSA9IFR5cGUNCgllbmQNCg0KCXJldHVybiBUeXBlcw0KZW5kDQoNCmZ1bmN0aW9uIEdlbmVyYXRpb246Q29ubmVjdGlvbkluZm8oUmVtb3RlOiBJbnN0YW5jZSwgQ2xhc3NEYXRhOiB0YWJsZSk6IHRhYmxlPw0KCWxvY2FsIFJlY2VpdmVNZXRob2RzID0gQ2xhc3NEYXRhLlJlY2VpdmUNCglpZiBub3QgUmVjZWl2ZU1ldGhvZHMgdGhlbiByZXR1cm4gZW5kDQoNCglsb2NhbCBDb25uZWN0aW9ucyA9IHt9DQoJZm9yIF8sIE1ldGhvZDogc3RyaW5nIGluIG5leHQsIFJlY2VpdmVNZXRob2RzIGRvDQoJCXBjYWxsKGZ1bmN0aW9uKCkgLS0gVE9ETzogR0VUQ0FMTEJBQ0tWQUxVRQ0KCQkJbG9jYWwgU2lnbmFsID0gSG9vazpJbmRleChSZW1vdGUsIE1ldGhvZCkNCgkJCUNvbm5lY3Rpb25zW01ldGhvZF0gPSBzZWxmOkNvbm5lY3Rpb25zVGFibGUoU2lnbmFsKQ0KCQllbmQpDQoJZW5kDQoNCglyZXR1cm4gQ29ubmVjdGlvbnMNCmVuZA0KDQpmdW5jdGlvbiBHZW5lcmF0aW9uOkFkdmFuY2VkSW5mbyhNb2R1bGUsIERhdGE6IHRhYmxlKTogc3RyaW5nDQoJLS0vLyBVbnBhY2sgcmVtb3RlIGRhdGENCglsb2NhbCBGdW5jdGlvbiA9IERhdGEuQ2FsbGluZ0Z1bmN0aW9uDQoJbG9jYWwgQ2xhc3NEYXRhID0gRGF0YS5DbGFzc0RhdGENCglsb2NhbCBSZW1vdGUgPSBEYXRhLlJlbW90ZQ0KCWxvY2FsIEFyZ3MgPSBEYXRhLkFyZ3MNCgkNCgktLS8vIEFkdmFuY2VkIGluZm8gdGFibGUgYmFzZQ0KCWxvY2FsIEZ1bmN0aW9uSW5mbyA9IHsNCgkJWyJDYWxsZXIiXSA9IHsNCgkJCVsiU291cmNlU2NyaXB0Il0gPSBEYXRhLlNvdXJjZVNjcmlwdCwNCgkJCVsiQ2FsbGluZ1NjcmlwdCJdID0gRGF0YS5DYWxsaW5nU2NyaXB0LA0KCQkJWyJDYWxsaW5nRnVuY3Rpb24iXSA9IEZ1bmN0aW9uDQoJCX0sDQoJCVsiUmVtb3RlIl0gPSB7DQoJCQlbIlJlbW90ZSJdID0gUmVtb3RlLA0KCQkJWyJSZW1vdGVJRCJdID0gRGF0YS5JZCwNCgkJCVsiTWV0aG9kIl0gPSBEYXRhLk1ldGhvZCwNCgkJCVsiQ29ubmVjdGlvbnMiXSA9IHNlbGY6Q29ubmVjdGlvbkluZm8oUmVtb3RlLCBDbGFzc0RhdGEpDQoJCX0sDQoJCVsiQXJndW1lbnRzIl0gPSB7DQoJCQlbIkxlbmd0aCJdID0gI0FyZ3MsDQoJCQlbIlR5cGVzIl0gPSBzZWxmOk1ha2VUeXBlc1RhYmxlKEFyZ3MpLA0KCQl9LA0KCQlbIk1ldGFNZXRob2QiXSA9IERhdGEuTWV0YU1ldGhvZCwNCgkJWyJJc0FjdG9yIl0gPSBEYXRhLklzQWN0b3IsDQoJfQ0KDQoJLS0vLyBTb21lIGNsb3N1cmVzIG1heSBub3QgYmUgbHVhDQoJaWYgRnVuY3Rpb24gYW5kIGlzbGNsb3N1cmUoRnVuY3Rpb24pIHRoZW4NCgkJRnVuY3Rpb25JbmZvWyJVcFZhbHVlcyJdID0gZGVidWcuZ2V0dXB2YWx1ZXMoRnVuY3Rpb24pDQoJCUZ1bmN0aW9uSW5mb1siQ29uc3RhbnRzIl0gPSBkZWJ1Zy5nZXRjb25zdGFudHMoRnVuY3Rpb24pDQoJZW5kDQoNCgktLS8vIEdlbmVyYXRlIHNjcmlwdA0KCXJldHVybiBzZWxmOlRhYmxlU2NyaXB0KE1vZHVsZSwgRnVuY3Rpb25JbmZvKQ0KZW5kDQoNCmZ1bmN0aW9uIEdlbmVyYXRpb246RHVtcExvZ3MoTG9nczogdGFibGUpOiBzdHJpbmcNCglsb2NhbCBCYXNlRGF0YQ0KCWxvY2FsIFBhcnNlZCA9IHsNCgkJUmVtb3RlID0gbmlsLA0KCQlDYWxscyA9IHt9DQoJfQ0KDQoJLS0vLyBDcmVhdGUgbmV3IHBhcnNlciBpbnN0YW5jZQ0KCWxvY2FsIE1vZHVsZSA9IEdlbmVyYXRpb246TmV3UGFyc2VyKCkNCg0KCWZvciBfLCBEYXRhIGluIExvZ3MgZG8NCgkJbG9jYWwgQ2FsbHMgPSBQYXJzZWQuQ2FsbHMNCgkJbG9jYWwgVGFibGUgPSB7DQoJCQlBcmdzID0gRGF0YS5BcmdzLA0KCQkJVGltZXN0YW1wID0gRGF0YS5UaW1lc3RhbXAsDQoJCQlSZXR1cm5WYWx1ZXMgPSBEYXRhLlJldHVyblZhbHVlcywNCgkJCU1ldGhvZCA9IERhdGEuTWV0aG9kLA0KCQkJTWV0YU1ldGhvZCA9IERhdGEuTWV0YU1ldGhvZCwNCgkJCUNhbGxpbmdTY3JpcHQgPSBEYXRhLkNhbGxpbmdTY3JpcHQsDQoJCX0NCg0KCQktLS8vIEFwcGVuZA0KCQl0YWJsZS5pbnNlcnQoQ2FsbHMsIFRhYmxlKQ0KDQoJCS0tLy8gU2V0IEJhc2VEYXRhDQoJCWlmIG5vdCBCYXNlRGF0YSB0aGVuDQoJCQlCYXNlRGF0YSA9IERhdGENCgkJZW5kDQoJZW5kDQoNCgktLS8vIEJhc2VkYXRhIG1lcmdlDQoJUGFyc2VkLlJlbW90ZSA9IEJhc2VEYXRhLlJlbW90ZQ0KDQoJLS0vLyBDb21waWxlIGFuZCBzYXZlDQoJbG9jYWwgT3V0cHV0ID0gc2VsZjpUYWJsZVNjcmlwdChNb2R1bGUsIFBhcnNlZCkNCglsb2NhbCBGaWxlUGF0aCA9IHNlbGY6V3JpdGVEdW1wKE91dHB1dCkNCgkNCglyZXR1cm4gRmlsZVBhdGgNCmVuZA0KDQpyZXR1cm4gR2VuZXJhdGlvbg0K]]
},Communication={'base64',
[[dHlwZSB0YWJsZSA9IHsNCiAgICBbYW55XTogYW55DQp9DQoNCi0tLy8gTW9kdWxlDQpsb2NhbCBNb2R1bGUgPSB7DQogICAgQ29tbUNhbGxiYWNrcyA9IHt9DQp9DQoNCmxvY2FsIENvbW1XcmFwcGVyID0ge30NCkNvbW1XcmFwcGVyLl9faW5kZXggPSBDb21tV3JhcHBlcg0KDQotLS8vIFNlcnZpY2VzDQpsb2NhbCBDb3JlR3VpDQoNCi0tLy8gTW9kdWxlcw0KbG9jYWwgSG9vaw0KbG9jYWwgQ2hhbm5lbA0KbG9jYWwgQ29uZmlnDQpsb2NhbCBQcm9jZXNzDQoNCmZ1bmN0aW9uIE1vZHVsZTpJbml0KERhdGEpDQogICAgbG9jYWwgTW9kdWxlcyA9IERhdGEuTW9kdWxlcw0KICAgIGxvY2FsIFNlcnZpY2VzID0gRGF0YS5TZXJ2aWNlcw0KDQogICAgSG9vayA9IE1vZHVsZXMuSG9vaw0KICAgIFByb2Nlc3MgPSBNb2R1bGVzLlByb2Nlc3MNCiAgICBDb25maWcgPSBNb2R1bGVzLkNvbmZpZyBvciBDb25maWcNCiAgICBDb3JlR3VpID0gU2VydmljZXMuQ29yZUd1aQ0KZW5kDQoNCmZ1bmN0aW9uIENvbW1XcmFwcGVyOkZpcmUoLi4uKQ0KICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQ0KICAgIHRhYmxlLmluc2VydChRdWV1ZSwgey4uLn0pDQplbmQNCg0KZnVuY3Rpb24gQ29tbVdyYXBwZXI6UHJvY2Vzc0FyZ3VtZW50cyhBcmd1bWVudHMpIA0KICAgIGxvY2FsIENoYW5uZWwgPSBzZWxmLkNoYW5uZWwNCiAgICBDaGFubmVsOkZpcmUoUHJvY2VzczpVbnBhY2soQXJndW1lbnRzKSkNCmVuZA0KDQpmdW5jdGlvbiBDb21tV3JhcHBlcjpQcm9jZXNzUXVldWUoKQ0KICAgIGxvY2FsIFF1ZXVlID0gc2VsZi5RdWV1ZQ0KDQogICAgZm9yIEluZGV4ID0gMSwgI1F1ZXVlIGRvDQogICAgICAgIGxvY2FsIEFyZ3VtZW50cyA9IHRhYmxlLnJlbW92ZShRdWV1ZSkNCiAgICAgICAgcGNhbGwoZnVuY3Rpb24oKQ0KICAgICAgICAgICAgc2VsZjpQcm9jZXNzQXJndW1lbnRzKEFyZ3VtZW50cykgDQogICAgICAgIGVuZCkNCiAgICBlbmQNCmVuZA0KDQpmdW5jdGlvbiBDb21tV3JhcHBlcjpCZWdpblF1ZXVlU2VydmljZSgpDQogICAgY29yb3V0aW5lLndyYXAoZnVuY3Rpb24oKQ0KICAgICAgICB3aGlsZSB3YWl0KCkgZG8NCiAgICAgICAgICAgIHNlbGY6UHJvY2Vzc1F1ZXVlKCkNCiAgICAgICAgZW5kDQogICAgZW5kKSgpDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk5ld0NvbW1XcmFwKENoYW5uZWw6IEJpbmRhYmxlRXZlbnQpDQogICAgbG9jYWwgQmFzZSA9IHsNCiAgICAgICAgUXVldWUgPSBzZXRtZXRhdGFibGUoe30sIHtfX21vZGUgPSAidiJ9KSwNCiAgICAgICAgQ2hhbm5lbCA9IENoYW5uZWwsDQogICAgICAgIEV2ZW50ID0gQ2hhbm5lbC5FdmVudA0KICAgIH0NCg0KICAgIC0tLy8gQ3JlYXRlIG5ldyB3cmFwcGVyIGNsYXNzDQogICAgbG9jYWwgV3JhcHBlZCA9IHNldG1ldGF0YWJsZShCYXNlLCBDb21tV3JhcHBlcikNCiAgICBXcmFwcGVkOkJlZ2luUXVldWVTZXJ2aWNlKCkNCg0KICAgIHJldHVybiBXcmFwcGVkDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk1ha2VEZWJ1Z0lkSGFuZGxlcigpOiBCaW5kYWJsZUZ1bmN0aW9uDQogICAgLS0vLyBVc2luZyBCaW5kYWJsZUZ1bmN0aW9uIGFzIGl0IGRvZXMgbm90IHJlcXVpcmUgYSB0aHJlYWQgcGVybWlzc2lvbiBjaGFuZ2UNCiAgICBsb2NhbCBSZW1vdGUgPSBJbnN0YW5jZS5uZXcoIkJpbmRhYmxlRnVuY3Rpb24iKQ0KICAgIGZ1bmN0aW9uIFJlbW90ZS5Pbkludm9rZShPYmplY3Q6IEluc3RhbmNlKTogc3RyaW5nDQogICAgICAgIHJldHVybiBPYmplY3Q6R2V0RGVidWdJZCgpDQogICAgZW5kDQoNCiAgICBzZWxmLkRlYnVnSWRSZW1vdGUgPSBSZW1vdGUNCiAgICBzZWxmLkRlYnVnSWRJbnZva2UgPSBSZW1vdGUuSW52b2tlDQoNCiAgICByZXR1cm4gUmVtb3RlDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldERlYnVnSWQoT2JqZWN0OiBJbnN0YW5jZSk6IHN0cmluZw0KICAgIGxvY2FsIEludm9rZSA9IHNlbGYuRGVidWdJZEludm9rZQ0KICAgIGxvY2FsIFJlbW90ZSA9IHNlbGYuRGVidWdJZFJlbW90ZQ0KCXJldHVybiBJbnZva2UoUmVtb3RlLCBPYmplY3QpDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkdldEhpZGRlblBhcmVudCgpOiBJbnN0YW5jZQ0KICAgIC0tLy8gVXNlIGdldGh1aSBpZiBpdCBleGlzdHMNCiAgICBpZiBnZXRodWkgdGhlbiByZXR1cm4gZ2V0aHVpKCkgZW5kDQogICAgcmV0dXJuIENvcmVHdWkNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6Q3JlYXRlQ29tbUNoYW5uZWwoKTogKG51bWJlciwgQmluZGFibGVFdmVudCkNCiAgICAtLS8vIFVzZSBuYXRpdmUgaWYgaXQgZXhpc3RzDQogICAgbG9jYWwgRm9yY2UgPSBDb25maWcuRm9yY2VVc2VDdXN0b21Db21tDQogICAgaWYgY3JlYXRlX2NvbW1fY2hhbm5lbCBhbmQgbm90IEZvcmNlIHRoZW4NCiAgICAgICAgcmV0dXJuIGNyZWF0ZV9jb21tX2NoYW5uZWwoKQ0KICAgIGVuZA0KDQogICAgbG9jYWwgUGFyZW50ID0gc2VsZjpHZXRIaWRkZW5QYXJlbnQoKQ0KICAgIGxvY2FsIENoYW5uZWxJZCA9IG1hdGgucmFuZG9tKDEsIDEwMDAwMDAwKQ0KDQogICAgLS0vLyBCaW5kYWJsZUV2ZW50DQogICAgbG9jYWwgQ2hhbm5lbCA9IEluc3RhbmNlLm5ldygiQmluZGFibGVFdmVudCIsIFBhcmVudCkNCiAgICBDaGFubmVsLk5hbWUgPSBDaGFubmVsSWQNCg0KICAgIHJldHVybiBDaGFubmVsSWQsIENoYW5uZWwNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6R2V0Q29tbUNoYW5uZWwoQ2hhbm5lbElkOiBudW1iZXIpOiBCaW5kYWJsZUV2ZW50Pw0KICAgIC0tLy8gVXNlIG5hdGl2ZSBpZiBpdCBleGlzdHMNCiAgICBsb2NhbCBGb3JjZSA9IENvbmZpZy5Gb3JjZVVzZUN1c3RvbUNvbW0NCiAgICBpZiBnZXRfY29tbV9jaGFubmVsIGFuZCBub3QgRm9yY2UgdGhlbg0KICAgICAgICBsb2NhbCBDaGFubmVsID0gZ2V0X2NvbW1fY2hhbm5lbChDaGFubmVsSWQpDQogICAgICAgIHJldHVybiBDaGFubmVsLCBmYWxzZQ0KICAgIGVuZA0KDQogICAgbG9jYWwgUGFyZW50ID0gc2VsZjpHZXRIaWRkZW5QYXJlbnQoKQ0KICAgIGxvY2FsIENoYW5uZWwgPSBQYXJlbnQ6RmluZEZpcnN0Q2hpbGQoQ2hhbm5lbElkKQ0KDQogICAgLS0vLyBXcmFwIHRoZSBjaGFubmVsIChQcmV2ZW50cyB0aHJlYWQgcGVybWlzc2lvbiBlcnJvcnMpDQogICAgbG9jYWwgV3JhcHBlZCA9IHNlbGY6TmV3Q29tbVdyYXAoQ2hhbm5lbCkNCiAgICByZXR1cm4gV3JhcHBlZCwgdHJ1ZQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpDaGVja1ZhbHVlKFZhbHVlLCBJbmJvdW5kOiBib29sZWFuPykNCiAgICAgLS0vLyBObyBzZXJpYWxpemluZyAgbmVlZGVkDQogICAgaWYgdHlwZW9mKFZhbHVlKSB+PSAidGFibGUiIHRoZW4gDQogICAgICAgIHJldHVybiBWYWx1ZSANCiAgICBlbmQNCiAgIA0KICAgIC0tLy8gRGVzZXJpYWxpemUNCiAgICBpZiBJbmJvdW5kIHRoZW4NCiAgICAgICAgcmV0dXJuIHNlbGY6RGVzZXJpYWxpemVUYWJsZShWYWx1ZSkNCiAgICBlbmQNCg0KICAgIC0tLy8gU2VyaWFsaXplDQogICAgcmV0dXJuIHNlbGY6U2VyaWFsaXplVGFibGUoVmFsdWUpDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOk1ha2VQYWNrZXQoSW5kZXgsIFZhbHVlKTogdGFibGUNCiAgICByZXR1cm4gew0KICAgICAgICBJbmRleCA9IHNlbGY6Q2hlY2tWYWx1ZShJbmRleCksIA0KICAgICAgICBWYWx1ZSA9IHNlbGY6Q2hlY2tWYWx1ZShWYWx1ZSkNCiAgICB9DQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOlJlYWRQYWNrZXQoUGFja2V0OiB0YWJsZSk6IChhbnksIGFueSkNCiAgICBsb2NhbCBLZXkgPSBzZWxmOkNoZWNrVmFsdWUoUGFja2V0LkluZGV4LCB0cnVlKQ0KICAgIGxvY2FsIFZhbHVlID0gc2VsZjpDaGVja1ZhbHVlKFBhY2tldC5WYWx1ZSwgdHJ1ZSkNCiAgICByZXR1cm4gS2V5LCBWYWx1ZQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpTZXJpYWxpemVUYWJsZShUYWJsZTogdGFibGUpOiB0YWJsZQ0KICAgIGxvY2FsIFNlcmlhbGl6ZWQgPSB7fQ0KICAgIGZvciBJbmRleCwgVmFsdWUgaW4gbmV4dCwgVGFibGUgZG8NCiAgICAgICAgbG9jYWwgUGFja2V0ID0gc2VsZjpNYWtlUGFja2V0KEluZGV4LCBWYWx1ZSkNCiAgICAgICAgdGFibGUuaW5zZXJ0KFNlcmlhbGl6ZWQsIFBhY2tldCkNCiAgICBlbmQNCiAgICByZXR1cm4gU2VyaWFsaXplZA0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpEZXNlcmlhbGl6ZVRhYmxlKFNlcmlhbGl6ZWQ6IHRhYmxlKTogdGFibGUNCiAgICBsb2NhbCBUYWJsZSA9IHt9DQogICAgZm9yIF8sIFBhY2tldCBpbiBuZXh0LCBTZXJpYWxpemVkIGRvDQogICAgICAgIGxvY2FsIEluZGV4LCBWYWx1ZSA9IHNlbGY6UmVhZFBhY2tldChQYWNrZXQpDQogICAgICAgIGlmIG5vdCBJbmRleCB0aGVuIGNvbnRpbnVlIGVuZA0KDQogICAgICAgIFRhYmxlW0luZGV4XSA9IFZhbHVlDQogICAgZW5kDQogICAgcmV0dXJuIFRhYmxlDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOlNldENoYW5uZWwoTmV3Q2hhbm5lbDogbnVtYmVyKQ0KICAgIENoYW5uZWwgPSBOZXdDaGFubmVsDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkNvbnNvbGVQcmludCguLi4pDQogICAgc2VsZjpDb21tdW5pY2F0ZSgiUHJpbnQiLCAuLi4pDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOlF1ZXVlTG9nKERhdGEpDQogICAgc2VsZjpDb21tdW5pY2F0ZSgiUXVldWVMb2ciLCBEYXRhKQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb21tQ2FsbGJhY2soVHlwZTogc3RyaW5nLCBDYWxsYmFjazogKC4uLmFueSkgLT4gLi4uYW55KQ0KICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MNCiAgICBDb21tQ2FsbGJhY2tzW1R5cGVdID0gQ2FsbGJhY2sNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6R2V0Q29tbUNhbGxiYWNrKFR5cGU6IHN0cmluZyk6ICguLi5hbnkpIC0+IC4uLmFueQ0KICAgIGxvY2FsIENvbW1DYWxsYmFja3MgPSBzZWxmLkNvbW1DYWxsYmFja3MNCiAgICByZXR1cm4gQ29tbUNhbGxiYWNrc1tUeXBlXQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgUHJvcGVydHk6IHN0cmluZykNCiAgICBpZiB0eXBlb2YoQ2hhbm5lbCkgPT0gIkluc3RhbmNlIiB0aGVuDQogICAgICAgIHJldHVybiBIb29rOkluZGV4KENoYW5uZWwsIFByb3BlcnR5KQ0KICAgIGVuZA0KDQogICAgLS0vLyBTb21lIGV4ZWN1dG9ycyByZXR1cm4gYSBVc2VyRGF0YSB0eXBlDQogICAgcmV0dXJuIENoYW5uZWxbUHJvcGVydHldDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkNvbW11bmljYXRlKC4uLikNCiAgICBsb2NhbCBGaXJlID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkZpcmUiKQ0KICAgIEZpcmUoQ2hhbm5lbCwgLi4uKQ0KZW5kDQoNCmZ1bmN0aW9uIE1vZHVsZTpBZGRDb25uZWN0aW9uKENhbGxiYWNrKTogUkJYU2NyaXB0Q29ubmVjdGlvbg0KICAgIGxvY2FsIEV2ZW50ID0gc2VsZjpDaGFubmVsSW5kZXgoQ2hhbm5lbCwgIkV2ZW50IikNCiAgICByZXR1cm4gRXZlbnQ6Q29ubmVjdChDYWxsYmFjaykNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrKFR5cGU6IHN0cmluZywgQ2FsbGJhY2spOiBSQlhTY3JpcHRDb25uZWN0aW9uDQogICAgbG9jYWwgRXZlbnQgPSBzZWxmOkNoYW5uZWxJbmRleChDaGFubmVsLCAiRXZlbnQiKQ0KICAgIHJldHVybiBFdmVudDpDb25uZWN0KGZ1bmN0aW9uKFJlY2l2ZWRUeXBlOiBzdHJpbmcsIC4uLikNCiAgICAgICAgaWYgUmVjaXZlZFR5cGUgfj0gVHlwZSB0aGVuIHJldHVybiBlbmQNCiAgICAgICAgQ2FsbGJhY2soLi4uKQ0KICAgIGVuZCkNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6QWRkVHlwZUNhbGxiYWNrcyhUeXBlczogdGFibGUpDQogICAgZm9yIFR5cGU6IHN0cmluZywgQ2FsbGJhY2sgaW4gbmV4dCwgVHlwZXMgZG8NCiAgICAgICAgc2VsZjpBZGRUeXBlQ2FsbGJhY2soVHlwZSwgQ2FsbGJhY2spDQogICAgZW5kDQplbmQNCg0KZnVuY3Rpb24gTW9kdWxlOkFkZERlZmF1bHRDYWxsYmFja3MoRXZlbnQ6IEJpbmRhYmxlRXZlbnQpDQogICAgc2VsZjpBZGRDb21tQ2FsbGJhY2soIldhcm4iLCBmdW5jdGlvbiguLi4pDQogICAgICAgIHdhcm4oLi4uKQ0KICAgIGVuZCkNCmVuZA0KDQpmdW5jdGlvbiBNb2R1bGU6Q3JlYXRlQ2hhbm5lbCgpOiBudW1iZXINCiAgICBsb2NhbCBDaGFubmVsSUQsIEV2ZW50ID0gc2VsZjpDcmVhdGVDb21tQ2hhbm5lbCgpDQoNCiAgICAtLS8vIENvbm5lY3QgR2V0Q29tbUNhbGxiYWNrIGZ1bmN0aW9uDQogICAgRXZlbnQuRXZlbnQ6Q29ubmVjdChmdW5jdGlvbihUeXBlOiBzdHJpbmcsIC4uLikNCiAgICAgICAgbG9jYWwgQ2FsbGJhY2sgPSBzZWxmOkdldENvbW1DYWxsYmFjayhUeXBlKQ0KICAgICAgICBpZiBDYWxsYmFjayB0aGVuDQogICAgICAgICAgICBDYWxsYmFjayguLi4pDQogICAgICAgIGVuZA0KICAgIGVuZCkNCg0KICAgIC0tLy8gQWRkIGRlZmF1bHQgY29tbXVuaWNhdGlvbiBjYWxsYmFja3MNCiAgICBzZWxmOkFkZERlZmF1bHRDYWxsYmFja3MoRXZlbnQpDQoNCiAgICByZXR1cm4gQ2hhbm5lbElELCBFdmVudA0KZW5kDQoNCk1vZHVsZTpNYWtlRGVidWdJZEhhbmRsZXIoKQ0KDQpyZXR1cm4gTW9kdWxl]]
}},d.Players local i=e:LoadLibraries(g)local j,k,l,m,n,o,p=i.Process,i.Hook,i.Ui
,i.Generation,i.Communication,i.Config,e:GetAsset('ProggyClean.ttf',true)local q
=e:CreateFont('ProggyClean',p)l:SetFontFile(q)j:CheckConfig(o)e:LoadModules(i,{
Modules=i,Services=d})local r,s=l:CreateMainWindow(),j:CheckIsSupported()if not
s then r:Close()return end local t,u=n:CreateChannel()n:AddCommCallback(
'QueueLog',function(...)l:QueueLog(...)end)n:AddCommCallback('Print',function(
...)l:ConsoleLog(...)end)local v=h.LocalPlayer m:SetSwapsCallback(function(w)w:
AddSwap(v,{String='LocalPlayer'})w:AddSwap(v.Character,{String='Character',
NextParent=v})end)l:CreateWindowContent(r)l:SetCommChannel(u)l:BeginLogService()
local w=e:MakeActorScript(g,t)k:LoadHooks(w,t)
